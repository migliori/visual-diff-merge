!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,(()=>(()=>{"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function i(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,n||"default");if("object"!=t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}var a=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.enabled=!1,this.logHistory=[],this.maxLogHistory=100,this.prefix="[DiffViewer]",this.logLevel=1},t=[{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"[DiffViewer]",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.enabled&&this.logLevel>1&&!e?console.warn("".concat(this.prefix," Preventing debug reinitialization with weaker settings"),{current:{enabled:this.enabled,level:this.logLevel},attempted:{enabled:e,level:n}}):(this.enabled=e,this.prefix=t,this.logLevel=n,console.log("Debug initialized",{enabled:this.enabled,level:this.logLevel}),this.log("Debug initialized",{enabled:this.enabled,level:this.logLevel}))}},{key:"shouldLog",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(this.enabled||!1===this.enabled&&(null===(e=window.diffConfig)||void 0===e?void 0:e.debug))&&t<=this.logLevel}},{key:"log",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.shouldLog(n)&&(null!==t?(console.log("".concat(this.prefix," ").concat(e),t),this._addToHistory("log",[e,t],n)):(console.log("".concat(this.prefix," ").concat(e)),this._addToHistory("log",[e],n)))}},{key:"warn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==t?(console.warn("".concat(this.prefix," ").concat(e),t),this._addToHistory("warn",[e,t],n)):(console.warn("".concat(this.prefix," ").concat(e)),this._addToHistory("warn",[e],n))}},{key:"error",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==t?(console.error("".concat(this.prefix," ").concat(e),t),this._addToHistory("error",[e,t],n)):(console.error("".concat(this.prefix," ").concat(e)),this._addToHistory("error",[e],n))}},{key:"getLogHistory",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.logLevel;return e>=this.logLevel?n(this.logHistory):this.logHistory.filter((function(t){return t.level<=e}))}},{key:"clearLogHistory",value:function(){this.logHistory=[],this.log("Log history cleared")}},{key:"_addToHistory",value:function(e,t,n){this.logHistory.push({timestamp:new Date,type:e,message:t,level:n}),this.logHistory.length>this.maxLogHistory&&this.logHistory.shift()}}],t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}());function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function s(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}var u=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"getInstance",value:function(){throw new Error("getInstance() must be implemented by subclass")}}],(t=[{key:"_isFirstInstance",value:function(e){return!e}}])&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(){d=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),l=new j(r||[]);return o(a,"_invoke",{value:M(e,n,l)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var g="suspendedStart",m="suspendedYield",p="executing",v="completed",y={};function b(){}function w(){}function E(){}var T={};s(T,a,(function(){return this}));var I=Object.getPrototypeOf,C=I&&I(I(x([])));C&&C!==n&&r.call(C,a)&&(T=C);var L=E.prototype=b.prototype=Object.create(T);function S(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,l){var c=h(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==f(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function M(t,n,r){var o=g;return function(i,a){if(o===p)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=O(l,r);if(c){if(c===y)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===g)throw o=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=p;var s=h(t,n,r);if("normal"===s.type){if(o=r.done?v:m,s.arg===y)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=v,r.method="throw",r.arg=s.arg)}}}function O(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,O(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=h(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function x(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(f(t)+" is not iterable")}return w.prototype=E,o(L,"constructor",{value:E,configurable:!0}),o(E,"constructor",{value:w,configurable:!0}),w.displayName=s(E,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,E):(e.__proto__=E,s(e,c,"GeneratorFunction")),e.prototype=Object.create(L),e},t.awrap=function(e){return{__await:e}},S(k.prototype),s(k.prototype,l,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(L),s(L,c,"Generator"),s(L,a,(function(){return this})),s(L,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=x,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:x(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function h(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,l,"next",e)}function l(e){h(i,r,o,a,l,"throw",e)}a(void 0)}))}}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function p(e){var t=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==f(t)?t:t+""}function v(e,t){if(t&&("object"==f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(y=function(){return!!e})()}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}var E=null,T=function(e){function t(){var e,n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=b(r=t),(e=v(n,y()?Reflect.construct(r,o||[],b(n).constructor):r.apply(n,o)))._isFirstInstance(E)?(e.config=null,e.loadedResources=new Set,e.loadedLanguages=new Set,e.loadedThemes=new Set,e.CDN_BASE="https://cdnjs.cloudflare.com/ajax/libs",e.HLJS_VERSION="11.11.1",e.LINE_NUMBERS_VERSION="2.8.0",E=e,e):v(e)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(t,e),n=t,r=[{key:"configure",value:function(e){return a.log("ResourceLoader: Configuring",{config:e},2),this.config=e,a.log("ResourceLoader configured"),a.log("ResourceLoader: Configuration complete",null,2),this}},{key:"loadDependencies",value:(c=g(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadSyntaxHighlighterCore();case 2:return e.next=4,this.loadLanguage(this.config.language||"php");case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"loadSyntaxHighlighterCore",value:(l=g(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.config){e.next=3;break}throw a.error("ResourceLoader: Must be configured before loading dependencies",null,2),new Error("ResourceLoader must be configured before loading dependencies");case 3:if(e.prev=3,a.log("ResourceLoader: Loading syntax highlighter core (NO THEME)",null,2),!window.hljs){e.next=9;break}a.log("ResourceLoader: highlight.js already loaded",null,2),e.next=15;break;case 9:return a.log("ResourceLoader: Loading highlight.js from CDN",null,2),e.next=12,this.loadScript("".concat(this.CDN_BASE,"/highlight.js/").concat(this.HLJS_VERSION,"/highlight.min.js"));case 12:return a.log("ResourceLoader: Loading line numbers plugin",null,2),e.next=15,this.loadScript("".concat(this.CDN_BASE,"/highlightjs-line-numbers.js/").concat(this.LINE_NUMBERS_VERSION,"/highlightjs-line-numbers.min.js"));case 15:return a.log("ResourceLoader: Syntax highlighter core loaded successfully",null,2),e.abrupt("return",!0);case 19:return e.prev=19,e.t0=e.catch(3),a.error("ResourceLoader: Failed to load syntax highlighter core:",e.t0,2),e.abrupt("return",!1);case 23:case"end":return e.stop()}}),e,this,[[3,19]])}))),function(){return l.apply(this,arguments)})},{key:"loadLanguage",value:(i=g(d().mark((function e(t){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={markup:"xml",html:"xml",htm:"xml",javascript:"javascript",js:"javascript",typescript:"typescript",ts:"typescript",jsx:"javascript",tsx:"typescript"}[t.toLowerCase()]||t.toLowerCase(),!this.loadedLanguages.has(n)){e.next=4;break}return e.abrupt("return",!0);case 4:return a.log("ResourceLoader: Loading language ".concat(n),null,2),e.prev=5,e.next=8,this.loadScript("".concat(this.CDN_BASE,"/highlight.js/").concat(this.HLJS_VERSION,"/languages/").concat(n,".min.js"));case 8:return this.loadedLanguages.add(n),a.log("ResourceLoader: Language ".concat(n," loaded from CDN successfully"),null,2),e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(5),a.warn("ResourceLoader: Failed to load language ".concat(n,", falling back to built-in languages"),{error:e.t0},2),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,this,[[5,13]])}))),function(e){return i.apply(this,arguments)})},{key:"_cacheResource",value:function(e,t){return this.resourceCache||(this.resourceCache=new Map),this.resourceCache.has(e)||this.resourceCache.set(e,t),this.resourceCache.get(e)}},{key:"loadScript",value:function(e){var t=this;return this._cacheResource(e,new Promise((function(n,r){if(t.loadedResources.has(e))n();else{a.log("ResourceLoader: Loading script: ".concat(e),null,2);var o=document.createElement("script");o.src=e,o.async=!0,o.onload=function(){t.loadedResources.add(e),n()},o.onerror=function(){a.error("ResourceLoader: Failed to load script: ".concat(e),null,2),r(new Error("Failed to load script: ".concat(e)))},document.head.appendChild(o)}})))}},{key:"loadCSS",value:function(e){var t=this;return this.loadedThemes.has(e)?Promise.resolve():(a.log("ResourceLoader: Loading CSS: ".concat(e),null,2),new Promise((function(n,r){var o=document.createElement("link");o.rel="stylesheet",o.href=e,o.onload=function(){t.loadedThemes.add(e),n()},o.onerror=function(){a.error("ResourceLoader: Failed to load CSS: ".concat(e),null,2),r(new Error("Failed to load CSS: ".concat(e)))},document.head.appendChild(o)})))}}],o=[{key:"getInstance",value:function(){return E||(E=new t),E}}],r&&m(n.prototype,r),o&&m(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,l,c}(u);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}var C={get:function(e,t){return"name"===t?function(){return e.startsWith("#")||e.startsWith(".")?e.substring(1):(a.warn("Selector '".concat(e,"' doesn't start with '.' or '#' but name() was called on it")),e)}:"toString"===t||t===Symbol.toPrimitive?function(){return String(e)}:e[t]}},L=function(e){var t={};for(var n in e)"object"===I(e[n])&&null!==e[n]?t[n]=L(e[n]):"string"==typeof e[n]?t[n]=new Proxy(Object(String(e[n])),C):t[n]=e[n];return t},S={CODE:{LINE_CONTENT:".vdm-code__line-content",LINE_EMPTY:".vdm-code__line--empty",LINE_NUMBER:".vdm-code__line-number",TABLE:".vdm-code__table"},CONTAINER:{ROOT:"#vdm-container",WRAPPER:"#vdm-container__wrapper"},COPY:{BUTTON:".vdm-code__copy-btn",COPIED:".vdm-code__copy--copied",ICON:".vdm-code__copy-icon",MODAL:{ACTIONS:".vdm-modal__copy-actions",BUTTON:".vdm-modal__copy-btn",DIALOG:".vdm-modal__copy-dialog",INSTRUCTIONS:".vdm-modal__copy-instructions",TEXTAREA:".vdm-modal__copy-textarea-container",TEXTAREA_ELEM:".vdm-modal__copy-textarea"},PROCESSING:".vdm-code__copy--processing",TEXT:".vdm-code__copy-text"},DIFF:{CHECK_ALL_BTN:".vdm-check-all-btn",CHUNK:".vdm-diff__chunk",CHUNK_SELECTED:".vdm-diff__chunk--selected",CHUNK_UNSELECTED:".vdm-diff__chunk--unselected",CONTAINER:"#vdm-diff__container",CONTENT_WRAPPER:"#vdm-diff__content-wrapper",LINE_ADD:".vdm-diff__line--add",LINE_CONTENT:".vdm-code__line-content",LINE_CONTENT_EMPTY:".vdm-code__line-content--empty",LINE_DELETE:".vdm-diff__line--delete",LINE_PLACEHOLDER:".vdm-diff__line--placeholder",LINE_REPLACE_LEFT:".vdm-diff__line--replace-left",LINE_REPLACE_RIGHT:".vdm-diff__line--replace-right",PANE:".vdm-diff__pane",PANE_CONTENT:".vdm-diff__pane-content",PANE_HEADER:".vdm-pane-header",PANE_LEFT:"#vdm-diff__pane--left",PANE_RIGHT:"#vdm-diff__pane--right",PANES_CONTAINER:".vdm-diff__panes-container",PLACEHOLDER:".vdm-diff__placeholder",TABLE_WRAPPER:".vdm-diff__table-wrapper",VIEWER:"#vdm-diff__viewer"},ICONS:{COLUMN:".vdm-icon__column",MARKER:".vdm-icon__marker",MARKER_PLACEHOLDER:".vdm-icon__marker--placeholder",SELECT:".vdm-icon__select",SELECT_LEFT:".vdm-icon__select--left",SELECT_RIGHT:".vdm-icon__select--right"},LOADER:{ACTIVE:".vdm-loader--active",CONTAINER:".vdm-loader__container",FULLSCREEN:".vdm-loader--fullscreen",INDICATOR:"#vdm-loader__indicator",INLINE:".vdm-loader--inline",MAIN:"#vdm-diff__loading",SPINNER:".vdm-loader__spinner",TEXT:".vdm-loader__text",WRAPPER:".vdm-loader__wrapper"},MERGE:{BUTTON_APPLY:"#vdm-merge__button--apply",BUTTON_PREVIEW:"#vdm-merge__button--preview",CONFLICT_MODAL:"#vdm-merge__conflict-modal",CONTROLS_ACTIONS:".vdm-merge-controls__actions",DESTINATION_DROPDOWN:"#vdm-merge__destination-dropdown",DESTINATION_TOGGLE:"#vdm-merge__destination-toggle",GET_MERGED_RESULT_BTN:"#vdm-merge__get-merged-result-btn",MODAL:"#vdm-merge__modal",PREVIEW_CONTENT:"#vdm-merge__preview-content",PREVIEW_MODAL:"#vdm-merge__preview-modal",TOGGLE_ICON:"#vdm-merge-controls__toggle-icon",TOGGLE_TEXT:"#vdm-merge-controls__toggle-text"},MODAL:{BACKDROP:"#vdm-modal-backdrop",CLOSE:".vdm-modal__close",CLOSE_BTN:".vdm-modal__close",CODE_COPY:"#vdm-modal--code-copy",CONFIRM:"#vdm-modal--confirm",CONFIRMATION_CONTENT:"#vdm-modal__confirmation-content",CONTAINER:".vdm-modal",CONTENT:".vdm-modal__content",CONTINUE_BTN:"#vdm-modal__continue-btn",COPY_CONTENT:"#vdm-modal__copy-content",FIXED_FOOTER:".vdm-modal--fixed-footer",FOOTER:".vdm-modal__footer",FULLSCREEN:".vdm-modal--fullscreen",HEADER:".vdm-modal__header",HEADER_FIXED:".vdm-modal__header--fixed",MERGE_BTN:"#vdm-modal__merge-btn",MESSAGE:"#vdm-modal__message",PREVIEW:"#vdm-modal--preview",PREVIEW_CONTENT:".vdm-modal__preview-content",PREVIEW_CONTENT_ID:"#vdm-merge__preview-content",PREVIEW_FILENAME:"#vdm-modal__preview-filename",TITLE:".vdm-modal__title"},NAVIGATION:{CONTAINER:".vdm-nav__controls",COUNTER:"#vdm-nav__counter",COUNTER_ELEMENT:".vdm-navigator__counter",HIGHLIGHT:".vdm-highlight",NAV_CHUNK:".vdm-nav__chunk",NEXT_BUTTON:"#vdm-nav__button--next",PREV_BUTTON:"#vdm-nav__button--prev"},STATUS:{LOADED:".vdm-status__loaded",RESOLVED:".vdm-status__resolved",SCROLLED:".vdm-status__scrolled-horizontally",UNRESOLVED:".vdm-status__unresolved"},THEME:{DARK:".vdm-theme--dark",LIGHT:".vdm-theme--light",LOADING_INDICATOR:"#vdm-theme__loading-indicator",MODE_PREFIX:".vdm-theme",SELECTOR:"#vdm-theme__selector",SWITCHER:"#vdm-theme-switcher",TOGGLE:"#vdm-theme__toggle"},THEME_SWITCHER:{CONTROL:".vdm-theme-switcher__control",LABEL:".vdm-theme-switcher__label",SLIDER:".vdm-theme-switcher__slider",SLIDER_ROUND:".vdm-theme-switcher__slider--round",WRAPPER:".vdm-theme-switcher__wrapper"},THEME_SELECTOR:{WRAPPER:".vdm-theme-selector__wrapper"},TOOLTIP:{ARROW:".vdm-tooltip__arrow",CONTAINER:".vdm-tooltip",CONTENT:".vdm-tooltip__content"},UTILITY:function(){var e={BUTTON:".vdm-btn",BUTTON_PRIMARY:".vdm-btn--primary",BUTTON_SECONDARY:".vdm-btn--secondary",BUTTON_INFO:".vdm-btn--info",BUTTON_SUCCESS:".vdm-btn--success",BUTTON_WARNING:".vdm-btn--warning",BUTTON_DANGER:".vdm-btn--danger",BUTTON_FLAT:".vdm-btn--flat",BUTTON_SMALL:".vdm-btn-sm",BUTTON_EXTRA_SMALL:".vdm-btn-xs",BUTTON_LARGE:".vdm-btn-lg",ALERT:".vdm-alert",ALERT_PREFIX:".vdm-alert--",ALERT_INFO:".vdm-alert--info",ALERT_SUCCESS:".vdm-alert--success",ALERT_WARNING:".vdm-alert--warning",ALERT_DANGER:".vdm-alert--danger",FORM_SELECT:".vdm-select",FORM_SELECT_SM:".vdm-select-sm",FLEX:".vdm-d-flex",FLEX_COLUMN:".vdm-flex-column",JUSTIFY_CONTENT_BETWEEN:".vdm-justify-content-between",JUSTIFY_CONTENT_CENTER:".vdm-justify-content-center",ALIGN_ITEMS_CENTER:".vdm-align-items-center",ALIGN_ITEMS_STRETCH:".vdm-align-items-stretch",PADDING_2:".vdm-p-2",PADDING_3:".vdm-p-3",MARGIN_2:".vdm-m-2",MARGIN_TOP_2:".vdm-mt-2",MARGIN_BOTTOM_2:".vdm-mb-2",MARGIN_START_1:".vdm-ms-1",MARGIN_START_2:".vdm-ms-2",MARGIN_END_2:".vdm-me-2",MARGIN_END_3:".vdm-me-3",MARGIN_X_1:".vdm-mx-1",MARGIN_Y_2:".vdm-my-2",MARGIN_END_1:".vdm-me-1"};if(window.diffConfig&&window.diffConfig.ui)try{window.diffConfig.ui.button&&(e.BUTTON="."+window.diffConfig.ui.button),window.diffConfig.ui.buttonPrimary&&(e.BUTTON_PRIMARY="."+window.diffConfig.ui.buttonPrimary),window.diffConfig.ui.buttonSecondary&&(e.BUTTON_SECONDARY="."+window.diffConfig.ui.buttonSecondary),window.diffConfig.ui.buttonInfo&&(e.BUTTON_INFO="."+window.diffConfig.ui.buttonInfo),window.diffConfig.ui.buttonSuccess&&(e.BUTTON_SUCCESS="."+window.diffConfig.ui.buttonSuccess),window.diffConfig.ui.buttonWarning&&(e.BUTTON_WARNING="."+window.diffConfig.ui.buttonWarning),window.diffConfig.ui.buttonDanger&&(e.BUTTON_DANGER="."+window.diffConfig.ui.buttonDanger),window.diffConfig.ui.buttonFlat&&(e.BUTTON_FLAT="."+window.diffConfig.ui.buttonFlat),window.diffConfig.ui.alert&&(e.ALERT="."+window.diffConfig.ui.alert),window.diffConfig.ui.alertInfo&&(e.ALERT_INFO="."+window.diffConfig.ui.alertInfo),window.diffConfig.ui.alertSuccess&&(e.ALERT_SUCCESS="."+window.diffConfig.ui.alertSuccess),window.diffConfig.ui.alertWarning&&(e.ALERT_WARNING="."+window.diffConfig.ui.alertWarning),window.diffConfig.ui.alertDanger&&(e.ALERT_DANGER="."+window.diffConfig.ui.alertDanger),a.log("Overriding UI selectors with config values",window.diffConfig.ui,2)}catch(e){a.error("Error applying UI selector overrides from config",e,1)}return e}()};const k=L(S);function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,N(r.key),r)}}function N(e){var t=function(e,t){if("object"!=M(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=M(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==M(t)?t:t+""}var _=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"getIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.classes,r=void 0===n?"":n,o=t.width,i=void 0===o?16:o,a=t.height,l=void 0===a?16:a,c=t.title,s=void 0===c?"":c,u=t.ariaHidden,f=void 0===u||u,d=this._getIconPathData(e);if(!d)return console.warn("Icon not found: ".concat(e)),"";var h=s?"<title>".concat(s,"</title>"):"";return'<svg\n            class="vdm-icon '.concat(r,'"\n            width="').concat(i,'"\n            height="').concat(l,'"\n            viewBox="').concat(d.viewBox||"0 0 512 512",'"\n            ').concat(f?'aria-hidden="true"':'role="img"','\n            focusable="false"\n        >\n            ').concat(h,"\n            ").concat(d.paths,"\n        </svg>")}},{key:"_getIconPathData",value:function(e){return{"chevron-up":{viewBox:"0 0 512 512",paths:'<path d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"/>'},"chevron-down":{viewBox:"0 0 512 512",paths:'<path d="M233.4 406.6c12.5 12.5 32.8 12.5 45.3 0l192-192c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 338.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l192 192z"/>'},eye:{viewBox:"0 0 576 512",paths:'<path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"/>'},sun:{viewBox:"0 0 512 512",paths:'<path d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"/>'},moon:{viewBox:"0 0 384 512",paths:'<path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/>'},file:{viewBox:"0 0 384 512",paths:'<path d="M0 64C0 28.7 28.7 0 64 0H224V128c0 17.7 14.3 32 32 32H384V448c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V64zm384 64H256V0L384 128z"/>'},"file-circle-plus":{viewBox:"0 0 576 512",paths:'<path d="M0 64C0 28.7 28.7 0 64 0H224V128c0 17.7 14.3 32 32 32H384v38.6C310.1 219.5 256 287.4 256 368c0 59.1 29.1 111.3 73.7 143.3c-3.2 .5-6.4 .7-9.7 .7H64c-35.3 0-64-28.7-64-64V64zm384 64H256V0L384 128zM288 368a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-80c-8.8 0-16 7.2-16 16v48H368c-8.8 0-16 7.2-16 16s7.2 16 16 16h48v48c0 8.8 7.2 16 16 16s16-7.2 16-16V384h48c8.8 0 16-7.2 16-16s-7.2-16-16-16H448V304c0-8.8-7.2-16-16-16z"/>'},"file-lines":{viewBox:"0 0 384 512",paths:'<path d="M64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V160H256c-17.7 0-32-14.3-32-32V0H64zM256 0V128H384L256 0zM112 256H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64H272c8.8 0 16 7.2 16 16s-7.2 16-16 16H112c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/>'},"file-copy":{viewBox:"0 0 576 512",paths:'<path d="M384 480h48c20.9 0 38.7-13.4 45.3-32H416c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16h61.3C470.7 157.4 452.9 144 432 144H384V64c0-35.3-28.7-64-64-64H64C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H384zM128 64H320V144H128V64zM400 240V416H144V192H352c26.5 0 48 21.5 48 48zm176-48c0-8.8-7.2-16-16-16H432c-8.8 0-16 7.2-16 16V416c0 8.8 7.2 16 16 16H560c8.8 0 16-7.2 16-16V192z"/>'},"plus-circle":{viewBox:"0 0 512 512",paths:'<path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM232 344V280H168c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H280v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z"/>'},"exclamation-triangle":{viewBox:"0 0 512 512",paths:'<path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7 .2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8 .2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24V296c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/>'},copy:{viewBox:"0 0 512 512",paths:'<path d="M272 0H396.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H272c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128H192v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"/>'},"check-circle":{viewBox:"0 0 512 512",paths:'<path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z"/>'},"chevron-right":{viewBox:"0 0 320 512",paths:'<path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/>'},download:{viewBox:"0 0 512 512",paths:'<path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/>'},"uncheck-circle":{viewBox:"0 0 512 512",paths:'<path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24v112c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zm-32 224a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/>'},"info-circle":{viewBox:"0 0 512 512",paths:'<path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/>'},"exclamation-circle":{viewBox:"0 0 512 512",paths:'<path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM256 128c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/>'},"checkbox-unchecked":{viewBox:"0 0 24 24",paths:'<path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>'},"checkbox-checked":{viewBox:"0 0 24 24",paths:'<path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>'}}[e]||null}},{key:"createIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getIcon(e,t);if(!n)return null;var r=document.createElement("template");return r.innerHTML=n.trim(),r.content.firstChild}}],(t=null)&&O(e.prototype,t),n&&O(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,B(r.key),r)}}function D(e,t,n){return t=R(t),function(e,t){if(t&&("object"==j(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,P()?Reflect.construct(t,n||[],R(e).constructor):t.apply(e,n))}function P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(P=function(){return!!e})()}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}function F(e,t,n){return(t=B(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e){var t=function(e,t){if("object"!=j(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==j(t)?t:t+""}var H=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=D(this,t)).translations={},e.lang="en",e.initialized=!1,e._initializeFromGlobalConfig(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U(e,t)}(t,e),n=t,r=[{key:"_initializeFromGlobalConfig",value:function(){return!(!window.diffConfig||!window.diffConfig.translations||(a.log("TranslationManager: Auto-initializing from window.diffConfig",window.diffConfig.translations,2),this.initialize(window.diffConfig.lang||"en",window.diffConfig.translations),0))}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.lang=e,this.translations=t,this.initialized=!0,a.log('TranslationManager: Initialized with "'.concat(e,'" language'),this.translations,2)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.initialized||this._initializeFromGlobalConfig(),this.translations[this.lang]&&this.translations[this.lang][e]?this.translations[this.lang][e]:this.translations.en&&this.translations.en[e]?(a.log('TranslationManager: Key "'.concat(e,'" not found in "').concat(this.lang,'", using English fallback'),null,2),this.translations.en[e]):null!==t?t:e}},{key:"isInitialized",value:function(){return this.initialized||this._initializeFromGlobalConfig(),this.initialized}},{key:"getLanguage",value:function(){return this.initialized||this._initializeFromGlobalConfig(),this.lang}},{key:"getAllTranslations",value:function(){return this.initialized||this._initializeFromGlobalConfig(),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.translations)}}],o=[{key:"getInstance",value:function(){return t._instance||(t._instance=new t,a.log("TranslationManager: Instance created",null,2)),t._instance}}],r&&A(n.prototype,r),o&&A(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o}(u);function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){Y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e,t,n){return(t=q(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,q(r.key),r)}}function q(e){var t=function(e,t){if("object"!=V(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=V(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==V(t)?t:t+""}function K(e,t,n){return t=J(t),function(e,t){if(t&&("object"==V(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,X()?Reflect.construct(t,n||[],J(e).constructor):t.apply(e,n))}function X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(X=function(){return!!e})()}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}F(H,"_instance",null);var Z=null;const Q=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),K(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(t,e),n=t,r=[{key:"initialize",value:function(){this.initialized||(this.containerId="vdm-alert-container",this.activeAlert=null,this.timeoutId=null,this.container=this._ensureContainer(),this.initialized=!0,a.log("AlertManager: Initialized",null,2))}},{key:"_ensureContainer",value:function(){var e=document.getElementById(this.containerId);return e||((e=document.createElement("div")).id=this.containerId,e.className="vdm-alert-container",e.style.position="fixed",e.style.top="20px",e.style.left="50%",e.style.transform="translateX(-50%)",e.style.zIndex="9999",e.style.width="auto",e.style.maxWidth="90%",document.body.appendChild(e),a.log("AlertManager: Created alert container",null,2)),e}},{key:"showAlert",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a.log("AlertManager.showAlert called with type",t,2),a.log("AlertManager.showAlert message",e,3);var o=z(z({},{timeout:5e3,dismissable:!0,translate:!0,className:"",container:null,targetElement:null,placement:"before"}),r),i=!o.targetElement&&(o.container||this.container);a.log("AlertManager placement options",{hasTargetElement:!!o.targetElement,placement:o.placement,useContainer:!!i},3);var l=document.createElement("div"),c=k.UTILITY.ALERT?k.UTILITY.ALERT.toString().substring(1):"vdm-alert",s=c;if(t){var u="info"===t&&k.UTILITY.ALERT_INFO?k.UTILITY.ALERT_INFO.toString().substring(1):"".concat(c,"--").concat(t);s+=" ".concat(u)}o.className&&(s+=" ".concat(o.className)),l.className=s,a.log("Alert classnames",l.className,3),a.log("Alert selector values",{selectorBase:k.UTILITY.ALERT?k.UTILITY.ALERT.toString():"vdm-alert",selectorType:t?"".concat(c,"--").concat(t):"none"},3);var f=e;if(o.translate&&void 0!==H){var d=H.getInstance();d&&"function"==typeof d.get&&(f=d.get(e,e))}if(l.innerHTML=f,o.dismissable){var h=document.createElement("button");h.className="vdm-alert__close",h.innerHTML="&times;",h.setAttribute("aria-label","Close"),h.setAttribute("type","button"),l.appendChild(h),h.addEventListener("click",(function(){return n.hideAlert(l)})),a.log("Close button",h?"found":"not found",3)}return o.targetElement?(a.log("AlertManager: Placing alert relative to target element",{target:o.targetElement,placement:o.placement},3),"before"===o.placement?o.targetElement.parentNode.insertBefore(l,o.targetElement):"after"===o.placement&&(o.targetElement.nextSibling?o.targetElement.parentNode.insertBefore(l,o.targetElement.nextSibling):o.targetElement.parentNode.appendChild(l))):i?(i.appendChild(l),a.log("Alert appended to container",null,3)):(document.body.appendChild(l),a.log("Alert appended to body",null,3)),this.activeAlert=l,o.timeout>0&&(this.timeoutId=setTimeout((function(){n.hideAlert(l)}),o.timeout)),a.log("Returning alert element",l,3),l}},{key:"hideAlert",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),null!=t&&t.parentNode)return t.parentNode.removeChild(t),a.log("AlertManager: Hiding specific alert",null,3),void(this.activeAlert===t&&(this.activeAlert=null));null!==(e=this.activeAlert)&&void 0!==e&&e.parentNode&&(this.activeAlert.parentNode.removeChild(this.activeAlert),this.activeAlert=null,a.log("AlertManager: Hiding active alert",null,3))}},{key:"showInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.showAlert(e,"info",t)}},{key:"showSuccess",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.showAlert(e,"success",t)}},{key:"showWarning",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.showAlert(e,"warning",t)}},{key:"showError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.showAlert(e,"danger",t)}}],o=[{key:"getInstance",value:function(){return Z||(Z=new t).initialize(),Z}}],r&&W(n.prototype,r),o&&W(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o}(u);function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||re(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||re(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t){if(e){if("string"==typeof e)return oe(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(e,t):void 0}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ae(r.key),r)}}function ae(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ee(t)?t:t+""}var le=new Map,ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,r=[{key:"setupButtonHandler",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=document.getElementById(e);if(!r)return a.warn("DOMUtils: Button ".concat(e," not found"),null,2),null;var o=Date.now();if(r._handlerId&&r._handlerId!==o){var i=r.cloneNode(!0);return r.parentNode&&r.parentNode.replaceChild(i,r),a.log("DOMUtils: Cleaned up previous handler for ".concat(n||e),null,2),t(i),i._handlerId=o,{element:i,id:o}}return r._handlerId=o,t(r),{element:r,id:o}}},{key:"getElement",value:function(e){if(!e)return a.error("DOMUtils.getElement: Empty ID provided",null,1),null;if(le.has(e))return le.get(e);var t=document.getElementById(e);if(!t)try{t=e.includes("#")||e.includes(".")?document.querySelector(e):document.querySelector("#"+e)}catch(e){a.error("DOMUtils.getElement: Error with selector: ".concat(e.message),null,1)}return t?le.set(e,t):a.error("DOMUtils.getElement: Element with ID '".concat(e,"' not found"),null,1),t}},{key:"updateToggleButton",value:function(e,t,n){var r=t.toggleBtn,o=t.toggleIcon,i=t.toggleText,l=n.firstOption,c=n.secondOption,s=n.firstClass,u=n.secondClass,f=n.firstText,d=n.secondText,h=n.firstTooltip,g=n.secondTooltip;r&&o&&i?(a.log("DOMUtils: Updating toggle button to ".concat(e),null,2),e===l?(o.className=s,i.textContent=f,r.title=h||f,r.setAttribute("data-value",l)):e===c?(o.className=u,i.textContent=d,r.title=g||d,r.setAttribute("data-value",c)):a.warn("DOMUtils: Invalid toggle value: ".concat(e))):a.warn("DOMUtils: Missing elements for toggle button update")}},{key:"showMessage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=document.getElementById(e);if(!o)return a.warn("DOMUtils: Container #".concat(e," not found for message"),null,2),!1;r._iconName;var i=r.className,l=void 0===i?"mt-5":i,c=r.elementId,s=void 0===c?"":c,u=r.keepExisting,f=void 0!==u&&u,d=Q.getInstance();f||(o.innerHTML="");var h="";try{k.UTILITY&&k.UTILITY.HAS_ICON?h=k.UTILITY.HAS_ICON.name():(h="vdm-has-icon",a.log("DOMUtils: Using fallback icon class because Selectors.UTILITY.HAS_ICON is undefined",null,2))}catch(e){h="vdm-has-icon",a.warn("DOMUtils: Error getting icon class, using fallback",e,2)}var g=d.showAlert(t,n,{timeout:0,translate:!1,className:"".concat(h," ").concat(l)});return s&&(g.id=s),o.appendChild(g),!0}},{key:"toggleVisibility",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"block",r=document.getElementById(e);return r?(r.style.display=t?n:"none",!0):(a.warn("DOMUtils: Element #".concat(e," not found for visibility toggle"),null,2),!1)}},{key:"toggleClass",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=document.getElementById(e);return r?(n?r.classList.add(t):r.classList.remove(t),!0):(a.warn("DOMUtils: Element #".concat(e," not found for class toggle"),null,2),!1)}},{key:"createElement",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=document.createElement(n);return r&&(a.id=r),o&&(e=Array.isArray(o)?o:"string"==typeof o?o.split(/\s+/).filter(Boolean):[]).length>0&&(t=a.classList).add.apply(t,ne(e)),Object.entries(i).forEach((function(e){var t=te(e,2),n=t[0],r=t[1];null!=r&&a.setAttribute(n,r)})),a}},{key:"createAndAppendElement",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="string"==typeof n?document.getElementById(n):n;if(!o)return a.warn("DOMUtils: Container not found for createAndAppendElement",null,2),null;var i=r.id,l=void 0===i?null:i,c=r.classes,s=void 0===c?[]:c,u=r.attributes,f=void 0===u?{}:u,d=r.content,h=void 0===d?null:d,g=e.createElement(t,l,s,f);return null!==h&&("string"==typeof h?g.innerHTML=h:h instanceof Node&&g.appendChild(h)),o.appendChild(g),g}},{key:"setContent",value:function(e,t){var n=document.getElementById(e);return n?(n.innerHTML=t,!0):(a.warn("DOMUtils: Element #".concat(e," not found for content update"),null,2),!1)}},{key:"getElements",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,n="string"==typeof t?document.getElementById(t):t;return n?n.querySelectorAll(e):(a.warn("DOMUtils: Context not found for selector: ".concat(e),null,2),null)}},{key:"appendContent",value:function(e,t){var n=document.getElementById(e);return n?(n.insertAdjacentHTML("beforeend",t),!0):(a.warn("DOMUtils: Element #".concat(e," not found for content append"),null,2),!1)}},{key:"removeElement",value:function(e){var t="string"==typeof e?document.getElementById(e):t;return null!=t&&t.parentNode?(t.parentNode.removeChild(t),!0):(a.warn("DOMUtils: Element not found or has no parent for removal",null,2),!1)}},{key:"setupEventHandlers",value:function(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=o.context,a=void 0===i?document:i,l=o.removeExisting,c=void 0!==l&&l,s=o.styles,u=void 0===s?null:s,f=e.getElements(t,a);return f?(c&&f.forEach((function(e){e.removeEventListener(n,r)})),f.forEach((function(e){e.addEventListener(n,r),u&&Object.entries(u).forEach((function(t){var n=te(t,2),r=n[0],o=n[1];e.style[r]=o}))})),f.length):0}},{key:"createIcon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _.createIcon(e,t)}},{key:"getIconHtml",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _.getIcon(e,t)}}],(n=null)&&ie(t.prototype,n),r&&ie(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,fe(r.key),r)}}function fe(e){var t=function(e,t){if("object"!=se(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=se(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==se(t)?t:t+""}var de=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"mergeConfigurations",value:function(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=i[o];if(a&&"object"===se(a))for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&("object"!==se(e[l])||null===e[l]||Array.isArray(e[l])||"object"!==se(a[l])||null===a[l]||Array.isArray(a[l])?e[l]=a[l]:e[l]=this.mergeConfigurations(e[l],a[l]))}return e}},{key:"validateConfig",value:function(e){var t={isValid:!0,error:null};return e?(e.diffData?e.diffData.chunks||(t.isValid=!1,t.error="Missing chunks in diff data",e.diffData.chunks=[],console.warn("ConfigUtils: Missing chunks in diffData",{diffDataKeys:Object.keys(e.diffData)})):(t.isValid=!1,t.error="No diff data in configuration",e.diffData={old:[],new:[],chunks:[]},console.warn("ConfigUtils: Missing diffData in configuration",{configKeys:Object.keys(e),oldData:e.old?"present":"missing",newData:e.new?"present":"missing"})),t):(t.isValid=!1,t.error="No configuration found - window.diffConfig is not defined",t)}},{key:"getConfigSummary",value:function(e){var t;return{debug:!(null==e||!e.debug),chunks:Array.isArray(null==e||null===(t=e.diffData)||void 0===t?void 0:t.chunks)?e.diffData.chunks.length:0}}},{key:"getFileExtension",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"php";return e&&e.split(".").pop()||t}},{key:"getThemePreferences",value:function(e){var t,n;return{mode:localStorage.getItem("diffViewerTheme")||(null==e||null===(t=e.theme)||void 0===t?void 0:t.defaultMode)||"light",family:localStorage.getItem("diffViewerThemeFamily")||(null==e||null===(n=e.theme)||void 0===n?void 0:n.defaultFamily)||"atom-one"}}}],(t=null)&&ue(e.prototype,t),n&&ue(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function ge(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return me(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function pe(){pe=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new N(r||[]);return o(a,"_invoke",{value:S(e,n,l)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",p={};function v(){}function y(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,T=E&&E(E(_([])));T&&T!==n&&r.call(T,a)&&(w=T);var I=b.prototype=v.prototype=Object.create(w);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,i,a,l){var c=f(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==he(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,n,r){var o=d;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=k(l,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=f(t,n,r);if("normal"===s.type){if(o=r.done?m:h,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(he(t)+" is not iterable")}return y.prototype=b,o(I,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},C(L.prototype),s(L.prototype,l,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new L(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(I),s(I,c,"Generator"),s(I,a,(function(){return this})),s(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}function ve(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function ye(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ve(i,r,o,a,l,"next",e)}function l(e){ve(i,r,o,a,l,"throw",e)}a(void 0)}))}}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,we(r.key),r)}}function we(e){var t=function(e,t){if("object"!=he(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=he(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==he(t)?t:t+""}function Ee(e,t,n){return t=Ie(t),function(e,t){if(t&&("object"==he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Te()?Reflect.construct(t,n||[],Ie(e).constructor):t.apply(e,n))}function Te(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Te=function(){return!!e})()}function Ie(e){return Ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ie(e)}function Ce(e,t){return Ce=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ce(e,t)}function Le(e,t,n){Se(e,t),t.set(e,n)}function Se(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ke(e,t,n){return e.set(Oe(e,t),n),n}function Me(e,t){return e.get(Oe(e,t))}function Oe(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var Ne=new WeakMap,_e=new WeakMap,je=new WeakSet,xe=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=Ee(this,t,[].concat(i)),Se(n=e,r=je),r.add(n),Le(e,Ne,null),Le(e,_e,null),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ce(e,t)}(t,e),n=t,r=[{key:"discoverEndpoint",value:(c=ye(pe().mark((function e(){var t,n,r,o,i;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Me(Ne,this)){e.next=3;break}return a.log("EndpointDiscovery: Using cached API endpoint",Me(Ne,this),2),e.abrupt("return",Me(Ne,this));case 3:if(e.prev=3,null===(t=window.diffConfig)||void 0===t||!t.apiEndpoint){e.next=8;break}return a.log("EndpointDiscovery: Using configured API endpoint",window.diffConfig.apiEndpoint,2),ke(Ne,this,window.diffConfig.apiEndpoint),e.abrupt("return",Me(Ne,this));case 8:if(!(n=Oe(je,this,Ae).call(this))){e.next=13;break}return a.log("EndpointDiscovery: Determined API endpoint from script location",n,2),ke(Ne,this,n),e.abrupt("return",Me(Ne,this));case 13:return a.log("EndpointDiscovery: Discovering API endpoint from endpoint-config.php",null,2),r=Oe(je,this,De).call(this),a.log("EndpointDiscovery: Fetching from",r,2),e.next=18,fetch(r);case 18:if((o=e.sent).ok){e.next=21;break}throw new Error("Failed to fetch endpoint config: ".concat(o.statusText));case 21:return e.next=23,o.json();case 23:if(i=e.sent,a.log("EndpointDiscovery: Endpoint discovery response",i,2),void 0===(null==i?void 0:i.apiEndpoint)){e.next=31;break}return ke(Ne,this,i.apiEndpoint),a.log("EndpointDiscovery: Successfully discovered API endpoint",Me(Ne,this),1),e.abrupt("return",Me(Ne,this));case 31:throw new Error("Invalid endpoint config response: apiEndpoint not found");case 32:e.next=40;break;case 34:return e.prev=34,e.t0=e.catch(3),a.log("EndpointDiscovery: Error discovering endpoint",e.t0,1),ke(Ne,this,"./api/"),a.log("EndpointDiscovery: Using fallback endpoint",Me(Ne,this),1),e.abrupt("return",Me(Ne,this));case 40:case"end":return e.stop()}}),e,this,[[3,34]])}))),function(){return c.apply(this,arguments)})},{key:"getEndpoint",value:(l=ye(pe().mark((function e(t){var n,r;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Me(Ne,this)){e.next=13;break}if(!Me(_e,this)){e.next=6;break}return e.next=4,Me(_e,this);case 4:e.next=13;break;case 6:return ke(_e,this,this.discoverEndpoint()),e.prev=7,e.next=10,Me(_e,this);case 10:return e.prev=10,ke(_e,this,null),e.finish(10);case 13:if(t){e.next=15;break}return e.abrupt("return",Me(Ne,this));case 15:return(n={ajaxDiffMerge:"ajax-diff-merge.php",diffProcessor:"diff-processor.php",getFileContent:"get-file-content.php",endpointsConfig:"endpoint-config.php",endpoints:"endpoints-config.php"}[t])||(n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+".php"),r=Me(Ne,this).endsWith("/")?Me(Ne,this):Me(Ne,this)+"/",a.log("EndpointDiscovery: Resolved ".concat(t," to endpoint"),r+n,2),e.abrupt("return",r+n);case 21:case"end":return e.stop()}}),e,this,[[7,,10,13]])}))),function(e){return l.apply(this,arguments)})},{key:"getApiUrl",value:(i=ye(pe().mark((function e(t){var n;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getEndpoint();case 2:return n=e.sent,e.abrupt("return","".concat(n).concat(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}],o=[{key:"getInstance",value:function(){return Pe._||(Pe._=new t),Pe._}}],r&&be(n.prototype,r),o&&be(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,l,c}(u);function Ae(){try{var e,t=document.querySelectorAll("script"),n=null,r=ge(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;if(o.src&&(o.src.includes("diff-viewer.js")||o.src.includes("diff-viewer.min.js"))){n=o.src;break}}}catch(e){r.e(e)}finally{r.f()}if(!n)return null;var i=n.substring(0,n.lastIndexOf("/")+1);return i.endsWith("/dist/")&&(i=i.substring(0,i.length-5)),"".concat(i,"api/")}catch(e){return a.log("EndpointDiscovery: Error determining endpoint from script",e,2),null}}function De(){var e=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);return e.includes("/diff-viewer/")?"".concat(e.substring(0,e.lastIndexOf("/diff-viewer/")),"api/endpoint-config.php"):"".concat(e,"api/endpoint-config.php")}var Pe={_:null};function Re(e){return Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Re(e)}function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e,t,n){return(t=ze(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Be(){Be=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new N(r||[]);return o(a,"_invoke",{value:S(e,n,l)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",p={};function v(){}function y(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,T=E&&E(E(_([])));T&&T!==n&&r.call(T,a)&&(w=T);var I=b.prototype=v.prototype=Object.create(w);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,i,a,l){var c=f(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==Re(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,n,r){var o=d;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=k(l,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=f(t,n,r);if("normal"===s.type){if(o=r.done?m:h,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(Re(t)+" is not iterable")}return y.prototype=b,o(I,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},C(L.prototype),s(L.prototype,l,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new L(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(I),s(I,c,"Generator"),s(I,a,(function(){return this})),s(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}function He(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function Ve(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){He(i,r,o,a,l,"next",e)}function l(e){He(i,r,o,a,l,"throw",e)}a(void 0)}))}}function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ze(r.key),r)}}function ze(e){var t=function(e,t){if("object"!=Re(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Re(t)?t:t+""}function Ye(e,t){if(t&&("object"==Re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function We(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(We=function(){return!!e})()}function qe(e){return qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qe(e)}function Ke(e,t){return Ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ke(e,t)}var Xe=null,Je=function(e){function t(){var e,n,r,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=qe(r=t),(e=Ye(n,We()?Reflect.construct(r,o||[],qe(n).constructor):r.apply(n,o)))._isFirstInstance(Xe)?(e.initialized=!1,e.availableThemes=null,e.currentTheme={family:null,mode:null},e.defaultTheme={family:"atom-one",mode:"dark"},e.listeners=[],e.resourceLoader=null,Xe=e,e):Ye(e)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ke(e,t)}(t,e),n=t,r=[{key:"initialize",value:function(e,t){if(a.log("ThemeManager: Initializing",{config:e},2),this.initialized)return!0;this.config=(null==e?void 0:e.theme)||{},this.resourceLoader=t,this.availableThemes=t.config.availableThemes,this.defaultTheme.family=this.config.defaultFamily||this.defaultTheme.family,this.defaultTheme.mode=this.config.defaultMode||this.defaultTheme.mode;var n=localStorage.getItem("diffViewerThemeFamily")||this.defaultTheme.family,r=localStorage.getItem("diffViewerTheme")||this.defaultTheme.mode;return this.currentTheme={family:n,mode:r},a.log("ThemeManager: Initialized with ".concat(n," (").concat(r,")"),null,2),this.initialized=!0,a.log("ThemeManager: Successfully initialized",null,2),!0}},{key:"getThemeUrl",value:function(e,t){var n,r,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null!==(n=this.availableThemes)&&void 0!==n&&null!==(n=n[e])&&void 0!==n&&n[t])return this.availableThemes[e][t];if(!o)return null;var i="dark"===t?"light":"dark";return null!==(r=this.availableThemes)&&void 0!==r&&null!==(r=r[e])&&void 0!==r&&r[i]?(a.log("ThemeManager: Theme ".concat(e," doesn't have ").concat(t," mode, using ").concat(i," instead"),null,2),this.availableThemes[e][i]):(a.log("ThemeManager: Falling back to default theme: ".concat(this.defaultTheme.family," (").concat(t,")"),null,2),this.availableThemes[this.defaultTheme.family][t]||this.availableThemes[this.defaultTheme.family][i])}},{key:"themeExists",value:function(e,t){var n;return!(null===(n=this.availableThemes)||void 0===n||null===(n=n[e])||void 0===n||!n[t])}},{key:"getAvailableThemeFamilies",value:function(){return Object.keys(this.availableThemes||{})}},{key:"getAvailableModesForFamily",value:function(e){var t;return null!==(t=this.availableThemes)&&void 0!==t&&t[e]?Object.keys(this.availableThemes[e]):[]}},{key:"getThemeCdnVersion",value:function(){return"11.11.1"}},{key:"getThemeCdnBase",value:function(){return"https://cdnjs.cloudflare.com/ajax/libs/highlight.js"}},{key:"getStandardThemeUrl",value:function(e,t){return"".concat(this.getThemeCdnBase(),"/").concat(this.getThemeCdnVersion(),"/styles/base16/").concat(e,"-").concat(t,".min.css")}},{key:"applyTheme",value:(s=Ve(Be().mark((function e(t,n){var r,o,i;return Be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initialized&&this.resourceLoader){e.next=3;break}return a.warn("ThemeManager: Not properly initialized",null,2),e.abrupt("return",!1);case 3:if(r=this.getThemeUrl(t,n)){e.next=7;break}return a.error("ThemeManager: Could not resolve URL for theme ".concat(t,"/").concat(n),null,2),e.abrupt("return",!1);case 7:if(a.log("ThemeManager: Applying theme ".concat(t,"/").concat(n),null,2),!(o=document.querySelector('link[href*="highlight.js"][href*="/styles/"][rel="stylesheet"]:not([disabled])'))||o.getAttribute("href")!==r){e.next=12;break}return a.log("ThemeManager: Theme ".concat(t,"/").concat(n," already active"),null,2),e.abrupt("return",!0);case 12:if(e.prev=12,document.querySelector('link[href="'.concat(r,'"]'))){e.next=16;break}return e.next=16,this.resourceLoader.loadCSS(r);case 16:return document.querySelectorAll('link[href*="highlight.js"][href*="/styles/"][rel="stylesheet"]:not([disabled])').forEach((function(e){e.disabled=!0})),(i=document.querySelector('link[href="'.concat(r,'"]')))&&(i.disabled=!1,a.log("ThemeManager: Theme applied: ".concat(t," (").concat(n,")"),null,2)),this.updateContainerThemeClass(n),this.currentTheme={family:t,mode:n},localStorage.setItem("diffViewerThemeFamily",t),localStorage.setItem("diffViewerTheme",n),this.notifyListeners(),a.log("ThemeManager: Theme applied successfully: ".concat(t,"/").concat(n),null,2),e.abrupt("return",!0);case 28:return e.prev=28,e.t0=e.catch(12),a.error("ThemeManager: Error during theme operation:",e.t0,2),e.abrupt("return",!1);case 32:case"end":return e.stop()}}),e,this,[[12,28]])}))),function(e,t){return s.apply(this,arguments)})},{key:"updateContainerThemeClass",value:function(e){var t=document.getElementById(k.CONTAINER.WRAPPER.name());t&&(t.classList.remove(k.THEME.DARK.name(),k.THEME.LIGHT.name()),t.classList.add(k.THEME.MODE_PREFIX.name()+"--"+e))}},{key:"setThemeMode",value:(c=Ve(Be().mark((function e(t){return Be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.log("ThemeManager: Setting theme mode to ".concat(t),null,2),e.abrupt("return",this.applyTheme(this.currentTheme.family,t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"setThemeFamily",value:(l=Ve(Be().mark((function e(t){return Be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.log("ThemeManager: Setting theme family to ".concat(t),null,2),e.abrupt("return",this.applyTheme(t,this.currentTheme.mode));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"addListener",value:function(e){"function"==typeof e&&this.listeners.push(e)}},{key:"notifyListeners",value:function(){var e=this;this.listeners.forEach((function(t){try{t(e.currentTheme)}catch(e){a.error("ThemeManager: Error in theme listener:",e,2)}}))}},{key:"getCurrentTheme",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.currentTheme)}},{key:"loadInitialTheme",value:(i=Ve(Be().mark((function e(){var t,n,r,o;return Be().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initialized&&this.resourceLoader){e.next=3;break}return a.warn("ThemeManager: Not properly initialized",null,2),e.abrupt("return",!1);case 3:if(t=this.currentTheme.family||this.defaultTheme.family,n=this.currentTheme.mode||this.defaultTheme.mode,a.log("ThemeManager: Loading initial theme ".concat(t,"/").concat(n),null,2),e.prev=6,r=this.getThemeUrl(t,n)){e.next=11;break}return a.error("ThemeManager: Could not resolve URL for theme ".concat(t,"/").concat(n),null,2),e.abrupt("return",!1);case 11:if(document.querySelector('link[href="'.concat(r,'"]'))){e.next=14;break}return e.next=14,this.resourceLoader.loadCSS(r);case 14:return document.querySelectorAll('link[href*="highlight.js"][href*="/styles/"][rel="stylesheet"]:not([disabled])').forEach((function(e){e.disabled=!0})),(o=document.querySelector('link[href="'.concat(r,'"]')))&&(o.disabled=!1,a.log("ThemeManager: Theme applied: ".concat(t," (").concat(n,")"),null,2)),this.updateContainerThemeClass(n),this.currentTheme={family:t,mode:n},localStorage.setItem("diffViewerThemeFamily",t),localStorage.setItem("diffViewerTheme",n),this.notifyListeners(),a.log("ThemeManager: Initial theme applied successfully: ".concat(t,"/").concat(n),null,2),e.abrupt("return",!0);case 26:return e.prev=26,e.t0=e.catch(6),a.error("ThemeManager: Error during initial theme loading:",e.t0,2),e.abrupt("return",!1);case 30:case"end":return e.stop()}}),e,this,[[6,26]])}))),function(){return i.apply(this,arguments)})}],o=[{key:"getInstance",value:function(){return Xe||(Xe=new t),Xe}}],r&&Ge(n.prototype,r),o&&Ge(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,l,c,s}(u);function $e(e){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$e(e)}function Ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Qe(r.key),r)}}function Qe(e){var t=function(e,t){if("object"!=$e(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$e(t)?t:t+""}function et(e,t){if(t&&("object"==$e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(tt=function(){return!!e})()}function nt(e){return nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nt(e)}function rt(e,t){return rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rt(e,t)}var ot=null,it=function(e){function t(e){var n,r,o,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=nt(o=t),(n=et(r,tt()?Reflect.construct(o,i||[],nt(r).constructor):o.apply(r,i)))._isFirstInstance(ot)?(a.log("ThemeSelector: Instance created",null,3),n.diffViewer=e,n.container=null,n.selectElement=null,n.themeManager=Je.getInstance(),n.translationManager=H.getInstance(),n.browserUIManager=null,n.boundHandleThemeChange=n.handleThemeChange.bind(n),ot=n,n):et(n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rt(e,t)}(t,e),n=t,o=[{key:"getInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return a.log("ThemeSelector: Retrieving or creating instance",null,3),ot?e&&!ot.diffViewer&&(ot.diffViewer=e):ot=new t(e),ot}}],(r=[{key:"initialize",value:function(){var e=this;if(!this._isThemeSelectorEnabled())return a.log("ThemeSelector: Theme selector disabled in configuration",null,2),!1;a.log("ThemeSelector: Initializing",null,2);var t=document.getElementById(k.THEME.SELECTOR.name());if(t)return a.log("ThemeSelector: Reusing existing selector in DOM",null,2),this.selectElement=t,this.container=t.parentNode,this.updateSelector(),this.selectElement.removeEventListener("change",this.boundHandleThemeChange),this.selectElement.addEventListener("change",this.boundHandleThemeChange),a.log("ThemeSelector: Reused existing selector successfully",null,2),!0;if(this.browserUIManager){var n=this.browserUIManager.generateThemeSelector();if(n)return a.log("ThemeSelector: Using selector created by BrowserUIManager",null,2),this.container=n.container,this.selectElement=n.selectElement,this.populateSelectorOptions()||(a.log("ThemeSelector: Initial population failed, retrying after delay",null,2),setTimeout((function(){e.populateSelectorOptions(),e.updateSelector()}),100)),this.updateSelector(),this.selectElement.addEventListener("change",this.boundHandleThemeChange),a.log("ThemeSelector: Initialized with BrowserUIManager selector successfully",null,2),!0}return this.createSelectorElement(),this.addSelectorToDOM(),this.updateSelector(),this.themeManager.addListener(this.updateSelector.bind(this)),this.themeManager.addListener((function(){e.selectElement&&0===e.selectElement.options.length&&(a.log("ThemeSelector: Themes became available, repopulating options",null,2),e.populateSelectorOptions())})),a.log("ThemeSelector: Initialized successfully",null,2),!0}},{key:"_isThemeSelectorEnabled",value:function(){var e,t,n;return void 0!==(null===(e=this.diffViewer)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.theme)||void 0===e?void 0:e.selector)?!!this.diffViewer.getConfig().theme.selector:void 0!==(null===(t=this.diffViewer)||void 0===t||null===(t=t.options)||void 0===t?void 0:t.themeSelector)?!!this.diffViewer.options.themeSelector:void 0===(null===(n=window.diffConfig)||void 0===n||null===(n=n.theme)||void 0===n?void 0:n.selector)||!!window.diffConfig.theme.selector}},{key:"populateSelectorOptions",value:function(){var e=this;if(a.log("ThemeSelector: Starting to populate selector options",null,2),!this.selectElement)return a.warn("ThemeSelector: No select element available for population",null,2),!1;if(!this.themeManager)return a.warn("ThemeSelector: No theme manager available for population",null,2),!1;var t=this.themeManager.getCurrentTheme();a.log("ThemeSelector: Current theme",t,2),this.selectElement.innerHTML="";var n=this.themeManager.getAvailableThemeFamilies();return a.log("ThemeSelector: Available themes",{availableThemes:n,count:(null==n?void 0:n.length)||0},2),n&&0!==n.length?(n.forEach((function(n){ce.createAndAppendElement("option",e.selectElement,{attributes:{value:n,selected:n===t.family},content:e.formatThemeName(n)})})),a.log("ThemeSelector: Populated selector with options",{count:n.length},2),!0):(a.warn("ThemeSelector: No available themes found",null,2),!1)}},{key:"createSelectorElement",value:function(){a.log("ThemeSelector: Creating new selector element",null,2),this.container=ce.createElement("div",null,[k.THEME_SELECTOR.WRAPPER.name(),k.UTILITY.MARGIN_END_3.name()]),this.selectElement=ce.createAndAppendElement("select",this.container,{id:k.THEME.SELECTOR.name(),classes:[k.UTILITY.FORM_SELECT.name(),k.UTILITY.FORM_SELECT.name()]}),this.populateSelectorOptions(),this.selectElement.addEventListener("change",this.boundHandleThemeChange)}},{key:"formatThemeName",value:function(e){return e.split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")}},{key:"addSelectorToDOM",value:function(){var e=ce.getElement(k.THEME.SWITCHER.name());return e?(e.insertBefore(this.container,e.firstChild),a.log("ThemeSelector: Selector added to DOM",null,2),!0):(a.warn("ThemeSelector: No theme switcher container found",null,2),!1)}},{key:"updateSelector",value:function(e){if(this.selectElement){0===this.selectElement.options.length&&(a.log("ThemeSelector: Selector has no options, attempting to populate",null,2),this.populateSelectorOptions());var t=e||this.themeManager.getCurrentTheme();this.selectElement.options.length>0&&(this.selectElement.value=t.family),a.log("ThemeSelector: Selector updated to ".concat((null==e?void 0:e.family)||t.family),{optionsCount:this.selectElement.options.length},3)}}},{key:"handleThemeChange",value:function(e){var t,n=this,r=e.target.value;!this.browserUIManager&&null!==(t=this.diffViewer)&&void 0!==t&&t.browserUIManager&&(this.browserUIManager=this.diffViewer.browserUIManager),this.browserUIManager&&this.browserUIManager.showThemeLoading();try{this.themeManager.setThemeFamily(r).then((function(){n.browserUIManager&&n.browserUIManager.hideThemeLoading(),a.log("ThemeSelector: Theme changed to ".concat(r),null,2)})).catch((function(e){n.browserUIManager&&n.browserUIManager.hideThemeLoading(),a.error("ThemeSelector: Error changing theme:",e,2)}))}catch(e){this.browserUIManager&&this.browserUIManager.hideThemeLoading(),a.error("ThemeSelector: Error changing theme:",e,2)}}},{key:"setBrowserUIManager",value:function(e){this.browserUIManager=e,a.log("ThemeSelector: BrowserUIManager reference set",null,3)}}])&&Ze(n.prototype,r),o&&Ze(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o}(u);function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ct(r.key),r)}}function ct(e){var t=function(e,t){if("object"!=at(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=at(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==at(t)?t:t+""}var st=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"escapeHtml",value:function(e){return e&&"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#x60;"):""}},{key:"escapeAttribute",value:function(e){return e?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}}],(t=null)&&lt(e.prototype,t),n&&lt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dt(r.key),r)}}function dt(e){var t=function(e,t){if("object"!=ut(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ut(t)?t:t+""}var ht=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,r=[{key:"formatPreview",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t)return a.warn("MergeContentFormatter: Empty content for preview formatting",null,2),"<pre><code>No content available</code></pre>";var o=t,i=st.escapeHtml(t),l=e.getLanguageClass(n),c="<pre ".concat(r?'data-line-numbers="true"':"",'><code class="').concat(l,'" data-original-code="').concat(st.escapeAttribute(o),'">').concat(i,"</code></pre>");return a.log("MergeContentFormatter: Preview HTML generated",{preview:c.substring(0,150)+"..."},2),c}},{key:"getLanguageClass",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?{js:"javascript",ts:"typescript",py:"python",rb:"ruby",java:"java",cs:"csharp",php:"php",html:"html",css:"css",json:"json",xml:"xml",yml:"yaml",yaml:"yaml",md:"markdown",sql:"sql"}[e.toLowerCase()]||e.toLowerCase():""}},{key:"formatUnresolvedCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return 1===e?(t.unresolvedChunkSingular||"There is %COUNT% unresolved chunk remaining.").replace("%COUNT%",e):(t.unresolvedChunksPlural||"There are %COUNT% unresolved chunks remaining.").replace("%COUNT%",e)}},{key:"prepareCode",value:function(e){return e.replace(/\r\n/g,"\n")}},{key:"resetHighlighting",value:function(e){if(!e)return null;e.hasAttribute("data-highlighted")&&e.removeAttribute("data-highlighted");var t=e.textContent;return e.textContent=t,t}}],(n=null)&&ft(t.prototype,n),r&&ft(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();const gt=JSON.parse('{"1c":"1c","abnf":"abnf","accesslog":"accesslog","actionscript-file":"actionscript","adb":"ada","ads":"ada","angelscript":"angelscript","as":"angelscript","apacheconf":"apache","htaccess":"apache","applescript":"applescript","arcade":"arcade","ino":"arduino","arm":"armasm","adoc":"asciidoc","aspectj":"aspectj","ahk":"autohotkey","au3":"autoit","asm":"x86asm","awk":"awk","ax":"axapta","sh":"bash","bash":"bash","zsh":"bash","bas":"basic","bnf":"bnf","bf":"brainfuck","c":"c","h":"c","cal":"cal","capnp":"capnproto","ceylon":"ceylon","icl":"clean","dcl":"clean","clj":"clojure","cljs":"clojure","cmake":"cmake","cmakein":"cmake","coffee":"coffeescript","coq":"coq","cos":"cos","cls":"cos","cpp":"cpp","cc":"cpp","cplus":"cpp","hplus":"cpp","hpp":"cpp","hh":"cpp","hxx":"cpp","cxx":"cpp","crm":"crmsh","cr":"crystal","cs":"csharp","csx":"csharp","csp":"csp","css":"css","d":"d","dart":"dart","dpr":"delphi","dfm":"delphi","pas":"delphi","pascal":"delphi","diff":"diff","patch":"diff","django":"django","jinja":"django","dns":"dns","zone":"dns","bind":"dns","dockerfile":"dockerfile","docker":"dockerfile","bat":"dos","cmd":"dos","dts":"dts","dust":"dust","dst":"dust","ebnf":"ebnf","ex":"elixir","exs":"elixir","elm":"elm","erb":"erb","erl":"erlang","hrl":"erlang","xlsx":"excel","xls":"excel","fix":"fix","flix":"flix","f":"fortran","for":"fortran","f90":"fortran","f95":"fortran","fs":"fsharp","fsi":"fsharp","fsx":"fsharp","gms":"gams","gss":"gauss","gcode":"gcode","nc":"gcode","feature":"gherkin","glsl":"glsl","vert":"glsl","frag":"glsl","gml":"gml","go":"go","golo":"golo","gradle":"gradle","graphql":"graphql","gql":"graphql","groovy":"groovy","haml":"haml","handlebars":"handlebars","hbs":"handlebars","hs":"haskell","hx":"haxe","hsp":"hsp","http":"http","https":"http","hy":"hy","i7":"inform7","ini":"ini","toml":"ini","editorconfig":"ini","gitconfig":"ini","irpf90":"irpf90","isbl":"isbl","java":"java","js":"javascript","mjs":"javascript","cli":"jboss-cli","json":"json","jl":"julia","kt":"kotlin","kts":"kotlin","lasso":"lasso","lassoscript":"lasso","tex":"latex","latex":"latex","ldif":"ldif","leaf":"leaf","less":"less","lisp":"lisp","cl":"lisp","el":"lisp","lc":"livecodeserver","ls":"livescript","ll":"llvm","lsl":"lsl","lua":"lua","mk":"makefile","mak":"makefile","make":"makefile","md":"markdown","mkdown":"markdown","mkd":"markdown","mathematica":"mathematica","mma":"mathematica","wl":"mathematica","matlab":"matlab","m":"matlab","maxima":"maxima","mel":"mel","mercury":"mercury","mips":"mipsasm","mizar":"mizar","mojolicious":"mojolicious","monkey":"monkey","moon":"moonscript","n1ql":"n1ql","nt":"nestedtext","nginx":"nginx","nginxconf":"nginx","nim":"nim","nix":"nix","nsi":"nsis","nsh":"nsis","mm":"objectivec","ml":"ocaml","scad":"openscad","oxygene":"oxygene","parser3":"parser3","pl":"perl","pm":"perl","perl":"perl","pf":"pf","pfconf":"pf","pgsql":"pgsql","postgres":"pgsql","postgresql":"pgsql","php":"php","php3":"php","php4":"php","php5":"php","php7":"php","phps":"php","phtml":"php-template","txt":"plaintext","text":"plaintext","pony":"pony","ps1":"powershell","psm1":"powershell","psd1":"powershell","pde":"processing","profile":"profile","prolog":"prolog","plg":"prolog","properties":"properties","prop":"properties","proto":"protobuf","pp":"puppet","pb":"purebasic","pbi":"purebasic","py":"python","pyw":"python","pyc":"python","pyd":"python","pyo":"python","q":"q","qml":"qml","r":"r","rsource":"r","re":"reasonml","rei":"reasonml","rib":"rib","roboconf":"roboconf","routeros":"routeros","mikrotik":"routeros","rsl":"rsl","rb":"ruby","ruby":"ruby","gemspec":"ruby","podspec":"ruby","thor":"ruby","irb":"ruby","rs":"rust","rust":"rust","sas":"sas","scala":"scala","sc":"scala","scm":"scheme","ss":"scheme","sci":"scilab","sce":"scilab","scss":"scss","shellscript":"shell","fish":"shell","smali":"smali","st":"smalltalk","sml":"sml","sqf":"sqf","sql":"sql","stan":"stan","ado":"stata","do":"stata","p21":"step21","step":"step21","stp":"step21","styl":"stylus","subunit":"subunit","swift":"swift","taggerscript":"taggerscript","tap":"tap","tcl":"tcl","tk":"tcl","thrift":"thrift","tp":"tp","twig":"twig","ts":"typescript","tsx":"typescript","vala":"vala","vb":"vbnet","vbs":"vbscript","v":"verilog","sv":"verilog","svh":"verilog","vhd":"vhdl","vhdl":"vhdl","vim":"vim","wasm":"wasm","wren":"wren","nasm":"x86asm","xl":"xl","tao":"xl","xml":"xml","xhtml":"xml","rss":"xml","atom":"xml","xjb":"xml","xsd":"xml","xsl":"xml","plist":"xml","svg":"xml","html":"xml","htm":"xml","xq":"xquery","xquery":"xquery","yml":"yaml","yaml":"yaml"}');function mt(e){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(e)}function pt(e){return function(e){if(Array.isArray(e))return bt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||yt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||yt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){if(e){if("string"==typeof e)return bt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bt(e,t):void 0}}function bt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function wt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(n),!0).forEach((function(t){Tt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tt(e,t,n){return(t=Ct(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ct(r.key),r)}}function Ct(e){var t=function(e,t){if("object"!=mt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mt(t)?t:t+""}function Lt(e,t,n){return t=kt(t),function(e,t){if(t&&("object"==mt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,St()?Reflect.construct(t,n||[],kt(e).constructor):t.apply(e,n))}function St(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(St=function(){return!!e})()}function kt(e){return kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kt(e)}function Mt(e,t){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mt(e,t)}var Ot=null,Nt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Lt(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mt(e,t)}(t,e),n=t,r=[{key:"initialize",value:function(){this.initialized||(this.activeLoaders=new Map,this.loaderIdCounter=0,this.isMainLoaderActive=!1,this.mainLoaderId=null,this.recentlyRemovedLoaders=new Set,this.operationLog=[],this.maxLogEntries=20,this.verboseLogging=!!a.isInitialized&&a.logLevel>2,this.initialized=!0)}},{key:"_logOperation",value:function(e,t){this.operationLog.length>=this.maxLogEntries&&this.operationLog.shift(),this.operationLog.push({timestamp:(new Date).toISOString(),operation:e,details:t})}},{key:"_createLoaderElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&"string"==typeof e&&e.startsWith("$")&&H.getInstance().isInitialized()){var n=e.substring(1),r=H.getInstance().get(n);r&&(e=r)}var o=document.createElement("div");o.className="vdm-loader",t.fullscreen&&o.classList.add("vdm-loader--fullscreen"),t.inline&&o.classList.add("vdm-loader--inline"),t.small&&o.classList.add("vdm-loader--small"),t.container&&o.classList.add("vdm-loader--container"),t.className&&o.classList.add(t.className),t.zIndex&&(o.style.zIndex=t.zIndex);var i=document.createElement("div");if(i.className="vdm-loader__spinner",o.appendChild(i),e){var a=document.createElement("div");a.className="vdm-loader__message",a.textContent=e,o.appendChild(a)}return o}},{key:"showLoader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.isMainLoaderActive&&this.mainLoaderId&&t.fullscreen)return a.log("LoaderManager: Reusing main loader for fullscreen request",{message:e},3),this.updateLoaderMessage(this.mainLoaderId,e),this.mainLoaderId;a.log("LoaderManager: Showing loader",{message:e,options:t},3);var n="loader-".concat(++this.loaderIdCounter),r=this._createLoaderElement(e,t);return r.setAttribute("data-loader-id",n),t.target&&t.target instanceof HTMLElement?("static"===window.getComputedStyle(t.target).getPropertyValue("position")&&(t.target.style.position="relative"),t.target.appendChild(r)):document.body.appendChild(r),this.activeLoaders.set(n,{element:r,target:t.target||document.body,fullscreen:!!t.fullscreen,timestamp:Date.now()}),this.recentlyRemovedLoaders.delete(n),this._logOperation("show",{id:n,message:e,type:"regular"}),setTimeout((function(){r.parentNode&&r.classList.add("vdm-loader--showing")}),10),n}},{key:"showMainLoader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a.log("LoaderManager: Showing main loader",{message:e},2),this.isMainLoaderActive&&this.mainLoaderId&&this.activeLoaders.has(this.mainLoaderId))return a.log("LoaderManager: Main loader already active, updating message",{currentId:this.mainLoaderId,message:e},2),this.updateLoaderMessage(this.mainLoaderId,e),this.mainLoaderId;this._hideAllInlineLoaders();var n=document.getElementById(k.LOADER.MAIN.name());if(n){n.style.display="flex",n.classList.add(k.LOADER.ACTIVE.name());var r=n.querySelector(".vdm-loader__message");if(r)r.textContent=e;else if(e){var o=document.createElement("div");o.className="vdm-loader__message",o.textContent=e,n.appendChild(o)}var i="main-loader-".concat(++this.loaderIdCounter);return this.activeLoaders.set(i,{element:n,target:document.body,isMainLoader:!0,timestamp:Date.now()}),this.isMainLoaderActive=!0,this.mainLoaderId=i,this.recentlyRemovedLoaders.delete(i),this._logOperation("show",{id:i,message:e,type:"main-existing"}),i}var l=this.showLoader(e,Et({fullscreen:!0,className:k.LOADER.MAIN.name(),zIndex:9999},t)),c=this.activeLoaders.get(l);return c&&(c.isMainLoader=!0,c.element.id=k.LOADER.MAIN.name()),this.isMainLoaderActive=!0,this.mainLoaderId=l,this._logOperation("show",{id:l,message:e,type:"main-new"}),l}},{key:"showEarlyLoader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a.isInitialized&&a.log("LoaderManager: Showing early loader",{message:e},2);var n=this.showLoader(e,Et({fullscreen:!0,className:k.LOADER.MAIN.name(),zIndex:9999},t)),r=this.activeLoaders.get(n);return r&&(r.isMainLoader=!0,r.isEarlyLoader=!0,r.element.id=k.LOADER.MAIN.name()),this.isMainLoaderActive=!0,this.mainLoaderId=n,this._logOperation("show",{id:n,message:e,type:"early-loader"}),n}},{key:"adoptEarlyLoader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.isMainLoaderActive&&this.mainLoaderId?(e&&this.updateLoaderMessage(this.mainLoaderId,e),a.isInitialized&&a.log("LoaderManager: Adopted early loader as main loader",{id:this.mainLoaderId},2),this.mainLoaderId):(a.isInitialized&&a.log("LoaderManager: No early loader to adopt, creating new main loader",null,2),this.showMainLoader(e))}},{key:"hideMainLoader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(a.log("LoaderManager: Hiding main loader",{loaderId:e},2),e&&this.recentlyRemovedLoaders.has(e))return a.log("LoaderManager: Main loader was recently removed",{loaderId:e},2),!0;if(!this.isMainLoaderActive)return a.log("LoaderManager: Main loader not active, nothing to hide",null,2),!0;if(e&&e!==this.mainLoaderId){var t=this.activeLoaders.get(e);null!=t&&t.isMainLoader||(a.log("LoaderManager: Using stored main loader ID",{providedId:e,actualMainId:this.mainLoaderId},2),e=this.mainLoaderId)}else e||(e=this.mainLoaderId);if(!e||!this.activeLoaders.has(e)){var n=document.getElementById(k.LOADER.MAIN.name());return n&&(n.style.display="none",n.parentNode&&n.parentNode.removeChild(n),a.log("LoaderManager: Removed main loader by element ID",null,2)),this.isMainLoaderActive=!1,this.mainLoaderId=null,!0}var r=this._hideSpecificLoader(e);return r&&(this.recentlyRemovedLoaders.add(e),this.isMainLoaderActive=!1,this.mainLoaderId=null,this._logOperation("hide",{id:e,type:"main"})),r}},{key:"_hideAllInlineLoaders",value:function(){var e=this;a.log("LoaderManager: Hiding all inline loaders",null,3),Array.from(this.activeLoaders.entries()).filter((function(e){var t=vt(e,2),n=(t[0],t[1]);return!n.isMainLoader&&!n.fullscreen})).map((function(e){return vt(e,1)[0]})).forEach((function(t){e._hideSpecificLoader(t),e.recentlyRemovedLoaders.add(t),e._logOperation("hide",{id:t,type:"inline-batch"})})),document.querySelectorAll(".vdm-loader--inline").forEach((function(t){e._removeLoaderElement(t),e._logOperation("hide",{element:"untracked-inline",type:"dom-query"})}))}},{key:"hideLoader",value:function(e){var t=this;if(!e){a.log("LoaderManager: Hiding all loaders",null,3);var n=Array.from(this.activeLoaders.keys()),r=!0;return n.forEach((function(e){t._hideSpecificLoader(e)||(r=!1),t.recentlyRemovedLoaders.add(e),t._logOperation("hide",{id:e,type:"all-batch"})})),this.isMainLoaderActive=!1,this.mainLoaderId=null,r}if(this.recentlyRemovedLoaders.has(e))return a.log("LoaderManager: Loader was recently removed",{loaderId:e},2),!0;if(e===this.mainLoaderId)return this.hideMainLoader(e);a.log("LoaderManager: Hiding loader",{loaderId:e},3);var o=this._hideSpecificLoader(e);return o&&(this.recentlyRemovedLoaders.add(e),this._logOperation("hide",{id:e,type:"specific"})),o}},{key:"_hideSpecificLoader",value:function(e){var t;if(this.recentlyRemovedLoaders.has(e))return a.log("LoaderManager: Loader was recently removed (in _hideSpecificLoader)",{loaderId:e},3),!0;var n=this.activeLoaders.get(e);return n?(n.isMainLoader&&(this.isMainLoaderActive=!1,this.mainLoaderId=null),null!==(t=n.element)&&void 0!==t&&t.parentNode?(this._removeLoaderElement(n.element),this.activeLoaders.delete(e),this.recentlyRemovedLoaders.add(e),!0):(this.activeLoaders.delete(e),a.log("LoaderManager: Loader element was already removed from DOM",{loaderId:e},3),!0)):(a.log("LoaderManager: No loader found to hide",{loaderId:e},2),!1)}},{key:"_removeLoaderElement",value:function(e){e.classList.remove("vdm-loader--showing"),setTimeout((function(){e.parentNode&&e.parentNode.removeChild(e)}),300)}},{key:"showLoaderInContainer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.showLoader(t,Et({target:e,container:!0,small:!0},n));return this._logOperation("show",{id:r,message:t,type:"container"}),r}},{key:"updateLoaderMessage",value:function(e,t){var n;if(e&&this.recentlyRemovedLoaders.has(e))return!0;!e&&this.isMainLoaderActive&&this.mainLoaderId&&(e=this.mainLoaderId,a.log("LoaderManager: Using main loader ID for message update",{mainLoaderId:e},3));var r=this.activeLoaders.get(e);if(!r)return this.verboseLogging&&a.log("LoaderManager: No loader found to update message",{loaderId:e},2),!1;if(null===(n=r.element)||void 0===n||!n.parentNode)return a.log("LoaderManager: Loader element was removed from DOM",{loaderId:e},3),this.activeLoaders.delete(e),this.recentlyRemovedLoaders.add(e),!1;var o=r.element.querySelector(".vdm-loader__message");if(o)return o.textContent=t,this._logOperation("update",{id:e,message:t,type:"existing-element"}),!0;if(t){var i=document.createElement("div");return i.className="vdm-loader__message",i.textContent=t,r.element.appendChild(i),this._logOperation("update",{id:e,message:t,type:"new-element"}),!0}return!1}},{key:"hasLoader",value:function(e){return this.activeLoaders.has(e)&&!this.recentlyRemovedLoaders.has(e)}},{key:"_cleanupOldRemovedLoaders",value:function(){this.recentlyRemovedLoaders.size>20&&this.recentlyRemovedLoaders.clear()}},{key:"getLoaderInfo",value:function(e){var t;if(!e)return null;var n=this.activeLoaders.get(e);return n?{exists:!0,isMain:!!n.isMainLoader,fullscreen:!!n.fullscreen,message:null===(t=n.element.querySelector(".vdm-loader__message"))||void 0===t?void 0:t.textContent,age:Date.now()-(n.timestamp||0),inDom:!!n.element.parentNode}:{exists:!1,wasRemoved:this.recentlyRemovedLoaders.has(e)}}},{key:"getLoaderStatus",value:function(){return this._cleanupOldRemovedLoaders(),{activeCount:this.activeLoaders.size,recentlyRemovedCount:this.recentlyRemovedLoaders.size,mainLoaderActive:this.isMainLoaderActive,mainLoaderId:this.mainLoaderId,operations:pt(this.operationLog),loaders:Array.from(this.activeLoaders.entries()).map((function(e){var t,n=vt(e,2),r=n[0],o=n[1];return{id:r,isMain:!!o.isMainLoader,fullscreen:!!o.fullscreen,message:null===(t=o.element.querySelector(".vdm-loader__message"))||void 0===t?void 0:t.textContent,age:Date.now()-(o.timestamp||0),inDom:!!o.element.parentNode}}))}}}],o=[{key:"getInstance",value:function(){return Ot||(Ot=new t).initialize(),Ot}}],r&&It(n.prototype,r),o&&It(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o}(u);function _t(e){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_t(e)}function jt(){jt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new N(r||[]);return o(a,"_invoke",{value:S(e,n,l)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",p={};function v(){}function y(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,T=E&&E(E(_([])));T&&T!==n&&r.call(T,a)&&(w=T);var I=b.prototype=v.prototype=Object.create(w);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,i,a,l){var c=f(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==_t(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,n,r){var o=d;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=k(l,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=f(t,n,r);if("normal"===s.type){if(o=r.done?m:h,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(_t(t)+" is not iterable")}return y.prototype=b,o(I,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},C(L.prototype),s(L.prototype,l,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new L(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(I),s(I,c,"Generator"),s(I,a,(function(){return this})),s(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}function xt(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function At(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){xt(i,r,o,a,l,"next",e)}function l(e){xt(i,r,o,a,l,"throw",e)}a(void 0)}))}}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pt(r.key),r)}}function Pt(e){var t=function(e,t){if("object"!=_t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_t(t)?t:t+""}var Rt=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diffViewer=t,this.highlightJsLoaded=!1,this.resourceLoader=T.getInstance(),this.themeManager=Je.getInstance(),this.language="plaintext";var n=this.themeManager.getCurrentTheme();this.theme=n.mode||"light",a.log("SyntaxHighlighter: Initialized",null,2)},t=[{key:"initialize",value:(i=At(jt().mark((function e(){var t;return jt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadHighlightJs();case 2:if(!this.highlightJsLoaded){e.next=9;break}return t=this.diffViewer.getRuntimeProps().filepath||"",e.next=6,this.setLanguage(t);case 6:a.log("SyntaxHighlighter: Initialized with language:",this.language,2),e.next=10;break;case 9:a.warn("SyntaxHighlighter: Initialization incomplete - highlight.js failed to load",null,2);case 10:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"loadHighlightJs",value:(o=At(jt().mark((function e(){return jt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.log("SyntaxHighlighter: Loading highlight.js core",null,2),e.next=4,this.diffViewer.resourceLoader.loadSyntaxHighlighterCore();case 4:return this.highlightJsLoaded=!0,a.log("SyntaxHighlighter: highlight.js loaded successfully",null,2),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(0),a.error("SyntaxHighlighter: Failed to load highlight.js:",e.t0,2),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return o.apply(this,arguments)})},{key:"highlightAll",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(this.highlightJsLoaded&&window.hljs){var n=ce.getElements("".concat(k.DIFF.LINE_CONTENT,":not(").concat(k.DIFF.LINE_CONTENT_EMPTY,"):not(").concat(k.DIFF.LINE_PLACEHOLDER,")"),t);if(n){var r=Array.from(n).filter((function(e){return e.textContent.trim()}));a.log("SyntaxHighlighter: Found ".concat(r.length," code elements to highlight"),null,2);var o=null;if(r.length>100){var i=H.getInstance(),l=Nt.getInstance(),c=i.get("applyingSyntaxHighlighting","Applying syntax highlighting...");o=l.showLoader(c,{fullscreen:!0,zIndex:1e3}),a.log("SyntaxHighlighter: Showing loader for large file highlighting",null,2)}var s=0,u=performance.now(),f=function(){if(s>=r.length)if(o){Nt.getInstance().hideLoader(o);var t=performance.now()-u;a.log("SyntaxHighlighter: Highlighting complete for ".concat(r.length," elements in ").concat(t.toFixed(2),"ms"),null,2)}else a.log("SyntaxHighlighter: Highlighting complete",null,2);else{for(var n=Math.min(s+30,r.length),i=s;i<n;i++)e.highlightElement(r[i]);if(o&&s%150==0){var l=Nt.getInstance(),c=H.getInstance(),d=Math.round(s/r.length*100),h=c.get("applyingSyntaxHighlightingProgress","Applying syntax highlighting ({0}%)").replace("{0}",d);l.updateLoaderMessage(o,h)}s=n,requestAnimationFrame((function(){setTimeout(f,0)}))}};f()}else a.log("SyntaxHighlighter: No code elements found to highlight",null,2)}else a.warn("SyntaxHighlighter: Cannot highlight code - highlight.js not loaded",null,2)}},{key:"highlightElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.highlightJsLoaded&&window.hljs&&e)try{e.classList.contains(this.language)||(e.className.split(" ").filter((function(e){return e.startsWith("language-")})).forEach((function(t){e.classList.remove(t)})),e.classList.add(this.language)),ht.resetHighlighting(e),window.hljs.highlightElement(e),t&&window.hljs.lineNumbersBlock&&window.hljs.lineNumbersBlock(e)}catch(e){a.error("SyntaxHighlighter: Error highlighting element:",e,2)}}},{key:"setLanguage",value:(r=At(jt().mark((function e(t){var n,r,o,i,l,c,s,u,f;return jt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.diffViewer.getRuntimeProps(),o="plaintext",i="default",t&&"string"==typeof t&&t.includes(".")&&(l=t.split(".").pop().toLowerCase())&&(o=gt[l]||l,i="filepath",a.log("SyntaxHighlighter: Language determined from filepath extension: ".concat(l),null,2)),"plaintext"===o&&"default"===i&&null!==(n=r.diffData)&&void 0!==n&&n.language&&(o=r.diffData.language,i="diffData",a.log("SyntaxHighlighter: Language determined from diffData: ".concat(o),null,2)),"plaintext"===o&&"default"===i&&a.log("SyntaxHighlighter: No language could be determined, using plaintext as fallback",null,2),this.language===o){e.next=31;break}if(this.language=o,a.log("SyntaxHighlighter: Setting language to ".concat(o," (source: ").concat(i,")"),null,2),!this.highlightJsLoaded||this.resourceLoader.loadedLanguages.has(o)){e.next=27;break}return a.log("SyntaxHighlighter: Loading language ".concat(o),null,2),c=H.getInstance(),s=Nt.getInstance(),u=c.get("loadingLanguage","Loading language: {0}").replace("{0}",o),(f=this.diffViewer.mainLoaderId)||a.warn("SyntaxHighlighter: No main loader ID available from DiffViewer for language loading",null,2),e.prev=16,f&&s.updateLoaderMessage(f,u),e.next=20,this.resourceLoader.loadLanguage(o);case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(16),a.error("SyntaxHighlighter: Error loading language ".concat(o,":"),e.t0,2);case 25:e.next=28;break;case 27:a.log("SyntaxHighlighter: Language ".concat(o," already loaded"),null,3);case 28:a.log("SyntaxHighlighter: Language set to ".concat(this.language),null,2),e.next=32;break;case 31:a.log("SyntaxHighlighter: Language already set to ".concat(this.language),null,3);case 32:case"end":return e.stop()}}),e,this,[[16,22]])}))),function(e){return r.apply(this,arguments)})}],t&&Dt(e.prototype,t),n&&Dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i}();function Ut(e){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ut(e)}function Ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e,t,n){return(t=Vt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ht(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vt(r.key),r)}}function Vt(e){var t=function(e,t){if("object"!=Ut(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ut(t)?t:t+""}var Gt={},zt={},Yt={},Wt=null,qt={elementCacheHits:0,elementCacheMisses:0,iconMarkerCacheHits:0,iconMarkerCacheMisses:0,rowCacheHits:0,rowCacheMisses:0},Kt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,r=[{key:"clearCache",value:function(){Object.keys(Gt).forEach((function(e){return delete Gt[e]})),Object.keys(zt).forEach((function(e){return delete zt[e]})),Object.keys(Yt).forEach((function(e){return delete Yt[e]})),Wt=null,a.log("ChunkUtils: Cache cleared",null,2)}},{key:"getCacheStats",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(n),!0).forEach((function(t){Bt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},qt)}},{key:"preloadChunks",value:function(){var t=performance.now();e.clearCache(),Wt={byId:{},byLineId:{},allChunkIds:new Set};var n=document.querySelectorAll("".concat(k.DIFF.CHUNK,"[data-chunk-id]"));a.log("ChunkUtils: Preloading ".concat(n.length," chunk elements"),null,2),n.forEach((function(e){var t=e.getAttribute("data-chunk-id"),n=e.getAttribute("data-side"),r=e.getAttribute("data-line-id");if(t){if(Wt.allChunkIds.add(t),Wt.byId[t]||(Wt.byId[t]={elements:{all:[],left:[],right:[]},lineIds:new Set}),Wt.byId[t].elements.all.push(e),"left"===n?Wt.byId[t].elements.left.push(e):"right"===n&&Wt.byId[t].elements.right.push(e),r){Wt.byId[t].lineIds.add(r),Wt.byLineId[r]={chunkId:t,element:e};var o=e.closest("tr");o&&(Yt[e.dataset.lineId]=o)}var i="".concat(t,":both");if(Gt[i]||(Gt[i]=[]),Gt[i].push(e),n){var a="".concat(t,":").concat(n);Gt[a]||(Gt[a]=[]),Gt[a].push(e)}}}));var r=document.querySelectorAll("".concat(k.ICONS.MARKER,"[data-line-id]"));a.log("ChunkUtils: Preloading ".concat(r.length," icon markers"),null,2),r.forEach((function(e){var t=e.getAttribute("data-line-id");if(t&&(zt[t]=e,Wt.byLineId[t])){var n=Wt.byLineId[t].chunkId;Wt.byId[n].iconMarkers||(Wt.byId[n].iconMarkers=[]),Wt.byId[n].iconMarkers.push(e)}}));var o=performance.now()-t;return a.log("ChunkUtils: Preloaded ".concat(Object.keys(Wt.byId).length," chunks in ").concat(o.toFixed(2),"ms"),null,2),Wt}},{key:"getAllChunkIds",value:function(){return Wt||e.preloadChunks(),Array.from(Wt.allChunkIds)}},{key:"sortElementsByLineNumber",value:function(e){return Array.from(e).sort((function(e,t){var n,r;return parseInt((null===(n=e.dataset.lineId)||void 0===n?void 0:n.split("-").pop())||"0",10)-parseInt((null===(r=t.dataset.lineId)||void 0===r?void 0:r.split("-").pop())||"0",10)}))}},{key:"getChunkElements",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return[];var n,r,o="".concat(e,":").concat(t||"both");return Gt[o]?(qt.elementCacheHits++,Gt[o]):(qt.elementCacheMisses++,Wt&&Wt.byId[e]?(n="left"===t?Wt.byId[e].elements.left:"right"===t?Wt.byId[e].elements.right:Wt.byId[e].elements.all,Gt[o]=n,n):(r=t?Array.from(document.querySelectorAll("".concat(k.DIFF.CHUNK,'[data-chunk-id="').concat(e,'"][data-side="').concat(t,'"]'))):Array.from(document.querySelectorAll("".concat(k.DIFF.CHUNK,'[data-chunk-id="').concat(e,'"]'))),Gt[o]=r,r))}},{key:"getChunkIconMarkers",value:function(t){if(!t)return[];if(Wt&&Wt.byId[t])return Wt.byId[t].iconMarkers||[];var n=e.getChunkElements(t),r=[];return n.forEach((function(t){var n=t.dataset.lineId;if(n){var o=e.getIconMarker(n);o&&r.push(o)}})),r}},{key:"getIconMarker",value:function(e){if(!e)return null;if(zt[e])return qt.iconMarkerCacheHits++,zt[e];if(qt.iconMarkerCacheMisses++,Wt&&Wt.byLineId[e]){var t=Wt.byLineId[e].chunkId;if(Wt.byId[t].iconMarkers){var n=Wt.byId[t].iconMarkers.find((function(t){return t.getAttribute("data-line-id")===e}));if(n)return zt[e]=n,n}}var r=document.querySelector("".concat(k.ICONS.MARKER,'[data-line-id="').concat(e,'"]'));return r&&(zt[e]=r),r}},{key:"getParentRow",value:function(e){if(!e)return null;var t=e.dataset.lineId;if(t&&Yt[t])return qt.rowCacheHits++,Yt[t];qt.rowCacheMisses++;var n=e.closest("tr");return t&&n&&(Yt[t]=n),n}},{key:"generateFileContent",value:function(e){return e.filter((function(e){return"content"===e.type})).map((function(e){return e.line})).join("\n")}}],(n=null)&&Ht(t.prototype,n),r&&Ht(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function Xt(e){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xt(e)}function Jt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return $t(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$t(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Qt(r.key),r)}}function Qt(e){var t=function(e,t){if("object"!=Xt(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Xt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xt(t)?t:t+""}var en=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.chunkManager=t},(t=[{key:"renderChunks",value:function(){a.log("ChunkRenderer: Beginning chunk rendering",null,2);var e=null;if(this.chunkManager.chunks.length>100){var t=H.getInstance(),n=Nt.getInstance(),r=t.get("renderingDiff","Rendering diff...");e=n.showLoader(r,{fullscreen:!0,zIndex:1e3}),a.log("ChunkRenderer: Showing loader for large diff rendering",null,2)}var o=performance.now(),i=this.buildDiffPaneHtml(this.chunkManager.oldContent,"left"),l=this.buildDiffPaneHtml(this.chunkManager.newContent,"right");if(this.chunkManager.diffViewer.container.innerHTML='\n            <div class="'.concat(k.DIFF.PANES_CONTAINER.name(),'">\n                <div class="').concat(k.DIFF.PANE.name(),'" id="').concat(k.DIFF.PANE_LEFT.name(),'" data-side="left">\n                    ').concat(i,'\n                </div>\n                <div class="').concat(k.DIFF.PANE.name(),'" id="').concat(k.DIFF.PANE_RIGHT.name(),'" data-side="right">\n                    ').concat(l,"\n                </div>\n            </div>\n        "),e){Nt.getInstance().hideLoader(e);var c=performance.now()-o;a.log("ChunkRenderer: Rendered ".concat(this.chunkManager.chunks.length," chunks in ").concat(c.toFixed(2),"ms"),null,2)}else a.log("ChunkRenderer: Rendered ".concat(this.chunkManager.chunks.length," chunks successfully"),null,2)}},{key:"buildDiffPaneHtml",value:function(e,t){var n,r=new Set,o=Jt(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;"placeholder"===i.type&&i.chunkId&&r.add(i.chunkId)}}catch(e){o.e(e)}finally{o.f()}var a='<div class="'.concat(k.DIFF.PANE_CONTENT.name(),' hljs">');a+='<div class="'.concat(k.DIFF.TABLE_WRAPPER.name(),'">'),a+='<table class="'.concat(k.CODE.TABLE.name(),'"><tbody>');var l,c=0,s=Jt(e);try{for(s.s();!(l=s.n()).done;){var u=l.value;a+=this._renderDiffLine(u,t,++c,r)}}catch(e){s.e(e)}finally{s.f()}return a+="</tbody></table>",a+="</div>",a+="</div>"}},{key:"_renderDiffLine",value:function(e,t,n,r){var o="<tr>",i=void 0!==e.chunkId?e.chunkId:"",a="";if(""!==i){var l=this.chunkManager.chunks.find((function(e){return e.id===i}));a=l?l.type:""}o+='<td class="'.concat(k.CODE.LINE_NUMBER.name(),'">').concat(n,"</td>");var c=""!==i&&r.has(i);return"placeholder"===e.type?o+=this._renderPlaceholderLine(e,i,a,t,n):o+=this._renderContentLine(e,i,a,t,n,c),o+="</tr>"}},{key:"_renderPlaceholderLine",value:function(e,t,n,r,o){var i="";return""!==t&&(i+=" ".concat(k.DIFF.CHUNK.name()),(e.conflict||"replace"===n||"add"===n||"delete"===n)&&(i+=" ".concat(k.STATUS.UNRESOLVED.name()))),'<td class="'.concat(k.CODE.LINE_CONTENT.name()," ").concat(k.DIFF.LINE_CONTENT_EMPTY.name()," ").concat(k.DIFF.LINE_PLACEHOLDER.name()).concat(i,'"\n                   data-chunk-id="').concat(t,'"\n                   data-chunk-type="').concat(n,'"\n                   data-side="').concat(r,'"\n                   data-placeholder-type="').concat(e.placeholderType||"default",'"\n                   data-line-id="').concat(r,"-").concat(o,'"\n                   data-has-placeholder="true">&nbsp;</td>')}},{key:"_renderContentLine",value:function(e,t,n,r,o,i){var a=e.line,l=!a||"\r"===a||"\n"===a,c="";if(""!==t&&(c=this._getChunkClass(n,r),c+=" ".concat(k.DIFF.CHUNK.name()),(e.conflict||"replace"===n||"add"===n||"delete"===n)&&(c+=" ".concat(k.STATUS.UNRESOLVED.name()))),l)return c+=" ".concat(k.CODE.LINE_EMPTY.name()),'<td class="'.concat(k.CODE.LINE_CONTENT.name()).concat(c,'"\n                       data-chunk-id="').concat(t,'"\n                       data-chunk-type="').concat(n,'"\n                       data-side="').concat(r,'"\n                       data-line-id="').concat(r,"-").concat(o,'"\n                       ').concat(i?'data-has-placeholder="true"':"",">&nbsp;</td>");var s=st.escapeHtml?st.escapeHtml(a):a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),u=""!==t?' style="cursor: pointer;"':"";return'<td class="'.concat(k.CODE.LINE_CONTENT.name()).concat(c,'"\n                       data-chunk-id="').concat(t,'"\n                       data-chunk-type="').concat(n,'"\n                       data-side="').concat(r,'"\n                       data-line-id="').concat(r,"-").concat(o,'"\n                       ').concat(i?'data-has-placeholder="true"':"").concat(u,">").concat(s,"</td>")}},{key:"_getChunkClass",value:function(e,t){if("delete"===e&&"left"===t)return" ".concat(k.DIFF.LINE_DELETE.name());if("add"===e&&"right"===t)return" ".concat(k.DIFF.LINE_ADD.name());if("replace"===e){var n=" ".concat(k.DIFF.LINE_ADD.name());return n+=" ".concat("left"===t?k.DIFF.LINE_REPLACE_LEFT.name():k.DIFF.LINE_REPLACE_RIGHT.name())}return""}}])&&Zt(e.prototype,t),n&&Zt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function tn(e){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tn(e)}function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e,t,n){return(t=un(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function on(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||ln(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function an(e){return function(e){if(Array.isArray(e))return cn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ln(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ln(e,t){if(e){if("string"==typeof e)return cn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cn(e,t):void 0}}function cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,un(r.key),r)}}function un(e){var t=function(e,t){if("object"!=tn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=tn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tn(t)?t:t+""}var fn=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.chunkManager=t,this._pendingOperations=[],this._isBatching=!1,this._metrics={lastBatchSize:0,lastBatchTime:0},a.log("ChunkVisualStateManager: Initialized",null,3)},t=[{key:"initialize",value:function(){Kt.preloadChunks(),a.log("ChunkVisualStateManager: Initialized with preloaded chunks",null,2)}},{key:"updateVisualState",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a.log("ChunkVisualStateManager: Updating visual state for chunk ".concat(e,", side ").concat(t,", state ").concat(n),null,3);var o=Kt.getChunkElements(e,t);a.log("ChunkVisualStateManager: Found ".concat(o.length," elements for chunk ").concat(e),null,3);var i=Kt.sortElementsByLineNumber(o),l="left"===t?"right":"left";if(r)this._pendingOperations.push({type:"updateState",chunkId:e,side:t,elements:o,firstElement:i.length>0?i[0]:null,state:n,oppositeSide:l});else{if(this._applyStateToElements(o,n),i.length>0){a.log("ChunkVisualStateManager: Updating icon marker for first element of chunk ".concat(e),null,3);var c=i[0];c&&"selected"===n?(this._updateIconMarker(c,n),this._updateOppositeMarker(c,l)):this._updateIconMarker(c,n)}else a.warn("ChunkVisualStateManager: No elements found to update icon for chunk ".concat(e),null,3);this._notifySelectionChange()}}},{key:"_updateOppositeMarker",value:function(e,t){var n;if(null!=e&&null!==(n=e.dataset)&&void 0!==n&&n.lineId){var r=e.dataset.lineId.split("-");if(2===r.length){var o=r[1],i="".concat(t,"-").concat(o),l=Kt.getIconMarker(i);l?(a.log("ChunkVisualStateManager: Updating opposite marker ".concat(i),{currentClasses:Array.from(l.classList)},3),l.classList.remove(k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name(),k.ICONS.SELECT.name(),k.ICONS.SELECT_LEFT.name(),k.ICONS.SELECT_RIGHT.name()),l.classList.contains(k.ICONS.MARKER_PLACEHOLDER.name())?(l.classList.add(k.ICONS.MARKER_PLACEHOLDER.name()),a.log("ChunkVisualStateManager: Preserved placeholder status for ".concat(i),null,3)):(l.classList.add(k.DIFF.CHUNK_UNSELECTED.name()),a.log("ChunkVisualStateManager: Set opposite marker ".concat(i," as unselected"),null,3))):a.warn("ChunkVisualStateManager: Could not find opposite marker for ".concat(i),null,3)}}}},{key:"resetVisualState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.log("ChunkVisualStateManager: Resetting visual state for chunk ".concat(e),null,3);var n=Kt.getChunkElements(e);a.log("ChunkVisualStateManager: Found ".concat(n.length," elements for chunk ").concat(e),null,3);var r=Kt.getChunkIconMarkers(e);t?this._pendingOperations.push({type:"resetState",chunkId:e,elements:n,iconMarkers:r}):(this._applyResetToElements(n,r),a.log("ChunkVisualStateManager: Reset ".concat(r.length," icon markers for chunk ").concat(e),null,3),this._notifySelectionChange())}},{key:"applyBatch",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0!==this._pendingOperations.length){this._isBatching=!0;var n=this._pendingOperations.length;this._metrics.lastBatchSize=n,requestAnimationFrame((function(){var r=performance.now();a.log("ChunkVisualStateManager: Applying batch of ".concat(n," operations"),null,2);try{var o=[],i=[];e._pendingOperations.forEach((function(e){"updateState"===e.type?o.push(e):"resetState"===e.type&&i.push(e)})),i.length>0&&e._processBatchedResets(i),o.length>0&&e._processBatchedUpdates(o);var l=performance.now()-r;e._metrics.lastBatchTime=l,a.log("ChunkVisualStateManager: Batch processing completed in ".concat(l.toFixed(2),"ms"),{operations:n,resetOps:i.length,updateOps:o.length,msPerOperation:(l/n).toFixed(2)},2)}catch(e){a.error("Error during batch processing: ".concat(e.message),e,1)}finally{e._pendingOperations=[],e._isBatching=!1,t&&e._notifySelectionChange()}}))}}},{key:"_processBatchedResets",value:function(e){if(0!==e.length){var t=[],n=[];e.forEach((function(e){e.elements&&t.push.apply(t,an(e.elements)),e.iconMarkers&&n.push.apply(n,an(e.iconMarkers))})),this._applyResetToElements(t,n)}}},{key:"_processBatchedUpdates",value:function(e){var t=this;if(0!==e.length){var n={selected:[],unselected:[]},r={selected:{},unselected:{}};e.forEach((function(e){var t,o=e.elements,i=e.firstElement,a=e.state,l=e.chunkId,c=e.side,s=e.oppositeSide;o&&o.length>0&&("selected"!==a&&"unselected"!==a||(t=n[a]).push.apply(t,an(o))),i&&l&&("selected"!==a&&"unselected"!==a||(r[a][l]={element:i,side:c,oppositeSide:s}))})),Object.entries(n).forEach((function(e){var n=on(e,2),r=n[0],o=n[1];o.length>0&&t._applyStateToElements(o,r)})),Object.entries(r).forEach((function(e){var n=on(e,2),r=n[0],o=n[1];Object.entries(o).forEach((function(e){var n=on(e,2),o=(n[0],n[1]);t._updateIconMarker(o.element,r),"selected"===r&&o.oppositeSide&&t._updateOppositeMarker(o.element,o.oppositeSide)}))})),document.body&&document.body.getBoundingClientRect()}}},{key:"_applyStateToElements",value:function(e,t){if(e&&0!==e.length){var n=[k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name()],r="";r="selected"===t?k.DIFF.CHUNK_SELECTED.name():"unselected"===t?k.DIFF.CHUNK_UNSELECTED.name():t;var o=new Set;e.forEach((function(e){var t;(t=e.classList).remove.apply(t,n),e.classList.add(r),e.classList.contains(k.DIFF.LINE_PLACEHOLDER.name())&&e.classList.add(k.DIFF.PLACEHOLDER.name());var i=Kt.getParentRow(e);i&&o.add(i)})),o.forEach((function(e){var t;(t=e.classList).remove.apply(t,n),e.classList.add(r)}))}}},{key:"_applyResetToElements",value:function(e,t){if(e&&0!==e.length||t&&0!==t.length){var n=[k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name()],r=[k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name(),k.ICONS.SELECT.name(),k.ICONS.SELECT_LEFT.name(),k.ICONS.SELECT_RIGHT.name()],o=new Set;e&&e.length>0&&(e.forEach((function(e){var t;if(e){(t=e.classList).remove.apply(t,n);var r=Kt.getParentRow(e);r&&o.add(r)}})),o.forEach((function(e){var t;(t=e.classList).remove.apply(t,n)}))),t&&t.length>0&&t.forEach((function(e){if(e){var t,n=e.classList.contains(k.ICONS.MARKER_PLACEHOLDER.name());(t=e.classList).remove.apply(t,r),n&&e.classList.add(k.ICONS.MARKER_PLACEHOLDER.name())}}))}}},{key:"_updateIconMarker",value:function(e,t){if(e){var n=e.dataset.lineId;if(n){a.log("ChunkVisualStateManager: Looking for icon marker with lineId ".concat(n),null,3);var r=Kt.getIconMarker(n);if(r){a.log("ChunkVisualStateManager: Updating icon marker state to ".concat(t),{lineId:n,currentClasses:Array.from(r.classList)},3);var o=r.classList.contains(k.ICONS.MARKER_PLACEHOLDER.name());r.classList.remove(k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name(),k.ICONS.SELECT.name(),k.ICONS.SELECT_LEFT.name(),k.ICONS.SELECT_RIGHT.name()),"selected"===t?(r.classList.add(k.DIFF.CHUNK_SELECTED.name()),"left"===e.dataset.side?r.classList.add(k.ICONS.SELECT_LEFT.name()):r.classList.add(k.ICONS.SELECT_RIGHT.name())):"unselected"===t?r.classList.add(k.DIFF.CHUNK_UNSELECTED.name()):r.classList.add(t),o&&!r.classList.contains(k.ICONS.MARKER_PLACEHOLDER.name())&&(r.classList.add(k.ICONS.MARKER_PLACEHOLDER.name()),a.log("ChunkVisualStateManager: Preserved placeholder marker status",null,3))}else a.warn("ChunkVisualStateManager: No icon marker found for line ".concat(n),null,3)}}}},{key:"_notifySelectionChange",value:function(){a.log("ChunkVisualStateManager: Notifying about selection change",null,3),"function"==typeof this.chunkManager.onSelectionChange?this.chunkManager.onSelectionChange():a.log("ChunkVisualStateManager: No onSelectionChange handler defined",null,3)}},{key:"getMetrics",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){rn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this._metrics)}}],t&&sn(e.prototype,t),n&&sn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function dn(e){return dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(e)}function hn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gn(e,t,n){return(t=pn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pn(r.key),r)}}function pn(e){var t=function(e,t){if("object"!=dn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=dn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dn(t)?t:t+""}var vn=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.chunkManager=t,this.selections={},this.visualStateManager=new fn(t),this.SELECTED=k.DIFF.CHUNK_SELECTED.name(),this.UNSELECTED=k.DIFF.CHUNK_UNSELECTED.name(),this._performanceMetrics={lastOperationTime:0,operationCount:0}},t=[{key:"setupChunkSelection",value:function(){var e=this;this._boundClickHandler=function(t){return e._handleClick(t)},this._boundCheckAllHandler=function(t){return e._handleCheckAll(t)},ce.setupEventHandlers('[data-chunk-id]:not([data-chunk-id=""])',"click",this._boundClickHandler,{removeExisting:!0,styles:{cursor:"pointer"}}),this._setupCheckAllButtons(),Kt.clearCache(),a.log("ChunkSelectionHandler: Selection handlers initialized for all chunk elements",null,2)}},{key:"_setupCheckAllButtons",value:function(){var e=this.chunkManager.diffViewer.container.querySelectorAll(k.DIFF.PANE);if(2===e.length){var t=e[0],n=e[1];this._createCheckAllButtonHeader(t,"left"),this._createCheckAllButtonHeader(n,"right")}else a.log('ChunkSelectionHandler: Could not find both diff panes for "Check All" buttons',null,2)}},{key:"_createCheckAllButtonHeader",value:function(e,t){var n=H.getInstance(),r=document.createElement("div");r.className=k.DIFF.PANE_HEADER.name(),r.classList.add("vdm-d-flex","vdm-justify-content-between","vdm-align-items-center");var o=this.chunkManager.diffViewer.runtimeProps.diffData.language||"Text",i=document.createElement("span");i.className="vdm-badge vdm-badge--info",i.textContent=o;var a=document.createElement("button");a.className="".concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_EXTRA_SMALL.name()," ").concat(k.UTILITY.BUTTON_SECONDARY.name()," ").concat(k.DIFF.CHECK_ALL_BTN.name()),a.setAttribute("data-side",t),a.setAttribute("data-icon-state","unchecked"),a.title="Select all changes from the ".concat(t," pane"),a.style.display="inline-flex",a.style.alignItems="center",a.style.verticalAlign="middle";var l=document.createElement("span");l.className="vdm-icon-wrapper",l.style.marginRight="3px",l.style.display="inline-flex",l.style.alignItems="center",l.style.verticalAlign="middle",l.style.height="14px",l.style.lineHeight="1";var c=_.createIcon("checkbox-unchecked",{width:14,height:14,classes:"vdm-icon-checkbox"});l.appendChild(c);var s=document.createElement("span");s.style.display="inline-block",s.style.verticalAlign="middle",s.style.lineHeight="1",s.appendChild(document.createTextNode(n.get("checkAll"))),a.appendChild(l),a.appendChild(s),r.appendChild(i),r.appendChild(a),e.insertBefore(r,e.firstChild),a.addEventListener("click",this._boundCheckAllHandler)}},{key:"_handleCheckAll",value:function(e){var t=this,n=e.currentTarget,r=n.getAttribute("data-side"),o=n.getAttribute("data-icon-state"),i=this._getOppositeButton(r),l=H.getInstance(),c=Nt.getInstance();if(r){var s=l.get("processingChunks")||"Processing chunks...",u=c.showLoader(s,{fullscreen:!0,zIndex:9999});this._setButtonProcessingState(n,!0);var f=performance.now();setTimeout((function(){"checked"===o?(a.log("ChunkSelectionHandler: Unchecking all selections",null,2),t._toggleButtonIconState(n,"checked"),i&&"checked"===i.getAttribute("data-icon-state")&&t._toggleButtonIconState(i,"checked"),t.clearAllSelections(!0)):i&&"checked"===i.getAttribute("data-icon-state")?(t._toggleButtonIconState(i,"checked"),t._toggleButtonIconState(n,"unchecked"),t.selectAllOnSide(r,!0)):(t._toggleButtonIconState(n,"unchecked"),t.selectAllOnSide(r,!0)),t._setButtonProcessingState(n,!1),c.hideLoader(u),t._recordPerformanceMetrics(f)}),50)}}},{key:"_setButtonProcessingState",value:function(e,t){t?(e.classList.add("processing"),e.style.opacity="0.8",e.style.cursor="wait"):(e.classList.remove("processing"),e.style.opacity="",e.style.cursor="")}},{key:"_recordPerformanceMetrics",value:function(e){var t=performance.now()-e;this._performanceMetrics.lastOperationTime=t,this._performanceMetrics.operationCount++;var n=Kt.getCacheStats(),r=n.elementCacheHits/(n.elementCacheHits+n.elementCacheMisses)*100||0,o=n.iconMarkerCacheHits/(n.iconMarkerCacheHits+n.iconMarkerCacheMisses)*100||0;a.log("ChunkSelectionHandler: Operation completed in ".concat(t.toFixed(2),"ms"),{totalOperations:this._performanceMetrics.operationCount,cacheStats:{elementCacheHits:n.elementCacheHits,elementCacheMisses:n.elementCacheMisses,elementHitRatio:"".concat(r.toFixed(1),"%"),iconMarkerCacheHits:n.iconMarkerCacheHits,iconMarkerCacheMisses:n.iconMarkerCacheMisses,iconHitRatio:"".concat(o.toFixed(1),"%")}},2)}},{key:"_getOppositeButton",value:function(e){var t="left"===e?"right":"left";return this.chunkManager.diffViewer.container.querySelector(".".concat(k.DIFF.CHECK_ALL_BTN.name(),'[data-side="').concat(t,'"]'))}},{key:"_toggleButtonIconState",value:function(e,t){var n,r=e.querySelector(".vdm-icon-wrapper");r&&(r.innerHTML="","unchecked"===t?(n="checked",r.appendChild(_.createIcon("checkbox-checked",{width:14,height:14,classes:"vdm-icon-checkbox"}))):(n="unchecked",r.appendChild(_.createIcon("checkbox-unchecked",{width:14,height:14,classes:"vdm-icon-checkbox"}))),e.setAttribute("data-icon-state",n))}},{key:"selectAllOnSide",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="left"===e?"right":"left";a.log("ChunkSelectionHandler: Selecting all chunks on ".concat(e," side").concat(n?" (batched)":""),null,2);var o=this.chunkManager.chunks.filter((function(e){return e.conflict||"replace"===e.type||"add"===e.type||"delete"===e.type})),i=o.length>20,l=null;if((n=n||i)&&o.length>50){var c=H.getInstance(),s=Nt.getInstance(),u=c.get("processingChunks")||"Processing chunks...";l=s.showLoader(u,{fullscreen:!0,zIndex:9999})}var f=performance.now();if(n){o.forEach((function(n){t.selections[n.id]=e,t._syncWithDiffConfig(n.id,e)}));var d=new Map;o.forEach((function(n){if(t.visualStateManager.updateVisualState(n.id,e,t.SELECTED,!0),t.visualStateManager.updateVisualState(n.id,r,t.UNSELECTED,!0),!d.has(n.id)){var o=Kt.getChunkElements(n.id);d.set(n.id,o)}})),this.visualStateManager.applyBatch(!1),requestAnimationFrame((function(){t._refreshIconStates(e,o),d.forEach((function(e){e.forEach((function(e){e.classList.add(k.STATUS.RESOLVED.name()),e.classList.remove(k.STATUS.UNRESOLVED.name())}))})),t._updateNavigationCounter(),"function"==typeof t.chunkManager.onSelectionChange&&t.chunkManager.onSelectionChange(),l&&Nt.getInstance().hideLoader(l),t._recordPerformanceMetrics(f)}))}else o.forEach((function(n){t.toggleChunkSelection(n.id,e,t.SELECTED),t.toggleChunkSelection(n.id,r,t.UNSELECTED)})),"function"==typeof this.chunkManager.onSelectionChange&&this.chunkManager.onSelectionChange(),this._recordPerformanceMetrics(f)}},{key:"_refreshIconStates",value:function(e,t){var n="left"===e?"right":"left";t.forEach((function(t){var r=Kt.getChunkElements(t.id,e),o=Kt.getChunkElements(t.id,n);if(r.length>0){var i=Kt.sortElementsByLineNumber(r)[0];if(i){var l=i.dataset.lineId;if(l){var c=Kt.getIconMarker(l);c&&(c.classList.remove(k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name(),k.ICONS.SELECT.name(),k.ICONS.SELECT_LEFT.name(),k.ICONS.SELECT_RIGHT.name()),c.classList.add(k.DIFF.CHUNK_SELECTED.name()),"left"===e?c.classList.add(k.ICONS.SELECT_LEFT.name()):c.classList.add(k.ICONS.SELECT_RIGHT.name()))}}r.forEach((function(e){e.classList.remove(k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name()),e.classList.add(k.DIFF.CHUNK_SELECTED.name());var t=Kt.getParentRow(e);t&&(t.classList.remove(k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name()),t.classList.add(k.DIFF.CHUNK_SELECTED.name()))}))}if(o.length>0){var s=Kt.sortElementsByLineNumber(o)[0];if(s){var u=s.dataset.lineId;if(u){var f=Kt.getIconMarker(u);if(f){f.classList.remove(k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name(),k.ICONS.SELECT.name(),k.ICONS.SELECT_LEFT.name(),k.ICONS.SELECT_RIGHT.name());var d="true"===s.dataset.hasPlaceholder,h=s.classList.contains(k.DIFF.LINE_PLACEHOLDER.name()),g=f.classList.contains(k.ICONS.MARKER_PLACEHOLDER.name()),m=u.split("-")[1],p="".concat(e,"-").concat(m),v=document.querySelector('[data-line-id="'.concat(p,'"]')),y="true"===(null==v?void 0:v.dataset.hasPlaceholder),b=null==v?void 0:v.classList.contains(k.DIFF.LINE_PLACEHOLDER.name());d||h||g||y||b?(f.classList.add(k.ICONS.MARKER_PLACEHOLDER.name()),a.log("ChunkSelectionHandler: Set opposite marker ".concat(u," as placeholder during batch refresh"),null,3)):f.classList.add(k.DIFF.CHUNK_UNSELECTED.name())}}}o.forEach((function(e){e.classList.remove(k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name()),e.classList.add(k.DIFF.CHUNK_UNSELECTED.name());var t=Kt.getParentRow(e);t&&(t.classList.remove(k.DIFF.CHUNK_SELECTED.name(),k.DIFF.CHUNK_UNSELECTED.name()),t.classList.add(k.DIFF.CHUNK_UNSELECTED.name()))}))}}))}},{key:"_handleClick",value:function(e){var t=e.currentTarget,n=t.getAttribute("data-chunk-id"),r=t.getAttribute("data-side");if(a.log("ChunkSelectionHandler: Click detected on side ".concat(r," for chunk ").concat(n),{element:t.outerHTML.substring(0,100)+"..."},3),n&&r)if(this.selections[n]===r&&t.classList.contains(k.DIFF.CHUNK_SELECTED.name())){var o;a.log("ChunkSelectionHandler: Unselecting chunk ".concat(n," as it was already selected"),null,3),delete this.selections[n],null!==(o=this.chunkManager.diffViewer)&&void 0!==o&&null!==(o=o.diffConfig)&&void 0!==o&&o.chunkSelections&&delete this.chunkManager.diffViewer.diffConfig.chunkSelections[n],this.visualStateManager.resetVisualState(n),Kt.getChunkElements(n).forEach((function(e){e.classList.remove(k.STATUS.RESOLVED.name()),e.classList.add(k.STATUS.UNRESOLVED.name())})),this._updateNavigationCounter(),"function"==typeof this.chunkManager.onSelectionChange&&this.chunkManager.onSelectionChange()}else{var i="left"===r?"right":"left";a.log("ChunkSelectionHandler: Toggling chunk ".concat(n),{selectedSide:r,oppositeSide:i},3),this.toggleChunkSelection(n,r,this.SELECTED),this.toggleChunkSelection(n,i,this.UNSELECTED)}}},{key:"toggleChunkSelection",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n===this.SELECTED&&(this.selections[e]=t,this._syncWithDiffConfig(e,t),this._updateNavigationCounter(),r||Kt.getChunkElements(e).forEach((function(e){e.classList.add(k.STATUS.RESOLVED.name()),e.classList.remove(k.STATUS.UNRESOLVED.name())}))),this.visualStateManager.updateVisualState(e,t,n,r)}},{key:"_syncWithDiffConfig",value:function(e,t){var n;null!==(n=this.chunkManager.diffViewer)&&void 0!==n&&null!==(n=n.diffConfig)&&void 0!==n&&n.chunkSelections&&(this.chunkManager.diffViewer.diffConfig.chunkSelections[e]=t)}},{key:"_updateNavigationCounter",value:function(){var e;null!==(e=this.chunkManager.diffViewer)&&void 0!==e&&e.diffNavigator&&this.chunkManager.diffViewer.diffNavigator.updateCounter()}},{key:"getSelections",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(n),!0).forEach((function(t){gn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.selections)}},{key:"isChunkResolved",value:function(e){return!!this.selections[e]}},{key:"getUnresolvedCount",value:function(){return this.chunkManager.chunks.filter((function(e){return e.conflict})).length-Object.keys(this.selections).length}},{key:"clearAllSelections",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.chunkManager.chunks.filter((function(e){return e.conflict||"replace"===e.type||"add"===e.type||"delete"===e.type})),r=n.length>20,o=null;if((t=t||r)&&n.filter((function(t){return e.isChunkResolved(t.id)})).length>50){var i=H.getInstance(),l=Nt.getInstance(),c=i.get("processingChunks")||"Processing chunks...";o=l.showLoader(c,{fullscreen:!0,zIndex:9999})}var s=performance.now();if(t){a.log("ChunkSelectionHandler: Clearing all selections using batch operations",null,2);var u=n.filter((function(t){return e.isChunkResolved(t.id)})),f=new Set(u.map((function(e){return e.id}))),d=new Map;f.forEach((function(t){var n;delete e.selections[t],null!==(n=e.chunkManager.diffViewer)&&void 0!==n&&null!==(n=n.diffConfig)&&void 0!==n&&n.chunkSelections&&delete e.chunkManager.diffViewer.diffConfig.chunkSelections[t],e.visualStateManager.resetVisualState(t,!0);var r=Kt.getChunkElements(t);d.set(t,r)})),this.visualStateManager.applyBatch(!1),requestAnimationFrame((function(){d.forEach((function(e,t){e.forEach((function(e){e.classList.remove(k.STATUS.RESOLVED.name()),e.classList.add(k.STATUS.UNRESOLVED.name())}))})),e._updateNavigationCounter(),"function"==typeof e.chunkManager.onSelectionChange&&e.chunkManager.onSelectionChange(),o&&Nt.getInstance().hideLoader(o),e._recordPerformanceMetrics(s)}))}else n.forEach((function(t){var n;e.isChunkResolved(t.id)&&(Kt.getChunkElements(t.id).forEach((function(e){e.classList.remove(k.STATUS.RESOLVED.name()),e.classList.add(k.STATUS.UNRESOLVED.name())})),delete e.selections[t.id],null!==(n=e.chunkManager.diffViewer)&&void 0!==n&&null!==(n=n.diffConfig)&&void 0!==n&&n.chunkSelections&&delete e.chunkManager.diffViewer.diffConfig.chunkSelections[t.id],e.visualStateManager.resetVisualState(t.id))})),this._updateNavigationCounter(),"function"==typeof this.chunkManager.onSelectionChange&&this.chunkManager.onSelectionChange(),this._recordPerformanceMetrics(s)}}],t&&mn(e.prototype,t),n&&mn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function yn(e){return yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yn(e)}function bn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return wn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function En(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tn(r.key),r)}}function Tn(e){var t=function(e,t){if("object"!=yn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=yn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yn(t)?t:t+""}var In=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.chunkManager=t},(t=[{key:"extractChunkLines",value:function(e,t){if(!this.chunkManager.chunks.find((function(t){return t.id===e})))return a.log("MergeContentGenerator: Chunk not found: ".concat(e),null,3),[];var n="old"===t?this.chunkManager.oldContent:this.chunkManager.newContent,r=n.filter((function(t){return t.chunkId===e}));return a.log("MergeContentGenerator: Extracted ".concat(r.length," lines from chunk ").concat(e," (").concat(t,")"),{chunkId:e,side:t,linesCount:r.length,totalContentLines:n.length,sampleLines:r.slice(0,3)},3),r}},{key:"generateMergedContent",value:function(e){if(a.log("MergeContentGenerator: Starting merge generation",{totalChunks:this.chunkManager.chunks.length,selections:Object.keys(e).length},2),0===Object.keys(e).length)return a.log("MergeContentGenerator: No selections, returning new content",null,2),Kt.generateFileContent(this.chunkManager.newContent);var t=[],n={},r={};this.chunkManager.oldContent.forEach((function(e){e.chunkId&&(n[e.chunkId]||(n[e.chunkId]=[]),n[e.chunkId].push(e))})),this.chunkManager.newContent.forEach((function(e){e.chunkId&&(r[e.chunkId]||(r[e.chunkId]=[]),r[e.chunkId].push(e))}));var o,i=new Set,l=bn(this.chunkManager.newContent);try{for(l.s();!(o=l.n()).done;){var c=o.value;c.chunkId&&e[c.chunkId]?i.has(c.chunkId)||("left"===e[c.chunkId]?(n[c.chunkId]||[]).forEach((function(e){"content"===e.type&&t.push(e)})):(r[c.chunkId]||[]).forEach((function(e){"content"===e.type&&t.push(e)})),i.add(c.chunkId)):c.chunkId||"content"===c.type&&t.push(c)}}catch(e){l.e(e)}finally{l.f()}a.log("MergeContentGenerator: Processing complete",{totalMergedLines:t.length,processedChunks:Array.from(i),sampleLines:t.slice(0,3).map((function(e){var t;return(null===(t=e.line)||void 0===t?void 0:t.substring(0,50))+"..."||0}))},3);var s=Kt.generateFileContent(t);return a.log("MergeContentGenerator: Merge generation complete",{totalLines:t.length,contentLength:s.length},2),s}},{key:"generateFileFromLines",value:function(e){return Kt.generateFileContent(e)}}])&&En(e.prototype,t),n&&En(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Cn(e){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cn(e)}function Ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sn(e,t,n){return(t=Mn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Mn(r.key),r)}}function Mn(e){var t=function(e,t){if("object"!=Cn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Cn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Cn(t)?t:t+""}var On=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diffViewer=t,this.chunks=[],this.oldContent=[],this.newContent=[],this.chunkElements=[],this.renderer=new en(this),this.selectionHandler=new vn(this),this.contentGenerator=new In(this),this.SELECTED_STATE=k.DIFF.CHUNK_SELECTED.name(),this.UNSELECTED_STATE=k.DIFF.CHUNK_UNSELECTED.name(),this._performanceMetrics={initTime:0,renderTime:0,chunkCount:0},a.log("ChunkManager: Component initialized",null,2)},t=[{key:"initChunks",value:function(e){var t=performance.now();a.log("ChunkManager: Initializing chunks from diff data",null,2),Kt.clearCache(),this.chunks=e.chunks||[],this.oldContent=e.old||[],this.newContent=e.new||[],this._performanceMetrics.chunkCount=this.chunks.length,this.chunks.forEach((function(e){e.conflict=!0})),a.log("ChunkManager: ".concat(this.chunks.length," chunks initialized"),null,3),this.diffViewer.diffNavigator&&this.diffViewer.diffNavigator.updateCounter();var n=performance.now();return this._performanceMetrics.initTime=n-t,a.log("ChunkManager: Initialization completed in ".concat(this._performanceMetrics.initTime.toFixed(2),"ms"),null,2),this.validateChunkStructure(),this.chunks}},{key:"renderChunks",value:function(){var e=performance.now();this.renderer.renderChunks(),this.selectionHandler.visualStateManager.initialize&&this.selectionHandler.visualStateManager.initialize(),this.setupChunkSelection(),this.initChunkElements();var t=performance.now();return this._performanceMetrics.renderTime=t-e,a.log("ChunkManager: Rendering completed in ".concat(this._performanceMetrics.renderTime.toFixed(2),"ms"),{chunkCount:this._performanceMetrics.chunkCount,msPerChunk:(this._performanceMetrics.renderTime/Math.max(1,this._performanceMetrics.chunkCount)).toFixed(2)},2),!0}},{key:"setupChunkSelection",value:function(){this.selectionHandler.setupChunkSelection()}},{key:"toggleChunkSelection",value:function(e,t,n){this.selectionHandler.toggleChunkSelection(e,t,n)}},{key:"generateMergedContent",value:function(){var e=this.selectionHandler.getSelections();return this.contentGenerator.generateMergedContent(e)}},{key:"generateFileFromLines",value:function(e){return this.contentGenerator.generateFileFromLines(e)}},{key:"initChunkElements",value:function(){var e=this;this.chunkElements=[],a.log("ChunkManager: Looking for ".concat(this.chunks.length," chunks in DOM"),null,2),this.chunks.forEach((function(t,n){var r=Kt.getChunkElements(t.id);if(a.log("ChunkManager: Chunk ID ".concat(t.id,": Found ").concat(r.length," elements"),null,3),r.length>0){var o=Kt.sortElementsByLineNumber(r);e.chunkElements[n]=o[0]}else a.warn("ChunkManager: No DOM elements found for chunk ID: ".concat(t.id),null,2)}));var t=this.chunkElements.filter(Boolean).length;if(a.log("ChunkManager: Initialized ".concat(t,"/").concat(this.chunks.length," chunk elements for navigation"),null,2),0===t&&this.chunks.length>0){a.error("ChunkManager: No chunk elements found in DOM. Navigation will not work properly.",null,1);var n=document.querySelectorAll(k.DIFF.CHUNK);a.warn("ChunkManager: ".concat(n.length," elements match the chunk selector ").concat(k.DIFF.CHUNK),null,2);var r=document.querySelectorAll("[data-chunk-id]");a.warn("ChunkManager: ".concat(r.length," elements have data-chunk-id attribute"),null,2)}}},{key:"validateChunkStructure",value:function(){var e=0,t=0;return this.chunks.forEach((function(n){n.old||n.new?"replace"!==n.type||n.old&&n.new?e++:(a.warn("ChunkManager: Replace chunk ".concat(n.id," missing old or new content"),n,2),t++):(a.warn("ChunkManager: Chunk ".concat(n.id," missing content arrays"),n,2),t++)})),a.log("ChunkManager: Chunk validation complete",{valid:e,invalid:t,total:this.chunks.length},2),0===t}},{key:"getPerformanceMetrics",value:function(){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(n),!0).forEach((function(t){Sn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this._performanceMetrics);return this.selectionHandler.visualStateManager.getMetrics&&(e.visualStateManager=this.selectionHandler.visualStateManager.getMetrics()),e.cacheStats=Kt.getCacheStats(),e}},{key:"selections",get:function(){return this.selectionHandler.getSelections()}},{key:"onSelectionChange",value:function(){}}],t&&kn(e.prototype,t),n&&kn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Nn(e){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nn(e)}function _n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jn(r.key),r)}}function jn(e){var t=function(e,t){if("object"!=Nn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Nn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Nn(t)?t:t+""}var xn=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k.THEME.TOGGLE.name(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k.CONTAINER.WRAPPER.name();!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.toggleElementId=n,this.containerId=r,this.toggleElement=ce.getElement(n),this.container=ce.getElement(r),this.themeManager=Je.getInstance(),this.translationManager=H.getInstance(),this.browserUIManager=t,a.log("ThemeToggle: Component created",null,2)},(t=[{key:"initialize",value:function(){if(a.log("ThemeToggle: Initializing",null,2),!this.toggleElement||!this.container)return a.warn("ThemeToggle: Elements not found for initialization - toggle: ".concat(!!this.toggleElement,", container: ").concat(!!this.container),null,2),!1;var e=this.themeManager.getCurrentTheme();return this.toggleElement.checked="dark"===e.mode,this.themeManager.updateContainerThemeClass(e.mode),this.toggleElement.addEventListener("change",this.handleToggle.bind(this)),this.themeManager.addListener(this.updateToggle.bind(this)),a.log("ThemeToggle: BrowserUIManager reference ".concat(this.browserUIManager?"is available":"is not available"),null,2),a.log("ThemeToggle: Initialized successfully",null,2),!0}},{key:"setBrowserUIManager",value:function(e){return this.browserUIManager=e,a.log("ThemeToggle: BrowserUIManager reference set",null,2),this}},{key:"handleToggle",value:function(e){var t=this,n=e.target.checked?"dark":"light";this.browserUIManager?this.browserUIManager.showThemeLoading():a.log("ThemeToggle: BrowserUIManager not available, no loading indicator will be shown",null,2);try{this.themeManager.setThemeMode(n).then((function(){t.browserUIManager&&t.browserUIManager.hideThemeLoading(),a.log("ThemeToggle: Theme toggled to ".concat(n," mode"),null,2)})).catch((function(e){t.browserUIManager&&t.browserUIManager.hideThemeLoading(),a.error("ThemeToggle: Error toggling theme:",e,2)}))}catch(e){this.browserUIManager&&this.browserUIManager.hideThemeLoading(),a.error("ThemeToggle: Error toggling theme:",e,2)}}},{key:"updateToggle",value:function(e){if(this.toggleElement){var t=e||this.themeManager.getCurrentTheme();this.toggleElement.checked="dark"===t.mode,this.container&&this.themeManager.updateContainerThemeClass(t.mode)}}}])&&_n(e.prototype,t),n&&_n(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function An(e){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},An(e)}function Dn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pn(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Un(e,t,n){return(t=Bn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bn(r.key),r)}}function Bn(e){var t=function(e,t){if("object"!=An(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=An(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==An(t)?t:t+""}function Hn(e,t){if(t&&("object"==An(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Vn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Vn=function(){return!!e})()}function Gn(e){return Gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gn(e)}function zn(e,t){return zn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zn(e,t)}var Yn=null,Wn=function(e){function t(){var e,n,r,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Gn(r=t),(e=Hn(n,Vn()?Reflect.construct(r,o||[],Gn(n).constructor):r.apply(n,o)))._isFirstInstance(Yn)?(e.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(n),!0).forEach((function(t){Un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({debug:!1,translations:{}},i),e.modals={},e.activeModal=null,e.initialized=!1,a.log("ModalManager: Initialized",null,2),e):Hn(e)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zn(e,t)}(t,e),n=t,r=[{key:"initModals",value:function(){try{if(this.initialized)return a.log("ModalManager: Already initialized",null,2),!0;var e=H.getInstance();return this.createModal({id:k.MODAL.CONFIRM.name(),title:e.get("confirmation"),contentId:k.MODAL.MESSAGE.name(),contentClass:k.UTILITY.PADDING_3.name(),footerButtons:[{id:k.MODAL.CONTINUE_BTN.name(),text:e.get("continueResolving"),class:k.UTILITY.BUTTON.name()+" "+k.UTILITY.BUTTON_PRIMARY.name()+" "+k.UTILITY.MARGIN_END_2.name()},{id:k.MODAL.MERGE_BTN.name(),text:e.get("mergeAnyway"),class:k.UTILITY.BUTTON.name()+" "+k.UTILITY.BUTTON_WARNING.name()}]}),this.createModal({id:k.MODAL.PREVIEW.name(),title:'<span id="'+k.MODAL.PREVIEW_FILENAME.name()+'"></span>',contentId:k.MODAL.PREVIEW_CONTENT_ID.name(),contentClass:k.MODAL.PREVIEW_CONTENT.name(),headerClass:k.MODAL.HEADER_FIXED.name(),modalClass:"vdm-modal--fixed-footer",fullscreen:!0}),this.createModal({id:k.MERGE.CONFLICT_MODAL.name(),title:e.get("unresolvedConflicts"),contentId:k.MODAL.MESSAGE.name(),contentClass:k.UTILITY.PADDING_3.name(),footerButtons:[{id:k.MODAL.CONTINUE_BTN.name(),text:e.get("continueResolving"),class:k.UTILITY.BUTTON.name()+" "+k.UTILITY.BUTTON_PRIMARY.name()+" "+k.UTILITY.MARGIN_END_2.name()},{id:k.MODAL.MERGE_BTN.name(),text:e.get("mergeAnyway"),class:k.UTILITY.BUTTON.name()+" "+k.UTILITY.BUTTON_WARNING.name()}]}),this._setupEventListeners(),this.initialized=!0,a.log("ModalManager: Modals initialized",null,2),!0}catch(e){return a.error("ModalManager: Error initializing modals",e,1),!1}}},{key:"createModal",value:function(e){try{var t=e.id;if(document.getElementById(t))return a.log("ModalManager: Modal ".concat(t," already exists in DOM"),null,2),!0;var n=e.headerClass||k.MODAL.HEADER.name(),r='\n                <div id="'.concat(t,'" class="').concat(k.MODAL.CONTAINER.name()).concat(e.modalClass?" "+e.modalClass:"",'" style="display: none;"');if(e.attr&&Object.entries(e.attr).forEach((function(e){var t=Dn(e,2),n=t[0],o=t[1];r+=" ".concat(n,'="').concat(o,'"')})),r+='>\n                    <div class="'.concat(k.MODAL.CONTENT.name(),'">\n                        <div class="').concat(n,'">\n                            <h5 class="').concat(k.MODAL.TITLE.name(),'">').concat(e.title,'</h5>\n                            <button class="').concat(k.MODAL.CLOSE.name(),'">&times;</button>\n                        </div>'),e.contentId?r+='<div id="'.concat(e.contentId,'" class="').concat(e.contentClass||"",'"></div>'):r+='<div class="'.concat(e.contentClass||"",'"></div>'),e.footerButtons&&e.footerButtons.length>0&&(r+='<div class="'.concat(k.MODAL.FOOTER.name()," ").concat(k.UTILITY.FLEX.name()," ").concat(k.UTILITY.JUSTIFY_CONTENT_BETWEEN.name()," ").concat(k.UTILITY.PADDING_3.name(),'">'),e.footerButtons.forEach((function(e){var t=null==e?void 0:e.class.split(" ").includes(k.MODAL.CLOSE.name()),n="chevron-right";if(e.class){var o=e.class.split(" ");o.some((function(e){return e.includes("primary")}))||o.some((function(e){return e.includes("success")}))?n="check-circle":o.some((function(e){return e.includes("danger")}))?n="exclamation-triangle":o.some((function(e){return e.includes("warning")}))?n="exclamation-circle":o.some((function(e){return e.includes("info")}))&&(n="info-circle")}e.id&&(e.id.toLowerCase().includes("copy")?n="copy":e.id===k.MODAL.CONTINUE_BTN.name()?n="chevron-right":e.id===k.MODAL.MERGE_BTN.name()&&(n="exclamation-circle"));var i="";t||(i=ce.getIconHtml(n,{classes:k.UTILITY.MARGIN_END_2.name()})),r+='<button id="'.concat(e.id,'" class="').concat(e.class||k.UTILITY.BUTTON.name()+" "+k.UTILITY.BUTTON_SECONDARY.name(),'"'),e.data&&Object.entries(e.data).forEach((function(e){var t=Dn(e,2),n=t[0],o=t[1];r+=" data-".concat(n,'="').concat(o,'"')})),t&&!e.text?r+="></button>":r+=">".concat(i,"<span>").concat(e.text||"","</span></button>")})),r+="</div>"),r+="\n                    </div>\n                </div>\n            ",this._appendToBody(t,r),this.modals[t]={element:document.getElementById(t),isOpen:!1,config:e},e.fullscreen){var o=document.getElementById(t);o&&this.setFullscreenSize(o)}if(e.events){var i=document.getElementById(t);Object.entries(e.events).forEach((function(e){var n=Dn(e,2),r=n[0],o=n[1];("modal"===r?[i]:"close"===r?Array.from(i.querySelectorAll(k.MODAL.CLOSE)):Array.from(i.querySelectorAll(r))).forEach((function(e){e&&Object.entries(o).forEach((function(n){var o=Dn(n,2),i=o[0],l=o[1];e.addEventListener(i,l),a.log("ModalManager: Attached ".concat(i," event to ").concat(r," in modal ").concat(t),null,3)}))}))}))}return a.log("ModalManager: Created modal - ".concat(t),null,3),!0}catch(t){return a.error("ModalManager: Error creating modal - ".concat(e.id),t,1),!1}}},{key:"_getIconNameForButton",value:function(e){var t=e.text.toLowerCase();if(t.includes("continue"))return"chevron-right";if(t.includes("merge"))return"check";if(t.includes("close")||t.includes("cancel"))return"exclamation-circle";if(t.includes("confirm")||t.includes("ok"))return"check-circle";if(t.includes("copy"))return"copy";if(t.includes("download"))return"file";if(t.includes("upload"))return"file-circle-plus";if(t.includes("save"))return"check-circle";if(t.includes("delete"))return"exclamation-triangle";if(t.includes("edit"))return"eye";if(e.class){var n=e.class.toLowerCase();if(n.includes("primary"))return"check";if(n.includes("secondary"))return"chevron-right";if(n.includes("success"))return"check-circle";if(n.includes("danger"))return"exclamation-triangle";if(n.includes("warning"))return"exclamation-circle";if(n.includes("info"))return"info-circle"}return"chevron-right"}},{key:"_appendToBody",value:function(e,t){if(!document.getElementById(e)){var n=document.createElement("div");n.innerHTML=t,document.body.appendChild(n.firstElementChild)}var r=document.getElementById(k.MODAL.BACKDROP.name());r||((r=document.createElement("div")).id=k.MODAL.BACKDROP.name(),r.style.display="none",document.body.appendChild(r))}},{key:"_setupEventListeners",value:function(){var e=this;document.addEventListener("click",(function(t){if(t.target.matches(k.MODAL.CLOSE)){var n=t.target.closest(k.MODAL.CONTAINER);null!=n&&n.id&&e.close(n.id)}}));var t=document.getElementById(k.MODAL.BACKDROP.name());t&&t.addEventListener("click",(function(){e.activeModal&&e.close(e.activeModal)})),document.addEventListener("keydown",(function(t){"Escape"===t.key&&e.activeModal&&e.close(e.activeModal)}))}},{key:"register",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=document.getElementById(e);return n?(this.modals[e]={element:n,isOpen:!1,options:t},a.log("ModalManager: Registered modal - ".concat(e),null,3),!0):(a.warn("ModalManager: Element not found for modal ID ".concat(e),null,2),!1)}catch(t){return a.error("ModalManager: Error registering modal - ".concat(e),t,1),!1}}},{key:"registerBeforeOpenCallback",value:function(e,t){try{return this.modals[e]||(this.modals[e]={element:document.getElementById(e),isOpen:!1,config:{}}),this.modals[e].beforeOpenCallbacks||(this.modals[e].beforeOpenCallbacks=[]),this.modals[e].beforeOpenCallbacks.push(t),a.log("ModalManager: Registered before-open callback for modal ".concat(e),null,2),!0}catch(t){return a.error("ModalManager: Error registering before-open callback for modal ".concat(e),t,1),!1}}},{key:"open",value:function(e){try{var t=this.modals[e];if(!t){a.warn("ModalManager: Cannot open modal ".concat(e," - not registered"),null,2);var n=document.getElementById(e);return!!n&&(a.log("ModalManager: Found unregistered modal element ".concat(e,", registering now"),null,2),this.register(e,{element:n}),this._showModal(e),!0)}return t.beforeOpenCallbacks&&t.beforeOpenCallbacks.length>0&&(a.log("ModalManager: Executing ".concat(t.beforeOpenCallbacks.length," before-open callbacks for modal ").concat(e),null,2),t.beforeOpenCallbacks.forEach((function(t){try{t()}catch(t){a.error("ModalManager: Error in before-open callback for modal ".concat(e),t,1)}}))),this._showModal(e),!0}catch(t){return a.error("ModalManager: Error opening modal ".concat(e,":"),t,2),!1}}},{key:"_showModal",value:function(e){var t=this.modals[e];if(t){this.activeModal=e;var n=document.getElementById(k.MODAL.BACKDROP.name());n&&(n.style.display="block",setTimeout((function(){n.style.opacity="1"}),10)),t.element.style.display="block",t.element.style.opacity="0",a.log("ModalManager: Setting modal ".concat(e," display to block"),{modalElement:t.element.id,displayBefore:t.element.style.display},2),setTimeout((function(){t.element.style.opacity="1",a.log("ModalManager: Fading in modal ".concat(e),null,3)}),10),t.isOpen=!0,e===k.MODAL.PREVIEW.name()&&this.setFullscreenSize(t.element),document.body.style.overflow="hidden"}else a.warn("ModalManager: Modal ".concat(e," not found"),null,2)}},{key:"_hideModal",value:function(e){var t=this,n=this.modals[e];n&&(n.element.style.opacity="0",setTimeout((function(){if(n.element.style.display="none",n.isOpen=!1,t.activeModal===e){var r=document.getElementById(k.MODAL.BACKDROP.name());r&&(r.style.opacity="0",setTimeout((function(){r.style.display="none"}),150)),document.body.style.overflow="",t.activeModal=null}}),250))}},{key:"close",value:function(e){try{return this.modals[e]?(this._hideModal(e),a.log("ModalManager: Closed modal - ".concat(e),null,3),!0):(a.warn("ModalManager: Modal not found - ".concat(e),null,2),!1)}catch(t){return a.error("ModalManager: Error closing modal - ".concat(e),t,1),!1}}},{key:"setContent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{a.log("ModalManager: Setting content for modal ".concat(e),{contentType:An(t),contentLength:"string"==typeof t?t.length:"Element",contentPreview:"string"==typeof t?t.substring(0,150)+"...":"Element object",targetSelector:n},2);var r,o,i=this.modals[e];if(!i)return a.error("ModalManager: Modal not found - ".concat(e),null,1),!1;if(n)a.log("ModalManager: Looking for content container with selector: ".concat(n),null,2),n.startsWith("#")||n.startsWith(".")||(r=document.getElementById(n),a.log("ModalManager: Tried getElementById with: ".concat(n,", found: ").concat(!!r),null,2)),r||(r=document.querySelector(n),a.log("ModalManager: Tried querySelector with: ".concat(n,", found: ").concat(!!r),null,2)),a.log("ModalManager: Container lookup result:",{found:!!r,id:(null===(o=r)||void 0===o?void 0:o.id)||"none",classList:r?Array.from(r.classList):[]},2);else if(r=i.element.querySelector(k.MODAL.CONTENT),a.log("ModalManager: Using default content container:",{found:!!r,selector:k.MODAL.CONTENT},2),!r)return a.error("ModalManager: Content container not found - ".concat(e),null,1),!1;if(!r)return a.error("ModalManager: Could not find content container with selector: ".concat(n),null,1),!1;if("string"==typeof t){a.log("ModalManager: Setting HTML content for modal ".concat(e),{contentLength:t.length,containsPre:t.includes("<pre"),container:r.id||r.className},2),r.innerHTML=t;var l=r.querySelectorAll("pre").length>0;a.log("ModalManager: Content set verification:",{hasPreElements:l,innerHTML:r.innerHTML.substring(0,100)+"..."},2),t.includes("<pre")&&!l&&a.warn("ModalManager: Content included <pre> tags but none found after setting innerHTML",{innerHtmlLength:r.innerHTML.length},1)}else{if(!(t instanceof Element))return a.error("ModalManager: Invalid content type - ".concat(An(t)),null,1),!1;a.log("ModalManager: Setting Element content for modal ".concat(e),{elementType:t.tagName,elementId:t.id||"none"},2),r.innerHTML="",r.appendChild(t)}return a.log("ModalManager: Content set for modal - ".concat(e),null,3),!0}catch(t){return a.error("ModalManager: Error setting content - ".concat(e),t,1),!1}}},{key:"setFullscreenSize",value:function(e){try{if(!e)return a.warn("ModalManager: Modal element not provided for fullscreen",null,2),!1;e.classList.add(k.MODAL.FULLSCREEN.name());var t=e.querySelector(k.MODAL.HEADER)?e.querySelector(k.MODAL.HEADER).offsetHeight:0,n=e.querySelector(k.MODAL.CONTENT);return n&&(n.style.height="calc(100% - ".concat(t,"px)")),a.log("ModalManager: Modal set to fullscreen size",null,3),!0}catch(e){return a.error("ModalManager: Error setting fullscreen size",e,1),!1}}},{key:"createCopyModal",value:function(e){var t=this,n=k.MODAL.CODE_COPY.name(),r=H.getInstance();this.modals[n]||this.createModal({id:n,title:r.get("copyCode"),contentId:k.MODAL.COPY_CONTENT.name(),modalClass:k.MODAL.FIXED_FOOTER.name(),headerClass:k.MODAL.HEADER_FIXED.name(),footerButtons:[{class:"".concat(k.MODAL.CLOSE.name()," ").concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_SECONDARY.name())}]});var o=this._escapeHtml(e),i='\n            <div class="'.concat(k.COPY.MODAL.DIALOG.name(),'">\n                <p class="').concat(k.COPY.MODAL.INSTRUCTIONS.name(),'">').concat(r.get("copyInstructions"),'</p>\n                <div class="').concat(k.COPY.MODAL.TEXTAREA.name(),'">\n                    <textarea id="').concat(k.COPY.MODAL.TEXTAREA_ELEM.name(),'" class="').concat(k.COPY.MODAL.TEXTAREA_ELEM.name(),'">').concat(o,'</textarea>\n                </div>\n                <div class="').concat(k.COPY.MODAL.ACTIONS.name(),'">\n                    <button id="').concat(k.COPY.MODAL.BUTTON.name(),'" class="').concat(k.COPY.MODAL.BUTTON.name()," ").concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_PRIMARY.name(),'">\n                        ').concat(ce.getIconHtml("copy",{classes:k.UTILITY.MARGIN_END_2.name()}),"\n                        <span>").concat(r.get("copyToClipboard"),"</span>\n                    </button>\n                </div>\n            </div>\n        ");return this.setContent(n,i,k.MODAL.COPY_CONTENT.name()),setTimeout((function(){var e=document.getElementById(k.COPY.MODAL.TEXTAREA_ELEM.name()),n=document.getElementById(k.COPY.MODAL.BUTTON.name());e&&(e.addEventListener("focus",(function(){this.select()})),e.select()),n&&e&&n.addEventListener("click",function(){var t=this;e.select();try{var r;null!==(r=navigator.clipboard)&&void 0!==r&&r.writeText?navigator.clipboard.writeText(e.value).then((function(){t._showCopySuccess(n),a.log("ModalManager: Successfully copied using Clipboard API",null,3)})).catch((function(e){document.execCommand("copy")?(t._showCopySuccess(n),a.log("ModalManager: Successfully copied using execCommand fallback",null,3)):(t._showCopyFailure(n),a.warn("ModalManager: Copy failed with execCommand fallback",null,2))})):document.execCommand("copy")?(this._showCopySuccess(n),a.log("ModalManager: Successfully copied using execCommand",null,3)):(this._showCopyFailure(n),a.warn("ModalManager: Copy failed with execCommand",null,2))}catch(e){this._showCopyFailure(n),a.error("ModalManager: Error during copy operation",e,2)}}.bind(t))}),300),n}},{key:"_showCopySuccess",value:function(e){var t=H.getInstance();e.innerHTML=ce.getIconHtml("check-circle",{classes:"vdm-icon--success "+k.UTILITY.MARGIN_END_2.name()})+"<span>".concat(t.get("copied"),"</span>"),e.classList.remove(k.UTILITY.BUTTON_PRIMARY.name()),e.classList.add(k.UTILITY.BUTTON_SUCCESS.name()),setTimeout((function(){e.innerHTML=ce.getIconHtml("copy",{classes:k.UTILITY.MARGIN_END_2.name()})+"<span>".concat(t.get("copyToClipboard"),"</span>"),e.classList.remove(k.UTILITY.BUTTON_SUCCESS.name()),e.classList.add(k.UTILITY.BUTTON_PRIMARY.name())}),2e3)}},{key:"_showCopyFailure",value:function(e){var t=H.getInstance();e.innerHTML=ce.getIconHtml("exclamation-triangle",{classes:"vdm-icon--danger "+k.UTILITY.MARGIN_END_2.name()})+"<span>".concat(t.get("copyFailed"),"</span>"),e.classList.remove(k.UTILITY.BUTTON_PRIMARY.name()),e.classList.add(k.UTILITY.BUTTON_DANGER.name()),setTimeout((function(){e.innerHTML=ce.getIconHtml("copy",{classes:k.UTILITY.MARGIN_END_2.name()})+"<span>".concat(t.get("tryAgain"),"</span>"),e.classList.remove(k.UTILITY.BUTTON_DANGER.name()),e.classList.add(k.UTILITY.BUTTON_PRIMARY.name())}),2e3)}},{key:"_escapeHtml",value:function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):""}},{key:"createAndOpenModal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{return e.id||(e.id="vdm-modal--dynamic-"+Date.now()),this.createModal(e),t&&this.setContent(e.id,t,n||e.contentId),this.open(e.id),e.id}catch(e){return a.error("ModalManager: Error creating and opening modal",e,1),null}}},{key:"createConfirmationModal",value:function(e){var t=this,n="vdm-modal--confirmation-"+Date.now();return this.createModal({id:n,title:e.title||"Confirmation",contentId:"vdm-modal__confirmation-content",contentClass:k.UTILITY.PADDING_3.name(),footerButtons:[{id:"".concat(n,"-cancel-btn"),text:e.cancelText||"Cancel",class:"".concat(k.MODAL.CLOSE.name()," ").concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_SECONDARY.name()," me-2")},{id:"".concat(n,"-confirm-btn"),text:e.confirmText||"Confirm",class:"".concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_PRIMARY.name())}],events:Un(Un({},"#".concat(n,"-confirm-btn"),{click:function(){"function"==typeof e.onConfirm&&e.onConfirm(),t.close(n)}}),"#".concat(n,"-cancel-btn"),{click:function(){"function"==typeof e.onCancel&&e.onCancel(),t.close(n)}})}),this.setContent(n,"<p>".concat(e.message||"","</p>"),"vdm-modal__confirmation-content"),this.open(n),n}},{key:"createAlertModal",value:function(e){var t=this,n="".concat(k.MODAL.CONTAINER.name(),"--alert-").concat(Date.now()),r=e.type?"".concat(k.UTILITY.ALERT," ").concat(k.UTILITY.ALERT_PREFIX).concat(e.type):"".concat(k.UTILITY.ALERT," ").concat(k.UTILITY.ALERT_INFO);this.createModal({id:n,title:e.title||"Alert",contentId:"".concat(k.MODAL.CONTAINER.name(),"__alert-content"),contentClass:k.UTILITY.PADDING_3.name(),footerButtons:[{id:"".concat(n,"-ok-btn"),text:e.buttonText||"OK",class:"".concat(k.MODAL.CLOSE.name()," ").concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_PRIMARY.name())}],events:Un({},"#".concat(n,"-ok-btn"),{click:function(r){"function"==typeof e.onClose&&e.onClose(r),t.close(n)}})});var o='\n            <div class="'.concat(r,' mb-0">\n                ').concat(e.message||"","\n            </div>\n        ");return this.setContent(n,o,"".concat(k.MODAL.CONTAINER.name(),"__alert-content")),this.open(n),n}},{key:"destroy",value:function(){try{this.activeModal&&this.close(this.activeModal),this.modals={},this.activeModal=null,a.log("ModalManager: Destroyed",null,2)}catch(e){a.error("ModalManager: Error during destroy",e,1)}}}],o=[{key:"getInstance",value:function(){return Yn||(Yn=new t(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})),Yn}}],r&&Fn(n.prototype,r),o&&Fn(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o}(u);function qn(e){return qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qn(e)}function Kn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xn(r.key),r)}}function Xn(e){var t=function(e,t){if("object"!=qn(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=qn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qn(t)?t:t+""}var Jn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,r=[{key:"addCopyButtonsToPreview",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k.MODAL.PREVIEW_CONTENT_ID.name(),n=H.getInstance(),r=ce.getElement(t);if(!r){var o=document.getElementById(t),i=document.querySelector("#"+t);return a.log("CopyButton: Alternative container lookup results",{getElementById:!!o,querySelector:!!i},2),a.warn("CopyButton: Preview container not found",null,2),!1}var l=r.querySelectorAll("pre");return l&&0!==l.length?(l.forEach((function(t){if(!t.querySelector(k.COPY.BUTTON)){var r=ce.createElement("button",null,k.COPY.BUTTON.name(),{type:"button",title:n.get("copyCode")});r.innerHTML='<span class="'.concat(k.COPY.ICON.name(),'"></span><span class="').concat(k.COPY.TEXT.name(),'">').concat(n.get("copy"),"</span>"),t.style.position="relative";var o=t.querySelector("code");o?t.insertBefore(r,o):t.appendChild(r),r.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation();var o,i=t.querySelector("code");i&&(e._sourceCodeElement=i,i.hasAttribute("data-original-code")?(o=e._decodeHTMLEntities(i.getAttribute("data-original-code")),a.log("CopyButton: Using original code from attribute",null,3)):(o=(o=i.textContent||"").replace(/\n\n+/g,"\n"),a.log("CopyButton: Using text content from code element",null,3)),a.log("CopyButton: Text length: "+o.length,null,3),e._showManualCopyModal(o),e._showProcessingState(r))}))}})),a.log("CopyButton: Added copy buttons to ".concat(l.length," code blocks"),null,2),!0):(a.log("CopyButton: No code blocks found in preview",null,3),!1)}},{key:"_showProcessingState",value:function(e){e.classList.add(k.COPY.PROCESSING.name());var t=e.querySelector(".".concat(k.COPY.TEXT.name()));t&&(t.textContent="Open Copy Dialog..."),setTimeout((function(){e.classList.remove(k.COPY.PROCESSING.name()),t&&(t.textContent="Copy")}),1e3)}},{key:"_showCopiedState",value:function(e){e.classList.add(k.COPY.COPIED.name());var t=e.querySelector(".".concat(k.COPY.TEXT.name()));t&&(t.textContent="Copied!"),setTimeout((function(){e.classList.remove(k.COPY.COPIED.name()),t&&(t.textContent="Copy")}),2e3)}},{key:"_showManualCopyModal",value:function(e){var t=Wn.getInstance(),n=t.createCopyModal(e);t.open(n),a.log("CopyButton: Showing manual copy modal",null,2)}},{key:"_showCopyFailure",value:function(e){e.innerHTML=ce.getIconHtml("exclamation-triangle",{classes:k.UTILITY.MARGIN_END_2.name()})+"Copy Failed",e.classList.remove(k.UTILITY.BUTTON_PRIMARY.name(),k.UTILITY.BUTTON_SUCCESS.name()),e.classList.add(k.UTILITY.BUTTON_DANGER.name()),setTimeout((function(){e.innerHTML=ce.getIconHtml("copy",{classes:k.UTILITY.MARGIN_END_2.name()})+"Try Again",e.classList.remove(k.UTILITY.BUTTON_DANGER.name()),e.classList.add(k.UTILITY.BUTTON_PRIMARY.name())}),2e3)}},{key:"_decodeHTMLEntities",value:function(e){if(!e)return"";var t=document.createElement("textarea");return t.innerHTML=e,t.value}}],(n=null)&&Kn(t.prototype,n),r&&Kn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r}();function $n(e){return $n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$n(e)}function Zn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Qn(r.key),r)}}function Qn(e){var t=function(e,t){if("object"!=$n(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$n(t)?t:t+""}var er=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mergeHandler=t,this.diffViewer=t.diffViewer,this.modalManager=t.modalManager},(t=[{key:"initialize",value:function(){this.setupPreviewButton(),a.log("MergePreviewManager: Initialized",null,2)}},{key:"setupPreviewButton",value:function(){var e=document.getElementById(k.MERGE.BUTTON_PREVIEW.name()),t=e?null:document.getElementById(k.MERGE.GET_MERGED_RESULT_BTN.name()),n=e||t;if(n){var r=n.cloneNode(!0);n.parentNode&&n.parentNode.replaceChild(r,n),n!==e||r.innerHTML&&""!==r.innerHTML.trim()||(r.innerHTML=ce.getIconHtml("eye",{classes:"me-2"})+"Preview"),r.addEventListener("click",this.handlePreviewClick.bind(this)),a.log("MergePreviewManager: ".concat(n===e?"Preview":"Get merged result"," button handler set up"),null,3)}else a.warn("MergePreviewManager: Preview button not found",null,2)}},{key:"handlePreviewClick",value:function(){a.log("MergePreviewManager: Preview button clicked",null,2);var e=H.getInstance().get("loadingContent","Generating preview..."),t=Nt.getInstance(),n=t.showLoader(e,{fullscreen:!0,zIndex:1e3});try{var r,o=this.mergeHandler.getMergedContent(),i=((null===(r=this.diffViewer.runtimeProps)||void 0===r?void 0:r.filepath)||"").split(".").pop().toLowerCase(),l=ht.formatPreview(o,i,!0);t.hideLoader(n),ce.setContent(k.MODAL.PREVIEW_FILENAME.name(),this.diffViewer.runtimeProps.filepath||"merged-file"),this.modalManager.setContent(k.MODAL.PREVIEW.name(),l,k.MODAL.PREVIEW_CONTENT_ID.name());var c=document.createElement("div");c.classList.add(k.UTILITY.FLEX.name(),k.UTILITY.JUSTIFY_CONTENT_BETWEEN.name(),k.UTILITY.MARGIN_TOP_2.name(),k.UTILITY.PADDING_2.name());var s=document.createElement("div");s.id="merge-preview-message",s.classList.add(k.UTILITY.FLEX.name(),k.UTILITY.ALIGN_ITEMS_CENTER.name()),c.appendChild(s),this.modalManager.open(k.MODAL.PREVIEW.name()),this.applySyntaxHighlighting(),Jn.addCopyButtonsToPreview(k.MODAL.PREVIEW_CONTENT_ID.name()),a.log("MergePreviewManager: Preview opened successfully",null,2)}catch(e){t.hideLoader(n),a.error("MergePreviewManager: Error during preview:",e,2),this.showPreviewError(e)}}},{key:"applySyntaxHighlighting",value:function(){if(window.hljs)try{var e,t=null===(e=ce.getElement(k.MODAL.PREVIEW_CONTENT_ID.name()))||void 0===e?void 0:e.querySelector("pre"),n=null==t?void 0:t.querySelector("code");if(!n)return void a.warn("MergePreviewManager: No code element found for highlighting",null,2);window.hljs.highlightElement(n),"true"===t.getAttribute("data-line-numbers")&&window.hljs.lineNumbersBlock&&(window.hljs.lineNumbersBlock(n),a.log("MergePreviewManager: Line numbers added to preview",null,3)),a.log("MergePreviewManager: Syntax highlighting applied",null,3)}catch(e){a.warn("MergePreviewManager: Error applying syntax highlighting:",e,2)}else a.log("MergePreviewManager: Highlight.js not available",null,3)}},{key:"showPreviewError",value:function(e){var t=e instanceof Error?e.message:String(e),n=st.escapeHtml(t);this.modalManager.setContent(k.MODAL.PREVIEW.name(),"",k.MODAL.PREVIEW_CONTENT_ID.name()),ce.showMessage(k.MODAL.PREVIEW_CONTENT_ID.name(),"<h4>Error Generating Preview</h4><p>".concat(n,"</p>"),"danger",{className:""}),this.modalManager.open(k.MODAL.PREVIEW.name())}}])&&Zn(e.prototype,t),n&&Zn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function tr(e){return tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(e)}function nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(n),!0).forEach((function(t){or(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function or(e,t,n){return(t=ar(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ir(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ar(r.key),r)}}function ar(e){var t=function(e,t){if("object"!=tr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=tr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tr(t)?t:t+""}var lr=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"scrollElementIntoView",value:function(e,t){if(!e||!t)return a.warn("NavigationUtils: Missing element or container for scrolling",null,2),!1;var n=e.offsetTop-t.clientHeight/2+e.offsetHeight/2;return t.scrollTo({top:n,behavior:"smooth"}),!0}},{key:"addHighlightEffect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;e&&(e.classList.add(k.NAVIGATION.HIGHLIGHT.name()),setTimeout((function(){e.classList.remove(k.NAVIGATION.HIGHLIGHT.name())}),t))}},{key:"makeDraggable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){var n,r,o=rr(rr({},{handleSelector:null,ignoreSelector:".nav-button, .nav-counter",positionStyle:"fixed",dragClass:"dragging"}),t),i=!1,a=function(t){if((!o.ignoreSelector||!t.target.matches(o.ignoreSelector))&&(!o.handleSelector||t.target.matches(o.handleSelector))){i=!0,e.classList.add(o.dragClass);var a=e.getBoundingClientRect();n=a.right-t.clientX,r=a.bottom-t.clientY,t.preventDefault()}},l=function(t){if(i){var o=e.parentElement.getBoundingClientRect(),a=o.right-t.clientX-n,l=o.bottom-t.clientY-r;a=Math.max(0,Math.min(a,o.width-e.offsetWidth)),l=Math.max(0,Math.min(l,o.height-e.offsetHeight)),e.style.right="".concat(a,"px"),e.style.bottom="".concat(l,"px"),e.style.left="auto",e.style.top="auto"}},c=function(){i&&(i=!1,e.classList.remove(o.dragClass))};return e.addEventListener("mousedown",a),document.addEventListener("mousemove",l),document.addEventListener("mouseup",c),{destroy:function(){e.removeEventListener("mousedown",a),document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",c)}}}}}],(t=null)&&ir(e.prototype,t),n&&ir(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function cr(e){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(e)}function sr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ur(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ur(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function ur(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function fr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dr(r.key),r)}}function dr(e){var t=function(e,t){if("object"!=cr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=cr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cr(t)?t:t+""}var hr=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mergeHandler=t,this.diffViewer=t.diffViewer,this.modalManager=t.modalManager,this.translationManager=H.getInstance(),this.mergeDestination=null,this.mergeToggleBtn=null,this.mergeToggleIcon=null,this.mergeToggleText=null},t=[{key:"initialize",value:function(){this.initMergeDestinationToggle(),this.setupModalButtons(),this.setupApplyMergeButton(),a.log("MergeUIController: Initialized",null,2)}},{key:"initMergeDestinationToggle",value:function(){if(this.mergeDestination=ce.getElement(k.MERGE.DESTINATION_DROPDOWN),this.mergeToggleBtn=ce.getElement(k.MERGE.DESTINATION_TOGGLE),this.mergeToggleIcon=document.getElementById("vdm-merge-controls__toggle-icon"),this.mergeToggleText=document.getElementById("vdm-merge-controls__toggle-text"),this.mergeDestination&&this.mergeToggleBtn){this.mergeToggleBtn&&this.mergeToggleBtn.setAttribute("type","button"),a.log("MergeUIController: Populating merge destination options",null,2),this.populateMergeDestinations();for(var e=localStorage.getItem("preferredMergeDestination")||"new",t=!1,n=0;n<this.mergeDestination.options.length;n++)if(this.mergeDestination.options[n].value===e){t=!0;break}t?this.mergeDestination.value=e:this.mergeDestination.options.length>0&&(this.mergeDestination.selectedIndex=0),a.log("MergeUIController: Initial merge destination set to ".concat(this.mergeDestination.value),null,2),this.setupMergeToggleEvents(),a.log("MergeUIController: Merge destination toggle initialized",null,2)}else a.warn("MergeUIController: Missing merge destination elements",null,2)}},{key:"populateMergeDestinations",value:function(){var e,t,n,r=this.diffViewer.getRuntimeProps(),o=r.diffData||{},i=r.newFileName||(null===(e=o.new)||void 0===e?void 0:e.filename)||(null===(t=r.filepath)||void 0===t?void 0:t.split("/").pop())||"new-file",l=r.oldFileName||(null===(n=o.old)||void 0===n?void 0:n.filename)||"old-file",c=i.split(/[\/\\]/).pop(),s=l.split(/[\/\\]/).pop();a.log("MergeUIController: File names for merge destinations",{newFileName:i,oldFileName:l,newFile:c,oldFile:s},3);var u=c.substring(0,c.lastIndexOf("."))||c,f=s.substring(0,s.lastIndexOf("."))||s,d=c.substring(c.lastIndexOf("."))||"",h=s.substring(s.lastIndexOf("."))||"",g="".concat(u,"-merged").concat(d),m="".concat(f,"-merged").concat(h),p=this.diffViewer.getConfig(),v=(null==p?void 0:p.saveOptions)||{saveToOriginal:!0,saveWithSuffix:!0,saveToOld:!0,saveToOldWithSuffix:!0,saveToBoth:!0,saveToBothWithSuffix:!0};for(a.log("MergeUIController: Save options configuration",v,3);this.mergeDestination.options.length>0;)this.mergeDestination.remove(0);this.mergeDestination.innerHTML="",a.log("MergeUIController: Cleared existing dropdown options",null,3);var y=0;v.saveToOriginal&&(ce.createAndAppendElement("option",this.mergeDestination,{attributes:{value:"new","data-tooltip":this.translationManager.get("saveToOriginalTooltip","Replace the current file with merged content")},content:"".concat(c," (new)")}),y++),v.saveWithSuffix&&(ce.createAndAppendElement("option",this.mergeDestination,{attributes:{value:"new-suffix","data-tooltip":this.translationManager.get("saveWithSuffixTooltip","Save merged content as a new file with -merged suffix")},content:"".concat(g," (new)")}),y++),v.saveToOld&&(ce.createAndAppendElement("option",this.mergeDestination,{attributes:{value:"old","data-tooltip":this.translationManager.get("saveToOldTooltip","Replace the old file with merged content")},content:"".concat(s," (old)")}),y++),v.saveToOldWithSuffix&&(ce.createAndAppendElement("option",this.mergeDestination,{attributes:{value:"old-suffix","data-tooltip":this.translationManager.get("saveToOldWithSuffixTooltip","Save merged content as a new file with -merged suffix in old location")},content:"".concat(m," (old)")}),y++),v.saveToBoth&&(ce.createAndAppendElement("option",this.mergeDestination,{attributes:{value:"both","data-tooltip":this.translationManager.get("saveToBothTooltip","Replace both old and new files with merged content")},content:this.translationManager.get("saveToBoth","Overwrite both files")}),y++),v.saveToBothWithSuffix&&(ce.createAndAppendElement("option",this.mergeDestination,{attributes:{value:"both-suffix","data-tooltip":this.translationManager.get("saveToBothWithSuffixTooltip","Save merged content as new files with -merged suffix in both locations")},content:this.translationManager.get("saveToBothWithSuffix","Save to both with suffix")}),y++),0===y&&(a.log("MergeUIController: No save options enabled, adding default option",null,2),ce.createAndAppendElement("option",this.mergeDestination,{attributes:{value:"new","data-tooltip":this.translationManager.get("saveToOriginalTooltip","Replace the current file with merged content")},content:"".concat(c," (new)")}),y=1),a.log("MergeUIController: Populated merge destinations with ".concat(y," options"),null,2)}},{key:"setupMergeToggleEvents",value:function(){var e=this,t=this.mergeToggleBtn.cloneNode(!0),n=this.mergeDestination.cloneNode(!0);this.mergeToggleBtn&&this.mergeToggleBtn.parentNode&&this.mergeToggleBtn.parentNode.replaceChild(t,this.mergeToggleBtn),this.mergeDestination&&this.mergeDestination.parentNode&&this.mergeDestination.parentNode.replaceChild(n,this.mergeDestination),this.mergeToggleBtn=t,this.mergeDestination=n,this.mergeToggleBtn.querySelector("#vdm-merge-controls__toggle-icon")?this.mergeToggleIcon=this.mergeToggleBtn.querySelector("#vdm-merge-controls__toggle-icon"):(this.mergeToggleIcon=ce.createAndAppendElement("i",this.mergeToggleBtn,{id:"vdm-merge-controls__toggle-icon"}),this.mergeToggleBtn.insertBefore(this.mergeToggleIcon,this.mergeToggleBtn.firstChild)),this.mergeToggleBtn.querySelector("#vdm-merge-controls__toggle-text")?this.mergeToggleText=this.mergeToggleBtn.querySelector("#vdm-merge-controls__toggle-text"):this.mergeToggleText=ce.createAndAppendElement("span",this.mergeToggleBtn,{id:"vdm-merge-controls__toggle-text"}),this.mergeDestination.classList.add("vdm-dropdown-visible"),this.mergeDestination.style.cursor="pointer";var r=document.createElement("span");r.className=k.UTILITY.MARGIN_START_2.name(),r.innerHTML=ce.getIconHtml("chevron-down",{width:10,height:10}),this.mergeToggleBtn.appendChild(r),this.mergeToggleBtn.addEventListener("click",(function(t){if(t.preventDefault(),t.stopPropagation(),e.mergeDestination){if(e.mergeDestination.focus(),"function"==typeof e.mergeDestination.showPicker)try{return e.mergeDestination.showPicker(),void a.log("MergeUIController: Opened dropdown using showPicker()",null,3)}catch(e){a.log("MergeUIController: showPicker() failed, trying alternative method",e,2)}setTimeout((function(){try{var t=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:window});e.mergeDestination.dispatchEvent(t)}catch(e){a.log("MergeUIController: Failed to open dropdown with click event",e,2)}}),10),e.mergeDestination.classList.add("vdm-dropdown-highlight"),setTimeout((function(){e.mergeDestination.classList.remove("vdm-dropdown-highlight")}),1e3)}a.log("MergeUIController: Toggle button clicked, attempting to open dropdown",null,3)})),this.mergeDestination.addEventListener("change",(function(){e.updateMergeToggle(e.mergeDestination.value),localStorage.setItem("preferredMergeDestination",e.mergeDestination.value),a.log("MergeUIController: Selection changed to ".concat(e.mergeDestination.value),null,3)})),this.mergeDestination.style.paddingRight="1.5rem",this.mergeDestination.style.appearance="menulist",this.mergeDestination.style.cursor="pointer",this.mergeDestination.title="Click to select where to save the merged content",this.mergeDestination.addEventListener("mouseover",(function(){e.mergeDestination.style.borderColor="var(--vdm-primary, #0d6efd)"})),this.mergeDestination.addEventListener("mouseout",(function(){e.mergeDestination.style.borderColor="var(--vdm-border-color, #495057)"})),this.updateMergeToggle(this.mergeDestination.value)}},{key:"updateMergeToggle",value:function(e){var t="vdm-text-primary",n=k.UTILITY.BUTTON_PRIMARY.name(),r=k.UTILITY.BUTTON_WARNING.name(),o=k.UTILITY.BUTTON_INFO.name(),i="",l="",c="";switch(e){case"new":case"new-suffix":default:i="file",l=t,c=n;break;case"old":case"old-suffix":i="file-lines",l="vdm-text-warning",c=r;break;case"both":case"both-suffix":i="file-copy",l="vdm-text-info",c=o}var s="".concat(k.UTILITY.MARGIN_END_1.name()," ").concat(l);this.mergeToggleIcon.innerHTML=ce.getIconHtml(i,{classes:s});var u=document.getElementById(k.MERGE.BUTTON_APPLY.name());switch(u&&(u.classList.remove(k.UTILITY.BUTTON_PRIMARY.name(),k.UTILITY.BUTTON_WARNING.name(),k.UTILITY.BUTTON_INFO.name(),k.UTILITY.BUTTON_SUCCESS.name(),k.UTILITY.BUTTON_DANGER.name(),k.UTILITY.BUTTON_SECONDARY.name()),u.classList.add(c),a.log("MergeUIController: Updated apply button style to ".concat(c),null,3)),e){case"new":default:this.mergeToggleText.textContent=this.translationManager.get("saveToOriginal","Save to original"),this.mergeToggleBtn.title=this.translationManager.get("saveToOriginalTooltip",""),this.mergeToggleBtn.setAttribute("data-value","new");break;case"new-suffix":this.mergeToggleText.textContent=this.translationManager.get("saveWithSuffix","Save with suffix"),this.mergeToggleBtn.title=this.translationManager.get("saveWithSuffixTooltip",""),this.mergeToggleBtn.setAttribute("data-value","new-suffix");break;case"old":this.mergeToggleText.textContent=this.translationManager.get("saveToOld","Save to old file"),this.mergeToggleBtn.title=this.translationManager.get("saveToOldTooltip",""),this.mergeToggleBtn.setAttribute("data-value","old");break;case"old-suffix":this.mergeToggleText.textContent=this.translationManager.get("saveToOldWithSuffix","Save to old with suffix"),this.mergeToggleBtn.title=this.translationManager.get("saveToOldWithSuffixTooltip",""),this.mergeToggleBtn.setAttribute("data-value","old-suffix");break;case"both":this.mergeToggleText.textContent=this.translationManager.get("saveToBoth","Save to both files"),this.mergeToggleBtn.title=this.translationManager.get("saveToBothTooltip",""),this.mergeToggleBtn.setAttribute("data-value","both");break;case"both-suffix":this.mergeToggleText.textContent=this.translationManager.get("saveToBothWithSuffix","Save to both with suffix"),this.mergeToggleBtn.title=this.translationManager.get("saveToBothWithSuffixTooltip",""),this.mergeToggleBtn.setAttribute("data-value","both-suffix")}a.log("MergeUIController: Toggle updated to ".concat(e),null,3)}},{key:"setupModalButtons",value:function(){var e=this;document.addEventListener("click",(function(t){if(t.target.closest&&t.target.closest("#".concat(k.MODAL.CONTINUE_BTN.name()))){a.log("MergeUIController: Continue merging button clicked via delegation",null,2),e.modalManager.close(k.MERGE.CONFLICT_MODAL.name());var n=k.MODAL.PREVIEW.name();a.log("MergeUIController: Also closing preview modal (ID: ".concat(n,")"),null,1),e.modalManager.close(n),setTimeout((function(){e.highlightUnresolvedChunks()}),400)}t.target.closest&&t.target.closest("#".concat(k.MODAL.MERGE_BTN.name()))&&(a.log("MergeUIController: Merge anyway button clicked via delegation",null,2),e.modalManager.close(k.MERGE.CONFLICT_MODAL.name()),e.mergeHandler.proceedWithMerge(e.getMergeType()))})),this.modalManager&&"function"==typeof this.modalManager.registerBeforeOpenCallback&&this.modalManager.registerBeforeOpenCallback(k.MERGE.CONFLICT_MODAL.name(),(function(){var t=document.getElementById(k.MODAL.CONTINUE_BTN.name()),n=document.getElementById(k.MODAL.MERGE_BTN.name());a.log("MergeUIController: Modal opened, buttons present: continueBtn=".concat(!!t,", mergeBtn=").concat(!!n),null,2),t&&(t.onclick=function(){a.log("MergeUIController: Continue merging clicked via direct handler",null,2),e.modalManager.close(k.MERGE.CONFLICT_MODAL.name());var t=k.MODAL.PREVIEW.name();return a.log("MergeUIController: Also closing preview modal (ID: ".concat(t,")"),null,1),e.modalManager.close(t),setTimeout((function(){e.highlightUnresolvedChunks()}),400),!1}),n&&(n.onclick=function(){return a.log("MergeUIController: Merge anyway clicked via direct handler",null,2),e.modalManager.close(k.MERGE.CONFLICT_MODAL.name()),e.mergeHandler.proceedWithMerge(e.getMergeType()),!1})}))}},{key:"setupApplyMergeButton",value:function(){var e=this,t=document.getElementById(k.MERGE.BUTTON_APPLY.name());if(t){var n=document.querySelector(k.MERGE.CONTROLS_ACTIONS.toString());if(n){var r=document.getElementById(k.MERGE.DESTINATION_DROPDOWN.name()),o=document.getElementById(k.MERGE.DESTINATION_TOGGLE.name()),i=document.createElement("form");if(i.id="vdm-merge__form",i.className=n.className,i.style.display="flex",i.style.justifyContent="space-between",i.style.width="100%",n.parentNode){for(n.parentNode.replaceChild(i,n);n.firstChild;)i.appendChild(n.firstChild);if(r&&!i.contains(r)){var l=document.querySelector(".vdm-merge-controls__destination");l&&i.insertBefore(l,i.firstChild)}a.log("MergeUIController: Created form wrapper for merge controls",null,2)}i.addEventListener("submit",(function(t){t.preventDefault(),e.handleApplyMerge(),a.log("MergeUIController: Form submitted",null,3)})),o&&(o.type="button",o.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),a.log("MergeUIController: Toggle button click intercepted to prevent form submission",null,3)}))),t.addEventListener("click",(function(n){n.preventDefault(),t.form?t.form.dispatchEvent(new Event("submit")):e.handleApplyMerge(),a.log("MergeUIController: Apply merge clicked",null,3)}))}else a.warn("MergeUIController: Merge controls container not found",null,2)}else a.warn("MergeUIController: Apply merge button not found",null,2)}},{key:"handleApplyMerge",value:function(){var e=this.countUnresolvedConflicts();if(e>0)this.showConflictModal(e);else{var t=this.diffViewer.getRuntimeProps(),n=t.fileRefId||"",r=t.oldFileRefId||"";n||r?(a.log("MergeUIController: Using selected merge type for file-browser mode",null,2),this.mergeHandler.proceedWithMerge(this.getMergeType())):(a.log("MergeUIController: Using clipboard merge type for non-file-browser mode",null,2),this.mergeHandler.proceedWithMerge("clipboard"))}}},{key:"countUnresolvedConflicts",value:function(){var e=this.diffViewer.chunkManager.chunks.filter((function(e){return e.conflict})),t=this.diffViewer.chunkManager.selections||{};return e.length-Object.keys(t).length}},{key:"showConflictModal",value:function(e){var t=this,n=this.diffViewer.getConfig().translations||{},r=ht.formatUnresolvedCount(e,n);this.modalManager.open(k.MERGE.CONFLICT_MODAL.name()),setTimeout((function(){ce.showMessage(k.MODAL.MESSAGE.name(),r,"warning",{className:""}),a.log("MergeUIController: Showing conflict modal with message",null,2)}),50),setTimeout((function(){var e=document.getElementById(k.MODAL.CONTINUE_BTN.name()),n=document.getElementById(k.MODAL.MERGE_BTN.name());if(e){var r=e.cloneNode(!0);e.parentNode.replaceChild(r,e),r.addEventListener("click",(function(){a.log("MergeUIController: Continue button clicked",null,2),t.modalManager.close(k.MERGE.CONFLICT_MODAL.name());var e=k.MODAL.PREVIEW.name();a.log("MergeUIController: Closing preview modal (ID: ".concat(e,")"),null,2),t.modalManager.close(e),setTimeout((function(){t.highlightUnresolvedChunks()}),400)}))}if(n){var o=n.cloneNode(!0);n.parentNode.replaceChild(o,n),o.addEventListener("click",(function(){a.log("MergeUIController: Merge anyway button clicked",null,2),t.modalManager.close(k.MERGE.CONFLICT_MODAL.name()),t.mergeHandler.proceedWithMerge(t.getMergeType())}))}}),50)}},{key:"getMergeType",value:function(){var e;return(null===(e=this.mergeDestination)||void 0===e?void 0:e.value)||"original"}},{key:"highlightUnresolvedChunks",value:function(){a.log("MergeUIController: Finding first unresolved conflict",null,2);var e,t=this.diffViewer.chunkManager.chunks,n=this.diffViewer.chunkManager.selections||{},r=sr(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;if(o.conflict&&!n[o.id]){var i=t.indexOf(o);if(this.diffViewer.diffNavigator){this.diffViewer.diffNavigator.navigateToChunk(i);var l=document.querySelector('[data-chunk-id="'.concat(o.id,'"]'));return l&&lr.addHighlightEffect(l,4e3),a.log("MergeUIController: Highlighted unresolved chunk ".concat(o.id),null,2),!0}}}}catch(e){r.e(e)}finally{r.f()}return a.log("MergeUIController: No unresolved conflicts found",null,2),!1}},{key:"setupLocalOnlyControls",value:function(){var e=this;a.log("MergeUIController: Setting up local-only controls (server save disabled)",null,2),a.log("MergeUIController: Getting translations for local-only controls",this.translationManager,2);var t=this.translationManager.get("getMergedResult","Get Merged Result"),n=this.translationManager.get("getMergedResultTooltip","View and download the merged content"),r=document.querySelector(k.MERGE.CONTROLS_ACTIONS.toString());if(r){r.innerHTML="";var o=document.createElement("button");o.id=k.MERGE.GET_MERGED_RESULT_BTN.name(),o.className="".concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_PRIMARY.name()),o.title=n;var i=ce.getIconHtml("download",{classes:k.UTILITY.MARGIN_END_1.name()});o.innerHTML="".concat(i," ").concat(t);var l=document.createElement("div");l.className="".concat(k.UTILITY.FLEX.name()," ").concat(k.UTILITY.JUSTIFY_CONTENT_BETWEEN.name()," w-100"),l.style.width="100%";var c=document.createElement("div");c.style.flex="1",l.appendChild(c),l.appendChild(o),r.appendChild(l),o.addEventListener("click",(function(t){t.preventDefault(),e.mergeHandler.proceedWithMerge("clipboard"),a.log("MergeUIController: Get merged result button clicked (using clipboard merge type)",null,2)})),a.log("MergeUIController: Local-only controls setup complete",null,2)}else a.error("MergeUIController: Could not find merge controls container",null,1)}}],t&&fr(e.prototype,t),n&&fr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function gr(e){return gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gr(e)}function mr(){mr=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new N(r||[]);return o(a,"_invoke",{value:S(e,n,l)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",p={};function v(){}function y(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,T=E&&E(E(_([])));T&&T!==n&&r.call(T,a)&&(w=T);var I=b.prototype=v.prototype=Object.create(w);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,i,a,l){var c=f(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==gr(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,n,r){var o=d;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=k(l,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=f(t,n,r);if("normal"===s.type){if(o=r.done?m:h,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(gr(t)+" is not iterable")}return y.prototype=b,o(I,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},C(L.prototype),s(L.prototype,l,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new L(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(I),s(I,c,"Generator"),s(I,a,(function(){return this})),s(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}function pr(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function vr(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){pr(i,r,o,a,l,"next",e)}function l(e){pr(i,r,o,a,l,"throw",e)}a(void 0)}))}}function yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,br(r.key),r)}}function br(e){var t=function(e,t){if("object"!=gr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=gr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gr(t)?t:t+""}var wr=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mergeHandler=t,this.diffViewer=t.diffViewer},t=[{key:"proceedWithMerge",value:(o=vr(mr().mark((function e(t){var n,r,o,i,l,c,s,u,f,d,h,g,m,p,v,y,b,w,E;return mr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.log("MergeOperationHandler: Proceeding with merge",{mergeType:t},2),n=this.diffViewer.getRuntimeProps(),r=n.fileRefId||"",o=n.oldFileRefId||"","new"!==t&&"new-suffix"!==t||r?"old"!==t&&"old-suffix"!==t||o?"both"!==t&&"both-suffix"!==t||r&&o||(a.log("MergeOperationHandler: Switching to clipboard mode (missing file reference IDs)",null,2),t="clipboard"):(a.log("MergeOperationHandler: Switching to clipboard mode (no oldFileRefId available)",null,2),t="clipboard"):(a.log("MergeOperationHandler: Switching to clipboard mode (no fileRefId available)",null,2),t="clipboard"),i=H.getInstance(),l=i.get("loadingContent","Processing merge..."),c=Nt.getInstance(),s=c.showLoader(l,{fullscreen:!0,zIndex:1e3}),e.prev=9,u=this.diffViewer.chunkManager.generateMergedContent(),"clipboard"!==t){e.next=15;break}f={success:!0,message:i.get("mergeSuccessClipboard","Merge completed successfully. The merged content is ready.")},e.next=18;break;case 15:return e.next=17,this.applyMerge(u,t);case 17:f=e.sent;case 18:return c.hideLoader(s),f.success?(d=document.getElementById("vdm-merge__result"))&&(d.innerHTML="",d.classList.remove("vdm-d-none"),h=Q.getInstance(),g=h.showSuccess(f.message,{timeout:0,translate:!1}),d.appendChild(g),this.scrollToMergeResult()):(m=document.getElementById("vdm-merge__result"))&&(m.innerHTML="",m.classList.remove("vdm-d-none"),p=Q.getInstance(),v=p.showError(f.message||"An error occurred during the merge operation.",{timeout:0,translate:!1}),m.appendChild(v),this.scrollToMergeResult()),e.abrupt("return",f);case 23:return e.prev=23,e.t0=e.catch(9),c.hideLoader(s),a.error("MergeOperationHandler: Error in merge operation",e.t0,1),(y=document.getElementById("vdm-merge__result"))&&(y.innerHTML="",y.classList.remove("vdm-d-none"),b=Q.getInstance(),w="Error: ".concat(e.t0.message||"An unexpected error occurred during merge."),E=b.showError(w,{timeout:0,translate:!1}),y.appendChild(E)),e.abrupt("return",{success:!1,message:e.t0.message||"An unexpected error occurred during merge"});case 30:case"end":return e.stop()}}),e,this,[[9,23]])}))),function(e){return o.apply(this,arguments)})},{key:"applyMerge",value:(r=vr(mr().mark((function e(t,n){var r,o,i,l,c,s,u,f,d;return mr().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.diffViewer.getRuntimeProps(),o=r.fileRefId||"",i=r.oldFileRefId||"",a.log("MergeOperationHandler: File references for merge operation",{fileRefId:o,oldFileRefId:i,mergeType:n},2),("new"!==n&&"new-suffix"!==n||o)&&("old"!==n&&"old-suffix"!==n||i)&&("both"!==n&&"both-suffix"!==n||o&&i)){e.next=7;break}return a.log("MergeOperationHandler: Switching to clipboard mode in applyMerge (missing file references)",null,2),e.abrupt("return",{success:!0,message:H.getInstance().get("mergeSuccessClipboard","Merge completed successfully. The merged content is ready.")});case 7:if("new"!==n&&"new-suffix"!==n||o){e.next=12;break}return a.error("MergeOperationHandler: No file reference ID available for new file",null,1),e.abrupt("return",{success:!1,message:"No file reference ID available to save changes to new file"});case 12:if("old"!==n&&"old-suffix"!==n||i){e.next=17;break}return a.error("MergeOperationHandler: No file reference ID available for old file",null,1),e.abrupt("return",{success:!1,message:"No file reference ID available to save changes to old file"});case 17:if("both"!==n&&"both-suffix"!==n||o&&i){e.next=20;break}return a.error("MergeOperationHandler: Missing file reference IDs for both files",null,1),e.abrupt("return",{success:!1,message:"Missing file reference IDs to save changes to both files"});case 20:return l=JSON.stringify(this.diffViewer.chunkManager.selections),c=this.diffViewer.isContentBeautified()?1:0,e.prev=22,s={action:"registerMergedContent",content:t,selections:l,mergeType:n,wasBeautified:c},"new"!==n&&"new-suffix"!==n&&"both"!==n&&"both-suffix"!==n||(s.fileRefId=o),"old"!==n&&"old-suffix"!==n&&"both"!==n&&"both-suffix"!==n||(s.oldFileRefId=i),a.log("MergeOperationHandler: Form parameters for save request",s,2),e.next=29,this.diffViewer.getEndpoint("ajaxDiffMerge");case 29:return u=e.sent,a.log("MergeOperationHandler: Using endpoint",{endpoint:u},2),e.next=33,fetch(u,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(s)});case 33:return f=e.sent,e.next=36,f.json();case 36:return d=e.sent,a.log("MergeOperationHandler: API response",d,2),e.abrupt("return",d);case 41:return e.prev=41,e.t0=e.catch(22),a.error("MergeOperationHandler: Error applying merge:",e.t0,1),e.abrupt("return",{success:!1,message:"Error applying merge: ".concat(e.t0.message)});case 45:case"end":return e.stop()}}),e,this,[[22,41]])}))),function(e,t){return r.apply(this,arguments)})},{key:"scrollToMergeResult",value:function(){var e=document.getElementById("vdm-merge__result");e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),a.log("MergeOperationHandler: Scrolled to merge result",null,2))}}],t&&yr(e.prototype,t),n&&yr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o}();function Er(e){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Er(e)}function Tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ir(r.key),r)}}function Ir(e){var t=function(e,t){if("object"!=Er(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Er(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Er(t)?t:t+""}var Cr=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diffViewer=t,this.modalManager=this.diffViewer.modalManager,this.previewManager=new er(this),this.uiController=new hr(this),this.operationHandler=new wr(this),this.initialize(),a.log("MergeHandler: Component initialized",null,2)},(t=[{key:"initialize",value:function(){var e=this.diffViewer.getRuntimeProps(),t=e&&e.serverSaveEnabled;a.log("MergeHandler: Initializing with serverSaveEnabled=".concat(t),null,2),this.uiController.initialize(),!1===t&&(a.log("MergeHandler: Server save is disabled, using local-only controls",null,2),this.uiController.setupLocalOnlyControls()),this.previewManager.initialize(),a.log("MergeHandler: All subcomponents initialized",null,2)}},{key:"previewMerge",value:function(){this.previewManager.handlePreviewClick()}},{key:"getMergedContent",value:function(){return this.diffViewer.chunkManager.generateMergedContent()}},{key:"proceedWithMerge",value:function(e){return this.operationHandler.proceedWithMerge(e)}},{key:"countUnresolvedConflicts",value:function(){return this.uiController.countUnresolvedConflicts()}},{key:"showConflictModal",value:function(e){this.uiController.showConflictModal(e)}},{key:"highlightUnresolvedChunks",value:function(){return this.uiController.highlightUnresolvedChunks()}},{key:"createAlertElement",value:function(e,t,n){var r=Q.getInstance();return e?r.showSuccess(t,{timeout:0,translate:!1}):r.showWarning(n,{timeout:0,translate:!1})}}])&&Tr(e.prototype,t),n&&Tr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Lr(e){return Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lr(e)}function Sr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kr(r.key),r)}}function kr(e){var t=function(e,t){if("object"!=Lr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Lr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Lr(t)?t:t+""}var Mr=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.navigator=t,this.counterElement=null,this.prevButton=null,this.nextButton=null},(t=[{key:"setCounterElement",value:function(e){this.counterElement=e}},{key:"setButtons",value:function(e,t){this.prevButton=e,this.nextButton=t}},{key:"updateCounter",value:function(){var e=this;if(!this.counterElement)return[];var t=this.navigator.diffViewer.chunkManager.chunks,n=this.navigator.diffViewer.chunkManager.selections,r=0,o=0,i=[];if(t.forEach((function(e,t){e.conflict&&!n[e.id]&&(i.push(t),r++)})),this.navigator.currentChunkIndex>=0){var a=i.findIndex((function(t){return t>=e.navigator.currentChunkIndex}));-1!==a&&(o=a+1)}return 0===r?(this.counterElement.textContent="✓",this.counterElement.title="All conflicts resolved!"):(this.counterElement.textContent="".concat(o||1,"/").concat(r),this.counterElement.title="".concat(r," conflicts remaining")),this.prevButton&&this.nextButton&&(this.prevButton.disabled=0===r,this.nextButton.disabled=0===r),i}}])&&Sr(e.prototype,t),n&&Sr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Or(e){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(e)}function Nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_r(r.key),r)}}function _r(e){var t=function(e,t){if("object"!=Or(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Or(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Or(t)?t:t+""}var jr=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.navigator=t},(t=[{key:"createNavigationUI",value:function(){a.log("NavigationUIBuilder: Creating navigation UI",null,2);var e=document.querySelector(k.NAVIGATION.CONTAINER);if(e)a.log("NavigationUIBuilder: Using existing navigation container",null,2),e.innerHTML="",this._createControls(e);else{a.log("NavigationUIBuilder: No navigation container found, creating one",null,2);var t=document.querySelectorAll(k.DIFF.PANE);if(!t||0===t.length)return a.warn("NavigationUIBuilder: No diff panes found to append navigation container"),null;(e=document.createElement("div")).className=k.NAVIGATION.CONTAINER.name(),this._createControls(e),t[0].parentNode&&t[0].parentNode.insertBefore(e,t[0])}return{counter:document.getElementById(k.NAVIGATION.COUNTER.name()),prevButton:document.getElementById(k.NAVIGATION.PREV_BUTTON.name()),nextButton:document.getElementById(k.NAVIGATION.NEXT_BUTTON.name())}}},{key:"_createControls",value:function(e){var t=this,n=document.createElement("div");n.className=k.NAVIGATION.NAV_CHUNK.name();var r=document.createElement("span");r.id=k.NAVIGATION.COUNTER.name(),r.className=k.NAVIGATION.COUNTER_ELEMENT.name();var o=document.createElement("button");o.id=k.NAVIGATION.PREV_BUTTON.name(),o.classList.add(k.UTILITY.BUTTON.name(),k.UTILITY.BUTTON_FLAT.name(),k.UTILITY.BUTTON_SMALL.name()),o.innerHTML=ce.getIconHtml("chevron-up"),o.title="Previous change",o.addEventListener("click",(function(){return t.navigator.navigateToPrevConflict()}));var i=document.createElement("button");i.id=k.NAVIGATION.NEXT_BUTTON.name(),i.classList.add(k.UTILITY.BUTTON.name(),k.UTILITY.BUTTON_FLAT.name(),k.UTILITY.BUTTON_SMALL.name()),i.innerHTML=ce.getIconHtml("chevron-down"),i.title="Next change",i.addEventListener("click",(function(){return t.navigator.navigateToNextConflict()})),n.appendChild(o),n.appendChild(r),n.appendChild(i),e.appendChild(n),a.log("NavigationUIBuilder: Navigation controls created",null,2)}},{key:"destroy",value:function(){var e=document.getElementById(k.NAVIGATION.PREV_BUTTON.name()),t=document.getElementById(k.NAVIGATION.NEXT_BUTTON.name());if(e){var n=e.cloneNode(!0);e.parentNode.replaceChild(n,e)}if(t){var r=t.cloneNode(!0);t.parentNode.replaceChild(r,t)}a.log("NavigationUIBuilder: Event handlers removed",null,2)}}])&&Nr(e.prototype,t),n&&Nr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function xr(e){return xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xr(e)}function Ar(e){return function(e){if(Array.isArray(e))return Pr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Dr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dr(e,t){if(e){if("string"==typeof e)return Pr(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pr(e,t):void 0}}function Pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ur(r.key),r)}}function Ur(e){var t=function(e,t){if("object"!=xr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=xr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xr(t)?t:t+""}var Fr=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.navigator=t,this.diffViewer=t.diffViewer},t=[{key:"_getUnresolvedChunkInfo",value:function(){var e=Array.from(document.querySelectorAll('[data-chunk-id]:not([data-chunk-id=""])')).filter((function(e){return e.classList.contains(k.STATUS.UNRESOLVED.name())}));if(0===e.length)return a.log("ConflictNavigator: No unresolved elements found",null,2),{unresolvedChunkIds:[],count:0};var t=Ar(new Set(e.map((function(e){return e.getAttribute("data-chunk-id")}))));return a.log("ConflictNavigator: Found ".concat(t.length," unresolved chunks"),null,3),{unresolvedChunkIds:t,count:t.length}}},{key:"navigateToFirstConflict",value:function(){var e=this._getUnresolvedChunkInfo(),t=e.unresolvedChunkIds;if(0===e.count)return a.log("ConflictNavigator: No unresolved chunks found",null,2),!1;var n=this.diffViewer.chunkManager.chunks.findIndex((function(e){return t.includes(String(e.id))}));return n>=0?(a.log("ConflictNavigator: Navigating to first unresolved chunk at index ".concat(n),null,2),this.navigator.navigateToChunk(n)):(a.log("ConflictNavigator: No matching chunk found",null,2),!1)}},{key:"navigateToNextConflict",value:function(){var e=this.navigator.currentChunkIndex;a.log("ConflictNavigator: Current chunk index is ".concat(e),null,3);var t=this._getUnresolvedChunkInfo(),n=t.unresolvedChunkIds;if(0===t.count)return a.log("ConflictNavigator: No unresolved chunks found",null,2),!1;var r=this.diffViewer.chunkManager.chunks,o=this._findNextChunkIndex(r,n,e);return o>=0?(a.log("ConflictNavigator: Navigating to next unresolved chunk at index ".concat(o),null,2),this.navigator.navigateToChunk(o)):(a.log("ConflictNavigator: No matching chunk found",null,2),!1)}},{key:"_findNextChunkIndex",value:function(e,t,n){var r=this._createChunkIndexMap(e,t);if(0===r.size)return-1;var o,i=Array.from(r.values()).sort((function(e,t){return e-t})),a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Dr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}(i);try{for(a.s();!(o=a.n()).done;){var l=o.value;if(l>n)return l}}catch(e){a.e(e)}finally{a.f()}return i[0]}},{key:"navigateToPrevConflict",value:function(){var e=this.navigator.currentChunkIndex,t=this._getUnresolvedChunkInfo(),n=t.unresolvedChunkIds;if(0===t.count)return a.log("ConflictNavigator: No unresolved chunks found",null,2),!1;var r=this.diffViewer.chunkManager.chunks,o=this._findPrevChunkIndex(r,n,e);return o>=0?(a.log("ConflictNavigator: Navigating to previous unresolved chunk at index ".concat(o),null,2),this.navigator.navigateToChunk(o)):(a.log("ConflictNavigator: No matching chunk found",null,2),!1)}},{key:"_findPrevChunkIndex",value:function(e,t,n){var r=this._createChunkIndexMap(e,t);if(0===r.size)return-1;for(var o=Array.from(r.values()).sort((function(e,t){return e-t})),i=o.length-1;i>=0;i--)if(o[i]<n)return o[i];return o[o.length-1]}},{key:"_createChunkIndexMap",value:function(e,t){var n=new Map;return e.forEach((function(e,r){e&&e.id&&t.includes(String(e.id))&&n.set(String(e.id),r)})),n}},{key:"navigateToChunk",value:function(e){this.navigator.currentChunkIndex=e;var t=this.diffViewer.chunkManager.chunkElements[e];if(!t)return a.warn("ConflictNavigator: Cannot scroll - chunk ".concat(e," not found"),null,2),!1;a.log("ConflictNavigator: Navigating to chunk ".concat(e),null,2);var n=t.closest(k.DIFF.PANE_CONTENT);return n?(lr.scrollElementIntoView(t,n),lr.addHighlightEffect(t,2e3),this.navigator.navigationCounter.updateCounter(),a.log("ConflictNavigator: Navigation complete",null,2),!0):(a.warn("ConflictNavigator: Cannot navigate - chunk ".concat(e," parent not found"),null,2),!1)}}],t&&Rr(e.prototype,t),n&&Rr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Br(e){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Br(e)}function Hr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vr(r.key),r)}}function Vr(e){var t=function(e,t){if("object"!=Br(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Br(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Br(t)?t:t+""}var Gr=function(){return e=function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diffViewer=t,this.currentChunkIndex=-1,this.diffViewer&&this.diffViewer.chunkManager?(this.navigationCounter=new Mr(this),this.uiBuilder=new jr(this),this.conflictNavigator=new Fr(this),n&&this.initNavigation(),a.log("DiffNavigator: Component created",null,2)):a.error("DiffNavigator: Failed to initialize - diffViewer or chunkManager is missing",null,1)},t=[{key:"initNavigation",value:function(){var e;if(a.log("DiffNavigator: Initializing",null,2),!this.diffViewer.chunkManager.chunks||0===this.diffViewer.chunkManager.chunks.length)return a.warn("DiffNavigator: No diff chunks found in configuration",{configChunks:this.diffViewer.chunkManager.chunks,diffConfig:this.diffViewer.diffConfig},1),void this.addNavigationButtons(!0);this.addNavigationButtons(),this.setupKeyboardShortcuts(),this.navigateToFirstConflict(),a.log("DiffNavigator: Initialized with chunk navigation",{chunks:(null===(e=this.diffViewer.chunkManager.chunks)||void 0===e?void 0:e.length)||0},2)}},{key:"addNavigationButtons",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.uiBuilder.createNavigationUI();t&&(this.navigationCounter.setCounterElement(t.counter),this.navigationCounter.setButtons(t.prevButton,t.nextButton),e?(t.prevButton.disabled=!0,t.nextButton.disabled=!0,t.counter.textContent="No diff data"):this.updateCounter())}},{key:"setupKeyboardShortcuts",value:function(){var e=this;document.addEventListener("keydown",(function(t){if("INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName)switch(t.key){case"ArrowDown":(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.navigateToNextConflict());break;case"ArrowUp":(t.ctrlKey||t.metaKey)&&(t.preventDefault(),e.navigateToPrevConflict())}}))}},{key:"updateCounter",value:function(){return this.navigationCounter.updateCounter()}},{key:"navigateToFirstConflict",value:function(){return this.diffViewer.chunkManager.chunks&&0!==this.diffViewer.chunkManager.chunks.length?this.conflictNavigator.navigateToFirstConflict():(a.warn("DiffNavigator: Cannot navigate - no chunks available",null,2),!1)}},{key:"navigateToNextConflict",value:function(){return this.diffViewer.chunkManager.chunks&&0!==this.diffViewer.chunkManager.chunks.length?this.conflictNavigator.navigateToNextConflict():(a.warn("DiffNavigator: Cannot navigate - no chunks available",null,2),!1)}},{key:"navigateToPrevConflict",value:function(){return this.diffViewer.chunkManager.chunks&&0!==this.diffViewer.chunkManager.chunks.length?this.conflictNavigator.navigateToPrevConflict():(a.warn("DiffNavigator: Cannot navigate - no chunks available",null,2),!1)}},{key:"navigateToChunk",value:function(e){return this.diffViewer.chunkManager.chunks&&0!==this.diffViewer.chunkManager.chunks.length?this.conflictNavigator.navigateToChunk(e):(a.warn("DiffNavigator: Cannot navigate - no chunks available",null,2),!1)}},{key:"destroy",value:function(){this.uiBuilder.destroy(),a.log("DiffNavigator: Destroyed",null,2)}}],t&&Hr(e.prototype,t),n&&Hr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function zr(e){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zr(e)}function Yr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Wr(r.key),r)}}function Wr(e){var t=function(e,t){if("object"!=zr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=zr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==zr(t)?t:t+""}var qr=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diffViewer=t,this.isSyncing=!1},(t=[{key:"setupSynchronizedScrolling",value:function(){var e=this,t=this.diffViewer.container.querySelectorAll(k.DIFF.PANE);if(2===t.length){var n=t[0],r=t[1],o=n.querySelector(k.DIFF.PANE_CONTENT),i=r.querySelector(k.DIFF.PANE_CONTENT);o&&i?(this.leftContent=o,this.rightContent=i,o.addEventListener("scroll",(function(){return e._handleScroll(o,i)}),{passive:!0}),i.addEventListener("scroll",(function(){return e._handleScroll(i,o)}),{passive:!0}),window.addEventListener("resize",(function(){e._updateScrollState(o),e._updateScrollState(i)})),a.log("ScrollSynchronizer: Horizontal and vertical scroll synchronization set up",null,2)):a.log("ScrollSynchronizer: Could not find all required scrolling elements",null,2)}else a.log("ScrollSynchronizer: Could not find both diff panes. Found: ".concat(t.length),null,2)}},{key:"_handleScroll",value:function(e,t){var n=this;this.isSyncing||(this.isSyncing=!0,t.scrollTop=e.scrollTop,t.scrollLeft=e.scrollLeft,this._updateScrollState(e),setTimeout((function(){n.isSyncing=!1}),10))}},{key:"_updateScrollState",value:function(e){var t=e.classList.contains(k.STATUS.SCROLLED.name()),n=e.scrollLeft>0;t!==n&&(n?e.classList.add(k.STATUS.SCROLLED.name()):e.classList.remove(k.STATUS.SCROLLED.name()))}}])&&Yr(e.prototype,t),n&&Yr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Kr(e){return Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kr(e)}function Xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Jr(r.key),r)}}function Jr(e){var t=function(e,t){if("object"!=Kr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Kr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Kr(t)?t:t+""}var $r=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diffViewer=t},(t=[{key:"initializeIconMarkers",value:function(){var e=this,t=this._calculateCellHeight();document.documentElement.style.setProperty("--cell-height","".concat(t,"px")),this.diffViewer.container.querySelectorAll(k.DIFF.PANE).forEach((function(t){e._setupIconColumn(t)})),this._updateIconColumnHeights(),this._setupIconHeightUpdater()}},{key:"_setupIconColumn",value:function(e){var t=this,n=e.querySelector(k.DIFF.PANE_CONTENT);if(n){var r=n.querySelector(k.DIFF.TABLE_WRAPPER);if(r){var o=e.querySelector(":scope > ".concat(k.ICONS.COLUMN));o||((o=document.createElement("div")).className=k.ICONS.COLUMN.name(),e.appendChild(o));var i=n.querySelectorAll("".concat(k.DIFF.LINE_CONTENT,'[data-chunk-id]:not([data-chunk-id=""]), ')+"".concat(k.DIFF.LINE_PLACEHOLDER,'[data-chunk-id]:not([data-chunk-id=""]), ')+"".concat(k.DIFF.LINE_CONTENT_EMPTY,'[data-chunk-id]:not([data-chunk-id=""])')),l={};if(i.forEach((function(e){var t=e.dataset.chunkId;l[t]||(l[t]=[]),l[t].push(e)})),Object.keys(l).forEach((function(e){l[e].sort((function(e,t){return parseInt(e.dataset.lineId.split("-").pop(),10)-parseInt(t.dataset.lineId.split("-").pop(),10)}));var n=l[e][0];n&&t._createIconMarker(n,o)})),r){var c=r.scrollHeight;e.dataset.tableHeight=c}n.addEventListener("scroll",(function(){requestAnimationFrame((function(){o.style.transform="translateY(-".concat(n.scrollTop,"px)")})),n.scrollLeft>0?e.classList.add(k.STATUS.SCROLLED.name()):e.classList.remove(k.STATUS.SCROLLED.name())}),{passive:!0}),o.style.transform="translateY(-".concat(n.scrollTop,"px)")}else a.warn("IconMarkerManager: Code table wrapper not found",null,2)}}},{key:"_createIconMarker",value:function(e,t){var n=e.dataset.lineId;if(n){var r=t.querySelector("".concat(k.ICONS.MARKER,'[data-line-id="').concat(n,'"]'));if(!r){(r=document.createElement("div")).className=k.ICONS.MARKER.name(),e.classList.contains(k.DIFF.LINE_PLACEHOLDER.name())&&r.classList.add(k.ICONS.MARKER_PLACEHOLDER.name()),r.dataset.lineId=n;var o=n.split("-").pop();r.dataset.iconIndex=o,r.style.setProperty("--icon-index",o),t.appendChild(r)}}}},{key:"_calculateCellHeight",value:function(){var e=this.diffViewer.container.querySelectorAll(k.CODE.LINE_NUMBER);if(!e||0===e.length)return a.log("IconMarkerManager: No line number cells found, using default height",null,2),20.5;for(var t=[],n=Math.min(5,e.length),r=0;r<n;r++)t.push(e[r].getBoundingClientRect().height);t.sort((function(e,t){return e-t}));var o=t[Math.floor(t.length/2)];return a.log("IconMarkerManager: Sampled heights: ".concat(t.join(", "),", using median: ").concat(o,"px"),null,3),o}},{key:"_setupIconHeightUpdater",value:function(){var e,t=this;window.addEventListener("resize",(function(){clearTimeout(e),e=setTimeout((function(){t._updateIconColumnHeights()}),100)})),this._updateIconColumnHeights()}},{key:"_updateIconColumnHeights",value:function(){var e=this.diffViewer.container.querySelectorAll(k.DIFF.PANE),t={};e.forEach((function(e){var n=e.querySelector(k.DIFF.PANE_CONTENT),r=e.querySelector(k.ICONS.COLUMN),o=null==n?void 0:n.querySelector(k.DIFF.TABLE_WRAPPER);if(r&&o){var i=o.scrollHeight,a=parseInt(r.style.height)||0;Math.abs(a-i)>5&&(r.style.height="".concat(i,"px"),t[e.dataset.side||"pane"]=i)}})),Object.keys(t).length>0&&a.log("IconMarkerManager: Updated icon column heights:",t,3)}}])&&Xr(e.prototype,t),n&&Xr(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function Zr(e){return Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zr(e)}function Qr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return eo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function to(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,no(r.key),r)}}function no(e){var t=function(e,t){if("object"!=Zr(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Zr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Zr(t)?t:t+""}var ro=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diffViewer=t,this.paneWidth=0},(t=[{key:"initialize",value:function(){var e=this;this.updatePaneWidth(),window.addEventListener("resize",(function(){e.updatePaneWidth()})),this.setupWidthObserver(),a.log("LayoutManager: Initialized",null,2)}},{key:"updatePaneWidth",value:function(){var e=ce.getElements(k.DIFF.PANE,this.diffViewer.container);if(e&&0!==e.length){var t=e[0].clientWidth;t!==this.paneWidth&&(this.paneWidth=t,this.setCSSVariable("--diff-pane-width","".concat(this.paneWidth,"px")),a.log("LayoutManager: Updated pane width: ".concat(this.paneWidth,"px"),null,3))}}},{key:"setCSSVariable",value:function(e,t){document.documentElement.style.setProperty(e,t)}},{key:"setupWidthObserver",value:function(){var e=this,t=new MutationObserver((function(t){var n,r=!1,o=Qr(t);try{for(o.s();!(n=o.n()).done;){var i=n.value;if("childList"===i.type||"attributes"===i.type&&("style"===i.attributeName||"class"===i.attributeName)){r=!0;break}}}catch(e){o.e(e)}finally{o.f()}r&&e.updatePaneWidth()}));t.observe(this.diffViewer.container,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class"]}),this.observer=t,a.log("LayoutManager: Width observer setup complete",null,2)}},{key:"destroy",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),a.log("LayoutManager: Destroyed",null,2)}}])&&to(e.prototype,t),n&&to(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function oo(e){return oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oo(e)}function io(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ao(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?io(Object(n),!0).forEach((function(t){lo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):io(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lo(e,t,n){return(t=ho(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function co(){co=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new N(r||[]);return o(a,"_invoke",{value:S(e,n,l)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",p={};function v(){}function y(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,T=E&&E(E(_([])));T&&T!==n&&r.call(T,a)&&(w=T);var I=b.prototype=v.prototype=Object.create(w);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,i,a,l){var c=f(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==oo(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,n,r){var o=d;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=k(l,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=f(t,n,r);if("normal"===s.type){if(o=r.done?m:h,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(oo(t)+" is not iterable")}return y.prototype=b,o(I,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},C(L.prototype),s(L.prototype,l,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new L(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(I),s(I,c,"Generator"),s(I,a,(function(){return this})),s(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}function so(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function uo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){so(i,r,o,a,l,"next",e)}function l(e){so(i,r,o,a,l,"throw",e)}a(void 0)}))}}function fo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ho(r.key),r)}}function ho(e){var t=function(e,t){if("object"!=oo(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=oo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==oo(t)?t:t+""}var go=function(){return e=function e(){var t,n,r,o,i,l,c,s,u,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=de.mergeConfigurations({lang:"en",debug:!1,logLevel:2,theme:{defaultFamily:"atom-one",defaultMode:"dark",showSelector:!0},apiEndpoint:null},window.diffConfig||{},f),this.runtimeProps={diffData:f.diffData||(null===(t=window.diffConfig)||void 0===t?void 0:t.diffData)||null,serverSaveEnabled:f.serverSaveEnabled||(null===(n=window.diffConfig)||void 0===n?void 0:n.serverSaveEnabled)||!1,fileRefId:f.fileRefId||(null===(r=window.diffConfig)||void 0===r?void 0:r.fileRefId)||"",oldFileRefId:f.oldFileRefId||(null===(o=window.diffConfig)||void 0===o?void 0:o.oldFileRefId)||"",newFileName:f.newFileName||(null===(i=window.diffConfig)||void 0===i?void 0:i.newFileName)||"",oldFileName:f.oldFileName||(null===(l=window.diffConfig)||void 0===l?void 0:l.oldFileName)||"",isIdentical:f.isIdentical||(null===(c=window.diffConfig)||void 0===c?void 0:c.isIdentical)||!1,filepath:f.filepath||(null===(s=window.diffConfig)||void 0===s?void 0:s.filepath)||null,demoEnabled:f.demoEnabled||(null===(u=window.diffConfig)||void 0===u?void 0:u.demoEnabled)||!1},this.mainLoaderId=f.mainLoaderId||null,a.initialize(this.config.debug,"[DiffViewer]",this.config.logLevel||2);var d=H.getInstance();if(!d.isInitialized()&&this.config.translations?(a.log("DiffViewer: Initializing TranslationManager",{lang:this.config.lang||"en",translations:this.config.translations},2),d.initialize(this.config.lang||"en",this.config.translations)):a.log("DiffViewer: TranslationManager already initialized",null,2),this.container=document.querySelector(k.DIFF.VIEWER),!this.container)throw a.error("DiffViewer: Container element not found",null,2),new Error("Container element not found");if(!this.runtimeProps.diffData)throw a.error("DiffViewer: No diff data provided",null,2),new Error("No diff data provided");a.log("DiffViewer: Initializing component",null,2),this._initializeServices(),this._createComponents(),a.log("DiffViewer: Component created",null,2)},t=[{key:"_initializeServices",value:function(){this.resourceLoader=T.getInstance(),this.themeManager=Je.getInstance(),this.themeSelector=it.getInstance(this),this.modalManager=Wn.getInstance({debug:this.config.debug,translations:this.config.translations}),this.themeManager.initialize({theme:this.config.theme},this.resourceLoader)}},{key:"_createComponents",value:function(){this.syntaxHighlighter=new Rt(this),this.chunkManager=new On(this),this.themeToggle=new xn(this.browserUIManager,k.THEME.TOGGLE.name(),k.CONTAINER.WRAPPER.name()),this.mergeHandler=new Cr(this),this.diffNavigator=new Gr(this,!1),this.scrollSynchronizer=new qr(this),this.iconMarkerManager=new $r(this),this.layoutManager=new ro(this)}},{key:"initialize",value:(s=uo(co().mark((function e(){return co().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.log("DiffViewer: Beginning initialization",null,2),e.prev=1,e.next=4,this._initializeData();case 4:return e.next=6,this._loadResources();case 6:return e.next=8,this._renderUI();case 8:return e.next=10,this._setupUIFeatures();case 10:return this.runtimeProps.demoEnabled&&this._showDemoModeWarning(),this.modalManager.initModals(),a.log("DiffViewer: Initialization complete",null,2),e.abrupt("return",!0);case 16:throw e.prev=16,e.t0=e.catch(1),a.error("DiffViewer: Error during initialization:",e.t0,2),this._handleInitializationError(e.t0),e.t0;case 21:case"end":return e.stop()}}),e,this,[[1,16]])}))),function(){return s.apply(this,arguments)})},{key:"_handleInitializationError",value:function(e){a.error("DiffViewer: Error handling initialization failure",e,2);var t=H.getInstance().get("errorLoadingDiff")||"Error Loading Diff Viewer",n=document.createElement("div");n.className="".concat(k.UTILITY.ALERT_DANGER.name()," vdm-m-3"),n.innerHTML="\n            <h4>".concat(t,"</h4>\n            <p>").concat(e.message||"An unexpected error occurred.","</p>\n        "),this.container&&(this.container.appendChild(n),this.container.style.display="flex")}},{key:"_initializeData",value:(c=uo(co().mark((function e(){var t,n,r;return co().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.chunkManager.initChunks(this.runtimeProps.diffData),a.log("DiffViewer: Loaded ".concat((null===(t=this.runtimeProps.diffData.chunks)||void 0===t?void 0:t.length)||0," chunks and content arrays: old=").concat((null===(n=this.runtimeProps.diffData.old)||void 0===n?void 0:n.length)||0,", new=").concat((null===(r=this.runtimeProps.diffData.new)||void 0===r?void 0:r.length)||0),null,2);case 2:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"_loadResources",value:(l=uo(co().mark((function e(){var t;return co().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.syntaxHighlighter.highlightJsLoaded){e.next=5;break}return e.next=3,this.syntaxHighlighter.initialize();case 3:return e.next=5,this.syntaxHighlighter.loadHighlightJs();case 5:return t=this.themeManager.getCurrentTheme(),e.next=8,this.themeManager.applyTheme(t.family,t.mode);case 8:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"_renderUI",value:(i=uo(co().mark((function e(){var t,n,r,o,i,l;return co().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.container&&(this.container.style.display="flex"),a.log("DiffViewer: Rendering ".concat((null===(t=this.runtimeProps.diffData.chunks)||void 0===t?void 0:t.length)||0," chunks"),null,2),this.chunkManager.renderChunks(),this.syntaxHighlighter.highlightAll(this.container),this.themeToggle.initialize(),this.config.theme.showSelector&&this.themeSelector.initialize(),ce.toggleClass(k.DIFF.CONTAINER.name(),"loaded",!0),null!=(o=document.querySelector(k.CONTAINER.WRAPPER))&&o.classList.contains("vdm-d-none")&&o.classList.remove("vdm-d-none"),i=document.querySelector(k.THEME.SWITCHER),null==(l=document.querySelector(k.DIFF.CONTAINER))||null===(n=l.parentNode)||void 0===n||null===(r=n.insertBefore)||void 0===r||r.call(n,i,l),i&&l&&a.log("DiffViewer: Repositioned theme switcher above diff container",null,2);case 13:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"_setupUIFeatures",value:(o=uo(co().mark((function e(){var t;return co().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.scrollSynchronizer.setupSynchronizedScrolling(),this.layoutManager.initialize(),this.iconMarkerManager.initializeIconMarkers(),this.diffNavigator&&(a.log("DiffViewer: Initializing navigation with loaded chunks",null,2),this.diffNavigator.initNavigation()),t=new CustomEvent("vdm-diff-loaded",{detail:{timestamp:new Date,viewer:this}}),document.dispatchEvent(t),a.log("DiffViewer: Dispatched vdm-diff-loaded event",null,2),a.log("DiffViewer: UI features and enhancements set up",null,2);case 8:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_showDemoModeWarning",value:function(){var e;a.log("DiffViewer: Showing demo mode warning",null,2);var t=window.AlertManager||(null===(e=this.browserUIManager)||void 0===e?void 0:e.AlertManager);if(t){var n=t.getInstance(),r=document.querySelector("#vdm-file-comparison-form");n.showAlert("<strong>Demo Mode Active</strong> - Merging is disabled on this server and will be simulated.\n                To use the file browser with actual file modifications, please install Visual Diff Merge on your own server.","warning",{dismissable:!0,className:"vdm-mb-3",translate:!1,targetElement:r,placement:"before",timeout:0}),a.log("DiffViewer: Demo mode warning displayed via AlertManager",null,2)}}},{key:"updateConfig",value:function(e){e&&(this.config=de.mergeConfigurations(this.config,e),a.log("DiffViewer: Configuration updated",e,3))}},{key:"updateRuntimeProps",value:function(e){e&&(this.runtimeProps=ao(ao({},this.runtimeProps),e),a.log("DiffViewer: Runtime properties updated",e,3))}},{key:"getConfig",value:function(){return ao({},this.config)}},{key:"getRuntimeProps",value:function(){var e,t,n,r;return a.log("DiffViewer.getRuntimeProps called",{fileRefId:this.runtimeProps.fileRefId||"(none)",oldFileRefId:this.runtimeProps.oldFileRefId||"(none)",newFileName:this.runtimeProps.newFileName||"(none)",oldFileName:this.runtimeProps.oldFileName||"(none)",windowDiffConfig:{hasFileRefId:window.diffConfig&&"fileRefId"in window.diffConfig,fileRefId:(null===(e=window.diffConfig)||void 0===e?void 0:e.fileRefId)||"(none)",hasOldFileRefId:window.diffConfig&&"oldFileRefId"in window.diffConfig,oldFileRefId:(null===(t=window.diffConfig)||void 0===t?void 0:t.oldFileRefId)||"(none)",hasNewFileName:window.diffConfig&&"newFileName"in window.diffConfig,newFileName:(null===(n=window.diffConfig)||void 0===n?void 0:n.newFileName)||"(none)",hasOldFileName:window.diffConfig&&"oldFileName"in window.diffConfig,oldFileName:(null===(r=window.diffConfig)||void 0===r?void 0:r.oldFileName)||"(none)"}},3),ao({},this.runtimeProps)}},{key:"destroy",value:function(){this.layoutManager&&this.layoutManager.destroy(),this.diffNavigator&&this.diffNavigator.destroy(),ce.toggleClass(k.DIFF.CONTAINER.name(),"loaded",!1),a.log("DiffViewer: Component destroyed",null,2)}},{key:"initializeRuntimeProps",value:function(){var e,t,n,r,o,i;this.runtimeProps={diffData:this.options.diffData||{},serverSaveEnabled:this.options.serverSaveEnabled||!1,fileRefId:this.options.fileRefId||(null===(e=window.diffConfig)||void 0===e?void 0:e.fileRefId)||"",oldFileRefId:this.options.oldFileRefId||(null===(t=window.diffConfig)||void 0===t?void 0:t.oldFileRefId)||"",newFileName:this.options.newFileName||(null===(n=window.diffConfig)||void 0===n?void 0:n.newFileName)||"",oldFileName:this.options.oldFileName||(null===(r=window.diffConfig)||void 0===r?void 0:r.oldFileName)||"",isIdentical:this.options.isIdentical||(null===(o=window.diffConfig)||void 0===o?void 0:o.isIdentical)||!1,filepath:this.options.filepath||(null===(i=window.diffConfig)||void 0===i?void 0:i.filepath)||""},a.log("DiffViewer: Runtime properties initialized",this.runtimeProps,3)}},{key:"isContentBeautified",value:function(){return this.runtimeProps.isBeautified||!1}},{key:"getEndpoint",value:(r=uo(co().mark((function e(t){var n,r,o,i;return co().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.log("DiffViewer: Getting endpoint for ".concat(t),null,2),e.prev=1,n=xe.getInstance(),e.next=5,n.getEndpoint(t);case 5:return r=e.sent,a.log("DiffViewer: Found endpoint for ".concat(t),r,2),e.abrupt("return",r);case 10:if(e.prev=10,e.t0=e.catch(1),a.warn("DiffViewer: Error getting endpoint for ".concat(t,", using fallback"),e.t0,1),null===(o=this.config)||void 0===o||!o.apiEndpoints[t]){e.next=15;break}return e.abrupt("return",this.config.apiEndpoints[t]);case 15:return i={ajaxDiffMerge:"../api/ajax-diff-merge.php",diffProcessor:"../api/diff-processor.php"},e.abrupt("return",i[t]||"../api/"+t+".php");case 17:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(e){return r.apply(this,arguments)})},{key:"setBrowserUIManager",value:function(e){return this.browserUIManager=e,this.themeToggle&&this.themeToggle.setBrowserUIManager(e),this.themeSelector&&this.themeSelector.setBrowserUIManager(e),a.log("DiffViewer: BrowserUIManager reference set",null,2),this}}],t&&fo(e.prototype,t),n&&fo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,l,c,s}();const mo=JSON.parse('{"a11y":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/a11y-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/a11y-light.min.css"},"atom-one":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/atom-one-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/atom-one-light.min.css"},"gradient":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/gradient-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/gradient-light.min.css"},"isbl-editor":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/isbl-editor-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/isbl-editor-light.min.css"},"kimbie":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/kimbie-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/kimbie-light.min.css"},"nnfx":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/nnfx-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/nnfx-light.min.css"},"panda-syntax":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/panda-syntax-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/panda-syntax-light.min.css"},"paraiso":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/paraiso-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/paraiso-light.min.css"},"qtcreator":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/qtcreator-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/qtcreator-light.min.css"},"stackoverflow":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/stackoverflow-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/stackoverflow-light.min.css"},"tokyo-night":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/tokyo-night-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/tokyo-night-light.min.css"},"rose-pine":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/rose-pine-moon.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/rose-pine-dawn.min.css"},"atelier-cave":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-cave.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-cave-light.min.css"},"atelier-dune":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-dune.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-dune-light.min.css"},"atelier-estuary":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-estuary.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-estuary-light.min.css"},"atelier-forest":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-forest.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-forest-light.min.css"},"atelier-heath":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-heath.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-heath-light.min.css"},"atelier-lakeside":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-lakeside.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-lakeside-light.min.css"},"atelier-plateau":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-plateau.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-plateau-light.min.css"},"atelier-savanna":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-savanna.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-savanna-light.min.css"},"atelier-seaside":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-seaside.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-seaside-light.min.css"},"atelier-sulphurpool":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-sulphurpool.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/atelier-sulphurpool-light.min.css"},"brush-trees":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/brush-trees-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/brush-trees.min.css"},"classic":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/classic-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/classic-light.min.css"},"default-base16":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/default-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/default-light.min.css"},"edge":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/edge-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/edge-light.min.css"},"equilibrium":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/equilibrium-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/equilibrium-light.min.css"},"equilibrium-gray":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/equilibrium-gray-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/equilibrium-gray-light.min.css"},"eva":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/eva-dim.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/eva.min.css"},"google":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/google-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/google-light.min.css"},"grayscale-base16":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/grayscale-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/grayscale-light.min.css"},"gruvbox-hard":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/gruvbox-dark-hard.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/gruvbox-light-hard.min.css"},"gruvbox-medium":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/gruvbox-dark-medium.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/gruvbox-light-medium.min.css"},"gruvbox-soft":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/gruvbox-dark-soft.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/gruvbox-light-soft.min.css"},"harmonic16":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/harmonic16-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/harmonic16-light.min.css"},"heetch":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/heetch-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/heetch-light.min.css"},"horizon":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/horizon-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/horizon-light.min.css"},"humanoid":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/humanoid-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/humanoid-light.min.css"},"ia":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/ia-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/ia-light.min.css"},"material":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/material-darker.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/material-lighter.min.css"},"one":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/onedark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/one-light.min.css"},"papercolor":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/papercolor-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/papercolor-light.min.css"},"solar-flare":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/solar-flare.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/solar-flare-light.min.css"},"solarized":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/solarized-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/solarized-light.min.css"},"summerfruit":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/summerfruit-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/summerfruit-light.min.css"},"synth-midnight-terminal":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/synth-midnight-terminal-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/synth-midnight-terminal-light.min.css"},"tomorrow":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/tomorrow-night.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/tomorrow.min.css"},"unikitty":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/unikitty-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/unikitty-light.min.css"},"windows-10":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/windows-10.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/windows-10-light.min.css"},"windows-95":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/windows-95.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/windows-95-light.min.css"},"windows-high-contrast":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/windows-high-contrast.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/windows-high-contrast-light.min.css"},"windows-nt":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/windows-nt.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/windows-nt-light.min.css"},"ros-pine-base16":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/ros-pine-moon.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/ros-pine-dawn.min.css"},"silk":{"dark":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/silk-dark.min.css","light":"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/base16/silk-light.min.css"}}');function po(e){return po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},po(e)}function vo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yo(r.key),r)}}function yo(e){var t=function(e,t){if("object"!=po(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=po(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==po(t)?t:t+""}var bo=function(){return e=function e(t){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.options?(this.diffViewer=t,this.options=t.options):(this.diffViewer=null,this.options=t||{}),this.container=null,this.elements={themeSwitcher:null,diffContainer:null,mergeControls:null},this.translationManager=H.getInstance();var i=!(null===(n=window.diffConfig)||void 0===n||!n.translations),l=!(null===(r=this.options)||void 0===r||!r.translations);o=this.translationManager.isInitialized()?"TranslationManager":i?"window.diffConfig":l?"options":"none";var c=this.translationManager.getLanguage();a.log('BrowserUIManager: Created with "'.concat(c,'" translations from ').concat(o),this.translationManager.getAllTranslations(),2)},t=[{key:"setDiffViewer",value:function(e){return!(!e||!e.options||(this.diffViewer=e,this.options=e.options,a.log("BrowserUIManager: Updated DiffViewer reference",null,3),0))}},{key:"getTranslations",value:function(){var e,t;return this.translationManager&&this.translationManager.isInitialized()?(a.log("BrowserUIManager: Using translations from TranslationManager",this.translationManager.getAllTranslations(),3),this.translationManager.getAllTranslations()):null!==(e=window.diffConfig)&&void 0!==e&&e.translations&&"object"===po(window.diffConfig.translations)?(a.log("BrowserUIManager: Auto-initializing TranslationManager from window.diffConfig",window.diffConfig.translations,3),this.translationManager.initialize(window.diffConfig.lang||"en",window.diffConfig.translations),this.translationManager.getAllTranslations()):null!==(t=this.options)&&void 0!==t&&t.translations&&"object"===po(this.options.translations)?(a.log("BrowserUIManager: Using translations from local options",this.options.translations,3),this.options.translations):(a.log("BrowserUIManager: No translations found, using empty object",null,3),{})}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k.CONTAINER.WRAPPER;return a.log("BrowserUIManager: Initializing UI components",null,2),this.container=document.querySelector(e),this.container?(this.generateDiffContainer(),this.generateThemeSwitcher(),this.generateThemeSelector(),this.generateMergeControls(),a.log("BrowserUIManager: UI components generated",null,2),!0):(a.error("BrowserUIManager: Container element not found",null,2),!1)}},{key:"generateThemeSwitcher",value:function(){a.log("BrowserUIManager: Generating theme switcher",null,3);var e=k.THEME.SWITCHER.name(),t=k.THEME.LOADING_INDICATOR.name(),n=k.THEME.TOGGLE.name(),r=document.getElementById(e);if(r){if(document.getElementById(k.DIFF.CONTAINER.name())||this.container.contains(r))return a.log("BrowserUIManager: Reusing existing theme switcher",e,2),this.elements.themeSwitcher=r,r.parentNode!==this.container&&this.container.appendChild(r),void(r.style.position="relative");a.log("BrowserUIManager: Removing orphaned theme switcher",e,2),r.remove(),r=null}a.log("BrowserUIManager: Creating new theme switcher",e,2),(r=document.createElement("div")).id=e,r.className="".concat(k.UTILITY.FLEX.name()," ").concat(k.UTILITY.JUSTIFY_CONTENT_BETWEEN.name()," ").concat(k.UTILITY.PADDING_2.name()),r.style.cssText="display: none !important; position: relative;";var o=document.createElement("div");o.className=k.THEME_SWITCHER.WRAPPER.name();var i=ce.getIconHtml("sun",{classes:k.UTILITY.MARGIN_END_2.name()}),l=ce.getIconHtml("moon",{classes:k.UTILITY.MARGIN_START_2.name()});o.innerHTML='\n            <span class="'.concat(k.THEME_SWITCHER.LABEL.name()," ").concat(k.UTILITY.MARGIN_END_2.name(),'">').concat(i,'</span>\n            <label class="').concat(k.THEME_SWITCHER.CONTROL.name(),'" for="').concat(n,'">\n                <input type="checkbox" id="').concat(n,'" checked>\n                <span class="').concat(k.THEME_SWITCHER.SLIDER.name()," ").concat(k.THEME_SWITCHER.SLIDER_ROUND.name(),'"></span>\n            </label>\n            <span class="').concat(k.THEME_SWITCHER.LABEL.name()," ").concat(k.UTILITY.MARGIN_START_2.name(),' ">').concat(l,"</span>\n        "),r.appendChild(o);var c=document.createElement("div");c.id=t,c.style.display="none",c.style.position="absolute",c.style.zIndex="1000",this.container.appendChild(r),document.body.appendChild(c),this.elements.themeSwitcher=r,this.elements.themeLoadingContainer=c;var s=new MutationObserver((function(e){e.forEach((function(){var e=document.getElementById(k.DIFF.CONTAINER.name());e&&e.classList.contains("loaded")&&(r&&(r.style.cssText="display: flex !important; position: relative;"),s.disconnect())}))})),u=this.container||document.body;s.observe(u,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["class"]})}},{key:"generateThemeSelector",value:function(){a.log("BrowserUIManager: Generating theme selector",null,3);var e=k.THEME.SELECTOR.name(),t=k.THEME.SWITCHER.name(),n=document.getElementById(e),r=null;if(n){r=n.parentNode;var o=document.getElementById(t);if(o&&o.contains(r))return a.log("BrowserUIManager: Reusing existing theme selector",e,2),this.elements.themeSelector=n,this.elements.themeSelectorContainer=r,{container:r,selectElement:n};a.log("BrowserUIManager: Removing orphaned theme selector",e,2),r&&r.parentNode&&r.parentNode.removeChild(r),n=null,r=null}var i=document.getElementById(t);if(!i)return a.warn("BrowserUIManager: No theme switcher container found for theme selector",null,2),null;a.log("BrowserUIManager: Creating new theme selector",e,2),(r=document.createElement("div")).className="".concat(k.THEME_SELECTOR.WRAPPER.name()," ").concat(k.UTILITY.MARGIN_END_3.name());var l=document.createElement("select");return l.id=e,l.className="".concat(k.UTILITY.FORM_SELECT.name()," ").concat(k.UTILITY.FORM_SELECT.name()),r.appendChild(l),i.insertBefore(r,i.firstChild),this.elements.themeSelector=l,this.elements.themeSelectorContainer=r,a.log("BrowserUIManager: Theme selector created and added to DOM",null,2),{container:r,selectElement:l}}},{key:"generateDiffContainer",value:function(){var e=this;a.log("BrowserUIManager: Generating diff container",null,3);var t=k.DIFF.CONTAINER.name(),n=k.DIFF.VIEWER.name(),r=document.createElement("div");r.id=t;var o=document.createElement("div");o.id=n,o.className=k.UTILITY.MARGIN_TOP_2.name(),o.style.display="none",new MutationObserver((function(t){t.forEach((function(t){"attributes"===t.type&&"style"===t.attributeName&&"none"!==o.style.display&&e.elements.themeSwitcher&&(e.elements.themeSwitcher.style.display="flex")}))})).observe(o,{attributes:!0}),r.appendChild(o),this.container.appendChild(r),this.elements.diffContainer=r;var i=document.getElementById(n);a.log("BrowserUIManager: Viewer element (".concat(n,") created successfully: ").concat(!!i),null,3)}},{key:"generateMergeControls",value:function(){a.log("BrowserUIManager: Generating merge controls structure only",null,3);var e=this.getTranslations(),t=k.MERGE.BUTTON_PREVIEW.name(),n=k.MERGE.DESTINATION_TOGGLE.name(),r=k.MERGE.TOGGLE_ICON.name(),o=k.MERGE.TOGGLE_TEXT.name(),i=k.MERGE.DESTINATION_DROPDOWN.name(),l=k.MERGE.BUTTON_APPLY.name(),c=document.createElement("div");c.className="".concat(k.MERGE.CONTROLS_ACTIONS.name()," ").concat(k.UTILITY.FLEX.name()," ").concat(k.UTILITY.ALIGN_ITEMS_CENTER.name()," ").concat(k.UTILITY.JUSTIFY_CONTENT_BETWEEN.name()," ").concat(k.UTILITY.MARGIN_Y_2.name()," ").concat(k.UTILITY.PADDING_2.name());var s=document.createElement("div"),u=document.createElement("button");u.id=t,u.className="".concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_INFO.name()),u.type="button",u.innerHTML="".concat(ce.getIconHtml("eye",{classes:k.UTILITY.MARGIN_END_2.name()})).concat(e.preview||"Preview"),s.appendChild(u);var f=document.createElement("div");f.className="".concat(k.UTILITY.FLEX.name()," ").concat(k.UTILITY.ALIGN_ITEMS_CENTER.name());var d=document.createElement("div");d.className="".concat(k.UTILITY.FLEX.name()," ").concat(k.UTILITY.ALIGN_ITEMS_STRETCH.name()," ").concat(k.UTILITY.MARGIN_END_3.name()),d.classList.add("vdm-input-group");var h=document.createElement("button");h.id=n,h.className="".concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_FLAT.name()," vdm-input-group__prepend"),h.type="button";var g=document.createElement("span");g.id=r,g.innerHTML=ce.getIconHtml("plus-circle",{classes:k.UTILITY.MARGIN_END_2.name()});var m=document.createElement("span");m.id=o,m.setAttribute("title",e.saveToOriginalTooltip||"Replace the current file with merged content"),m.textContent=e.saveToOriginal||"Save to original",h.appendChild(g),h.appendChild(m);var p=document.createElement("select");p.id=i,p.className="".concat(k.UTILITY.FORM_SELECT.name()," vdm-input-group__append vdm-select-auto-width"),d.appendChild(h),d.appendChild(p);var v=document.createElement("button");v.id=l,v.className="".concat(k.UTILITY.BUTTON.name()," ").concat(k.UTILITY.BUTTON_PRIMARY.name()," vdm-nowrap"),v.type="button",v.innerHTML=(e.applyMerge||"Apply Merge")+" ".concat(ce.getIconHtml("file-circle-plus",{classes:k.UTILITY.MARGIN_START_2.name()})),v.style.whiteSpace="nowrap",v.style.display="inline-flex",v.style.alignItems="center",f.appendChild(d),f.appendChild(v),c.appendChild(s),c.appendChild(f),this.container.appendChild(c),this.elements.mergeControls=c,a.log("BrowserUIManager: Created empty merge controls structure (options will be populated by MergeUIController)",null,2)}},{key:"showThemeLoading",value:function(){var e=this.elements.themeLoadingContainer,t=this.elements.themeSwitcher;if(e&&t){var n=H.getInstance().get("loadingTheme","Loading theme...");e.innerHTML='\n                <div class="vdm-theme__loading-spinner"></div>\n                <span>'.concat(n,"</span>\n            "),e.className="vdm-theme__loading-indicator";var r=t.getBoundingClientRect(),o=window.pageYOffset||document.documentElement.scrollTop;e.style.top=r.top+o-40+"px",e.style.display="flex"}}},{key:"hideThemeLoading",value:function(){var e=this.elements.themeLoadingContainer;e&&(e.style.display="none")}},{key:"destroy",value:function(){a.log("BrowserUIManager: Destroying UI components",null,2),this.hideThemeLoading(),this.elements.diffContainer&&this.elements.diffContainer.parentNode&&this.elements.diffContainer.parentNode.removeChild(this.elements.diffContainer),this.elements.mergeControls&&this.elements.mergeControls.parentNode&&this.elements.mergeControls.parentNode.removeChild(this.elements.mergeControls);var e=document.getElementById(k.THEME.SWITCHER.name()),t=document.getElementById(k.THEME.SELECTOR.name()),n=t?t.parentNode:null;this.elements={themeSwitcher:e||null,themeSelector:t||null,themeSelectorContainer:n||null,diffContainer:null,mergeControls:null},this.diffViewer=null,a.log("BrowserUIManager: UI components destroyed",null,2)}},{key:"hideThemeElements",value:function(){a.log("BrowserUIManager: Hiding theme elements for identical content",null,2),this.elements.themeSwitcher&&(this.elements.themeSwitcher.style.cssText="display: none !important; position: relative;",a.log("BrowserUIManager: Hidden theme switcher",this.elements.themeSwitcher.id,2));var e=document.getElementById(k.THEME.SELECTOR.name());e&&(e.style.display="none",a.log("BrowserUIManager: Hidden standalone theme selector",e.id,2))}},{key:"showThemeElements",value:function(){a.log("BrowserUIManager: Showing theme elements for diff content",null,2),this.elements.themeSwitcher&&(this.elements.themeSwitcher.style.cssText="display: flex !important; position: relative;",a.log("BrowserUIManager: Shown theme switcher",this.elements.themeSwitcher.id,2));var e=document.getElementById(k.THEME.SELECTOR.name());e&&(e.style.display="block",a.log("BrowserUIManager: Shown standalone theme selector",e.id,2))}}],t&&vo(e.prototype,t),n&&vo(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function wo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Eo(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function To(){To=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new N(r||[]);return o(a,"_invoke",{value:S(e,n,l)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",p={};function v(){}function y(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,T=E&&E(E(_([])));T&&T!==n&&r.call(T,a)&&(w=T);var I=b.prototype=v.prototype=Object.create(w);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,i,a,l){var c=f(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==So(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,n,r){var o=d;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=k(l,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=f(t,n,r);if("normal"===s.type){if(o=r.done?m:h,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(So(t)+" is not iterable")}return y.prototype=b,o(I,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},C(L.prototype),s(L.prototype,l,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new L(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(I),s(I,c,"Generator"),s(I,a,(function(){return this})),s(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}function Io(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Co(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Io(Object(n),!0).forEach((function(t){Lo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Io(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lo(e,t,n){return(t=No(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function So(e){return So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},So(e)}function ko(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function Mo(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ko(i,r,o,a,l,"next",e)}function l(e){ko(i,r,o,a,l,"throw",e)}a(void 0)}))}}function Oo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,No(r.key),r)}}function No(e){var t=function(e,t){if("object"!=So(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=So(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==So(t)?t:t+""}function _o(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function jo(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}var xo=new WeakSet,Ao=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_o(this,xo),this._serverConfigLoaded=!1,"undefined"==typeof window||window.diffConfig?"undefined"!=typeof window&&window.diffConfig&&a.log("DiffConfigManager: Using existing window.diffConfig",window.diffConfig,2):(a.log("DiffConfigManager: Initializing empty window.diffConfig",null,2),window.diffConfig={debug:!1,logLevel:1,old:{},new:{}})}return t=e,n=[{key:"ensureServerConfigLoaded",value:(i=Mo(To().mark((function e(){var t,n,r,o,i,l,c,s,u;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._serverConfigLoaded){e.next=3;break}return a.log("DiffConfigManager: Server config already loaded, skipping",null,2),e.abrupt("return");case 3:if("undefined"==typeof window||null===(t=window.diffConfig)||void 0===t||!t.apiBaseUrl){e.next=7;break}return a.log("DiffConfigManager: Server config already loaded with apiBaseUrl",window.diffConfig.apiBaseUrl,2),this._serverConfigLoaded=!0,e.abrupt("return");case 7:if(e.prev=7,a.log("DiffConfigManager: Loading server configuration...",null,2),n="",(r=document.querySelectorAll('script[src*="visual-diff-merge"]')).length>0&&(o=r[0].src,(i=o.match(/^(.+\/visual-diff-merge[^\/]*)\//))&&(n=i[1]+"/api/")),n){e.next=15;break}return a.log("DiffConfigManager: Could not determine API base URL from script location",null,2),e.abrupt("return");case 15:return e.next=17,fetch(n+"endpoint-config.php");case 17:if(!(l=e.sent).ok){e.next=25;break}return e.next=21,l.json();case 21:(c=e.sent)&&"object"===So(c)&&(a.log("DiffConfigManager: Loaded server configuration",c,2),"undefined"!=typeof window&&(u=null===(s=window.diffConfig)||void 0===s?void 0:s.serverSaveEnabled,window.diffConfig=Co(Co({},window.diffConfig||{}),c),void 0===u||c.hasOwnProperty("serverSaveEnabled")||(window.diffConfig.serverSaveEnabled=u,a.log("DiffConfigManager: Preserved existing serverSaveEnabled",u,2)),this._serverConfigLoaded=!0)),e.next=26;break;case 25:a.warn("DiffConfigManager: Failed to load server configuration",l.status,1);case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(7),a.warn("DiffConfigManager: Error loading server configuration",e.t0,1);case 31:return e.prev=31,this._serverConfigLoaded=!0,e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[7,28,31,34]])}))),function(){return i.apply(this,arguments)})},{key:"initialize",value:(o=Mo(To().mark((function e(){var t,n=arguments;return To().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{},a.log("DiffConfigManager: Initializing with config",t,2),"undefined"!=typeof window&&window.diffConfig&&window.diffConfig.hasOwnProperty("serverSaveEnabled")){e.next=8;break}return e.next=6,this.ensureServerConfigLoaded();case 6:e.next=9;break;case 8:a.log("DiffConfigManager: Skipping server config load - serverSaveEnabled already set",window.diffConfig.serverSaveEnabled,2);case 9:"undefined"!=typeof window?window.diffConfig=Co(Co({},window.diffConfig||{}),t):a.error("DiffConfigManager: Cannot initialize, window is not available",null,1);case 10:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getDiffConfig",value:function(){return"undefined"!=typeof window&&window.diffConfig?window.diffConfig:(a.warn("DiffConfigManager: window.diffConfig is not available",null,1),{})}},{key:"setDiffConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.log("DiffConfigManager: Setting new diffConfig",e,2),"undefined"!=typeof window?window.diffConfig=Co({},e):a.error("DiffConfigManager: Cannot set config, window is not available",null,1)}},{key:"setDiffConfigSafe",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(a.log("DiffConfigManager: Setting new diffConfig safely (preserving runtime values)",e,2),"undefined"!=typeof window){var t={};["fileRefId","oldFileRefId","newFileName","oldFileName","serverSaveEnabled"].forEach((function(e){window.diffConfig&&void 0!==window.diffConfig[e]&&null!==window.diffConfig[e]&&""!==window.diffConfig[e]&&(t[e]=window.diffConfig[e],a.log("DiffConfigManager: Preserving existing ".concat(e),window.diffConfig[e],3))})),window.diffConfig=Co({},e),Object.entries(t).forEach((function(e){var t=wo(e,2),n=t[0],r=t[1];window.diffConfig[n]=r,a.log("DiffConfigManager: Restored critical runtime property ".concat(n),r,3)})),a.log("DiffConfigManager: Safe setDiffConfig completed",{preservedCount:Object.keys(t).length,preserved:Object.keys(t)},2)}else a.error("DiffConfigManager: Cannot set config, window is not available",null,1)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.log("DiffConfigManager: Resetting diffConfig with overrides",e,2),"undefined"!=typeof window?window.diffConfig=Co({debug:!1,logLevel:1,old:{},new:{}},e):a.error("DiffConfigManager: Cannot reset config, window is not available",null,1)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.log("DiffConfigManager: Updating diffConfig with",e,3),"undefined"!=typeof window&&window.diffConfig?e&&e.config&&"object"===So(e.config)?(a.log("DiffConfigManager: Extracting nested config property",e.config,3),window.diffConfig=jo(xo,this,Do).call(this,window.diffConfig,e.config)):window.diffConfig=jo(xo,this,Do).call(this,window.diffConfig,e):a.warn("DiffConfigManager: window.diffConfig not available for update",null,1)}},{key:"set",value:function(e,t){a.log("DiffConfigManager: Setting ".concat(e),t,3),"undefined"!=typeof window&&window.diffConfig?window.diffConfig[e]=t:a.error("DiffConfigManager: Cannot set ".concat(e,", window.diffConfig not available"),null,1)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"undefined"!=typeof window&&window.diffConfig?e in window.diffConfig?window.diffConfig[e]:t:(a.warn("DiffConfigManager: Cannot get ".concat(e,", window.diffConfig not available"),null,1),t)}},{key:"has",value:function(e){return"undefined"!=typeof window&&window.diffConfig?e in window.diffConfig:(a.warn("DiffConfigManager: Cannot check ".concat(e,", window.diffConfig not available"),null,1),!1)}},{key:"remove",value:function(e){"undefined"!=typeof window&&window.diffConfig&&e in window.diffConfig?(a.log("DiffConfigManager: Removing ".concat(e),null,3),delete window.diffConfig[e]):a.warn("DiffConfigManager: Cannot remove ".concat(e,", not found or window.diffConfig not available"),null,1)}}],r=[{key:"getInstance",value:function(){return Ro._||(Ro._=new e),Ro._}}],n&&Oo(t.prototype,n),r&&Oo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,o,i}();function Do(e,t){var n=this,r=Co({},e);return jo(xo,this,Po).call(this,e)&&jo(xo,this,Po).call(this,t)&&Object.keys(t).forEach((function(o){jo(xo,n,Po).call(n,t[o])?r[o]=o in e?jo(xo,n,Do).call(n,e[o],t[o]):t[o]:r[o]=t[o]})),r}function Po(e){return e&&"object"===So(e)&&!Array.isArray(e)}var Ro={_:null};function Uo(e){return Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uo(e)}function Fo(){Fo=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),l=new N(r||[]);return o(a,"_invoke",{value:S(e,n,l)}),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",h="suspendedYield",g="executing",m="completed",p={};function v(){}function y(){}function b(){}var w={};s(w,a,(function(){return this}));var E=Object.getPrototypeOf,T=E&&E(E(_([])));T&&T!==n&&r.call(T,a)&&(w=T);var I=b.prototype=v.prototype=Object.create(w);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,i,a,l){var c=f(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==Uo(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function S(t,n,r){var o=d;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=k(l,r);if(c){if(c===p)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=f(t,n,r);if("normal"===s.type){if(o=r.done?m:h,s.arg===p)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function k(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=f(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function _(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(Uo(t)+" is not iterable")}return y.prototype=b,o(I,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},C(L.prototype),s(L.prototype,l,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new L(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},C(I),s(I,c,"Generator"),s(I,a,(function(){return this})),s(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=_,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:_(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}function Bo(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function Ho(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Bo(i,r,o,a,l,"next",e)}function l(e){Bo(i,r,o,a,l,"throw",e)}a(void 0)}))}}var Vo=null,Go=xe.getInstance();function zo(){document.querySelectorAll(".vdm-form").forEach((function(e){if(!e.parentNode.querySelector(".vdm-copyright-link")){var t=document.createElement("div");t.className="vdm-copyright-link",t.style.cssText="text-align: right; font-size: 11px; margin-top: 4px; opacity: 0.7;",t.innerHTML='<a href="https://visual-diff-merge.miglisoft.com/" rel="noopener" target="_blank" style="text-decoration: none; color: inherit;">Powered by Visual-Diff-Merge</a>',e.parentNode.insertBefore(t,e.nextSibling)}}))}return document.addEventListener("DOMContentLoaded",zo),window.addEventListener("load",zo),window.enableDiffViewer=Ho(Fo().mark((function e(){var t,n,r,o,i,l,c,s,u,f,d,h,g,m,p,v,y,b,w,E,I,C,L,S,M,O,N,_,j,x,A,D,P,R,U,F;return Fo().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!1,i=1,window.diffConfig&&(void 0!==window.diffConfig.debug?(o=window.diffConfig.debug,i=window.diffConfig.logLevel||1):window.diffConfig.config&&void 0!==window.diffConfig.config.debug?(o=window.diffConfig.config.debug,i=window.diffConfig.config.logLevel||1):window.diffConfig.success&&window.diffConfig.config&&(o=window.diffConfig.config.debug||!1,i=window.diffConfig.config.logLevel||1)),console.log("=== DEBUG CONFIG EXTRACTION ===",{windowDiffConfigExists:!!window.diffConfig,configStructure:window.diffConfig?Object.keys(window.diffConfig):"none",directDebug:null===(t=window.diffConfig)||void 0===t?void 0:t.debug,nestedDebug:null===(n=window.diffConfig)||void 0===n||null===(n=n.config)||void 0===n?void 0:n.debug,finalDebug:o,finalLogLevel:i}),a.initialize(o,"[DiffViewer]",i),l=Nt.getInstance(),c=H.getInstance(),zo(),null!==(r=window.diffConfig)&&void 0!==r&&r.translations&&!c.isInitialized()&&(s=window.diffConfig.lang||"en",a.log("Initializing TranslationManager with language: ".concat(s),null,2),c.initialize(s,window.diffConfig.translations)),u=c.get("loadingDiff","Loading diff..."),f=l.adoptEarlyLoader(u),e.prev=11,a.log("INITIALIZATION - PHASE 1: PREPARATION",null,1),l.updateLoaderMessage(f,c.get("loadingContent","Loading content...")),null===(d=window.diffConfig)||void 0===d||!d.isIdentical){e.next=19;break}return g=c.get("filesIdenticalMessage","The files are identical. No differences found."),ce.showMessage(k.DIFF.CONTENT_WRAPPER.name(),g,"info"),l.hideMainLoader(f),e.abrupt("return");case 19:return e.prev=19,l.updateLoaderMessage(f,c.get("discoveringEndpoints","Discovering API endpoints...")),e.next=23,Go.getEndpoint();case 23:m=e.sent,a.log("API endpoint discovered",m,2),window.diffConfig&&!window.diffConfig.apiEndpoint&&(window.diffConfig.apiEndpoint=m),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(19),a.warn("API endpoint discovery failed, using fallbacks",e.t0,1);case 31:if(null===(h=window.diffConfig)||void 0===h||!h.isIdentical){e.next=36;break}return p=c.get("filesIdenticalMessage","The files are identical. No differences found."),ce.showMessage(k.DIFF.CONTENT_WRAPPER.name(),p,"info"),l.hideMainLoader(f),e.abrupt("return");case 36:if(!window.diffViewer){e.next=43;break}if(a.log("Cleaning up previous instance",null,1),l.updateLoaderMessage(f,c.get("cleaningUpPrevious","Cleaning up previous instance...")),"function"!=typeof window.diffViewer.destroy){e.next=42;break}return e.next=42,window.diffViewer.destroy();case 42:window.diffViewer=null;case 43:if(window.vdmBrowserUIManager&&(a.log("Cleaning up browser UI manager",null,1),"function"==typeof window.vdmBrowserUIManager.destroy&&window.vdmBrowserUIManager.destroy(),window.vdmBrowserUIManager=null),a.log("INITIALIZATION - STARTING",null,1),l.updateLoaderMessage(f,c.get("validatingConfig","Validating configuration...")),(v=de.validateConfig(window.diffConfig)).isValid){e.next=51;break}return a.error(v.error),l.hideMainLoader(f),e.abrupt("return");case 51:if(a.log("CONFIGURATION SUMMARY",de.getConfigSummary(window.diffConfig),1),a.log("INITIALIZATION - PHASE 2: SERVICES",null,1),l.updateLoaderMessage(f,c.get("initializingServices","Initializing services...")),y=de.getThemePreferences(window.diffConfig),(b=T.getInstance()).configure({availableThemes:mo,currentTheme:y.mode,currentThemeFamily:y.family,language:de.getFileExtension(window.diffConfig.filepath,"php")}),(w=Je.getInstance()).initialize({theme:window.diffConfig.theme},b),a.log("INITIALIZATION - PHASE 2.5: UI PREPARATION",null,1),l.updateLoaderMessage(f,c.get("preparingUI","Preparing UI elements...")),E=document.getElementById(k.CONTAINER.WRAPPER.name()),I=document.getElementById(k.DIFF.CONTAINER.name()),!(C=E&&!I)){e.next=72;break}return a.log("Creating browser UI elements before DiffViewer initialization",null,1),(L=new bo({options:window.diffConfig||{}})).initialize(),Vo=L,window.vdmBrowserUIManager=L,e.next=72,new Promise((function(e){return setTimeout(e,50)}));case 72:if(a.log("INITIALIZATION - PHASE 3: COMPONENTS",null,1),l.updateLoaderMessage(f,c.get("initializingComponents","Initializing components...")),S=document.querySelector(k.DIFF.VIEWER),M=0,O=5,!C){e.next=86;break}case 78:if(S||!(M<O)){e.next=86;break}return a.log("Container element ".concat(k.DIFF.VIEWER," not found, attempt ").concat(M+1,"/").concat(O),null,2),e.next=82,new Promise((function(e){return setTimeout(e,100)}));case 82:S=document.querySelector(k.DIFF.VIEWER),M++,e.next=78;break;case 86:if(S){e.next=90;break}return a.error("Container element ".concat(k.DIFF.VIEWER," not found after ").concat(M," attempts")),l.hideMainLoader(f),e.abrupt("return");case 90:return(N=document.querySelector(k.LOADER.MAIN))&&(N.style.display="none",a.log("Loading element hidden",null,2)),S&&(S.style.display="flex",a.log("Container element shown",null,2)),_=Ao.getInstance(),j=_.get("serverSaveEnabled",!1),a.log("Using serverSaveEnabled=".concat(j," from DiffConfigManager"),null,2),x=new go({diffData:_.get("diffData"),serverSaveEnabled:j,fileRefId:_.get("fileRefId",""),oldFileRefId:_.get("oldFileRefId",""),newFileName:_.get("newFileName",""),oldFileName:_.get("oldFileName",""),isIdentical:_.get("isIdentical",!1),filepath:_.get("filepath"),resourceLoader:b,themeManager:w,endpointDiscovery:Go,mainLoaderId:f}),window.diffViewer=x,C&&Vo&&(Vo.setDiffViewer(x),x.setBrowserUIManager(Vo)),a.log("INITIALIZATION - PHASE 4: RESOURCES",null,1),l.updateLoaderMessage(f,c.get("loadingResources","Loading resources...")),e.next=103,b.loadSyntaxHighlighterCore();case 103:return l.updateLoaderMessage(f,c.get("loadingTheme","Loading theme...")),e.next=106,w.loadInitialTheme();case 106:return a.log("INITIALIZATION - PHASE 5: UI",null,1),l.updateLoaderMessage(f,c.get("initializingUI","Initializing UI...")),e.next=110,x.initialize();case 110:return(A=document.querySelector(k.DIFF.CONTAINER))&&A.classList.add(k.STATUS.LOADED.name()),a.log("INITIALIZATION - COMPLETE",null,1),l.hideMainLoader(f),e.abrupt("return",x);case 117:e.prev=117,e.t1=e.catch(11),a.error("Error initializing diff viewer:",e.t1),(D=document.querySelector(k.DIFF.VIEWER))&&(P=Q.getInstance(),R=c.get("errorLoadingDiff","Error loading diff"),U="\n                <h4>".concat(R,"</h4>\n                <p>").concat(e.t1 instanceof Error?e.t1.message:String(e.t1),"</p>\n            "),F=P.showError(U,{timeout:0,translate:!1,className:"vdm-w-100"}),D.innerHTML="",D.appendChild(F),D.style.display="flex"),l.hideMainLoader(f);case 123:case"end":return e.stop()}}),e,null,[[11,117],[19,28]])}))),window.BrowserUIManager=bo,window.LoaderManager=Nt,window.TranslationManager=H,window.AlertManager=Q,window.DiffConfigManager=Ao,e=e.default})()));
//# sourceMappingURL=diff-viewer.min.js.map